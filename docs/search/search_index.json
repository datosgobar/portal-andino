{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Portal Andino Versi\u00f3n : 2.5.6 Portal Andino es un desarrollo de la Administraci\u00f3n P\u00fablica Nacional basado en CKAN . Es la tecnolog\u00eda detr\u00e1s del Portal Nacional de Datos Abiertos y de otros portales de datos abiertos de organismos de la APN, provincias y municipios. Usuarios Comienzo r\u00e1pido Publicar series de tiempo Gu\u00eda de Markdown Desarrolladores Instalaci\u00f3n Actualizaci\u00f3n Checklist para la puesta en producci\u00f3n Migraci\u00f3n Mantenimiento Configuraci\u00f3n HTTPS Configuraci\u00f3n de DNS Desarrollo Tests","title":"Inicio"},{"location":"#portal-andino","text":"Versi\u00f3n : 2.5.6 Portal Andino es un desarrollo de la Administraci\u00f3n P\u00fablica Nacional basado en CKAN . Es la tecnolog\u00eda detr\u00e1s del Portal Nacional de Datos Abiertos y de otros portales de datos abiertos de organismos de la APN, provincias y municipios. Usuarios Comienzo r\u00e1pido Publicar series de tiempo Gu\u00eda de Markdown Desarrolladores Instalaci\u00f3n Actualizaci\u00f3n Checklist para la puesta en producci\u00f3n Migraci\u00f3n Mantenimiento Configuraci\u00f3n HTTPS Configuraci\u00f3n de DNS Desarrollo Tests","title":"Portal Andino"},{"location":"markdown-guide/","text":"GU\u00cdA DE MARKDOWN Nota: esta gu\u00eda est\u00e1 totalmente basada en la gu\u00eda de DaringFireball . y traducida al espa\u00f1ol. ELEMENTOS EN BLOQUE ENCABEZADOS Markdown admite dos estilos de encabezados, Setext y atx. Los encabezados de estilo de texto est\u00e1n \"subrayados\" usando signos de igual (para encabezados de primer nivel) y guiones (para encabezados de segundo nivel). Por ejemplo: This is an H1 ============= This is an H2 ------------- Cualquier n\u00famero de subrayado = 's o' funcionar\u00e1. Los encabezados de estilo Atx usan 1-6 caracteres hash al comienzo de la l\u00ednea, correspondientes a los niveles de encabezado 1-6. Por ejemplo: # This is an H1 ## This is an H2 ###### This is an H6 Opcionalmente, puede \"cerrar\" los encabezados de estilo atx. Esto es puramente cosm\u00e9tico; puede usarlo si cree que se ve mejor. Los hashes de cierre ni siquiera necesitan coincidir con el n\u00famero de hashes utilizados para abrir el encabezado. (El n\u00famero de hashes de apertura determina el nivel del encabezado): # This is an H1 # ## This is an H2 ## ### This is an H3 ###### CITAS EN BLOQUE Markdown utiliza caracteres de estilo de correo electr\u00f3nico > para comillas en bloque. Si est\u00e1 familiarizado con citar pasajes de texto en un mensaje de correo electr\u00f3nico, entonces sabe c\u00f3mo crear una cita en bloque en Markdown. Se ve mejor si ajusta firmemente el texto y pone un > antes de cada l\u00ednea: > This is a blockquote with two paragraphs . Lorem ipsum dolor sit amet , > consectetuer adipiscing elit . Aliquam hendrerit mi posuere lectus . > Vestibulum enim wisi , viverra nec , fringilla in , laoreet vitae , risus . > > Donec sit amet nisl . Aliquam semper ipsum sit amet velit . Suspendisse > id sem consectetuer libero luctus adipiscing . Markdown allows you to be lazy and only put the > before the first line of a hard - wrapped paragraph : > This is a blockquote with two paragraphs . Lorem ipsum dolor sit amet , consectetuer adipiscing elit . Aliquam hendrerit mi posuere lectus . Vestibulum enim wisi , viverra nec , fringilla in , laoreet vitae , risus . > Donec sit amet nisl . Aliquam semper ipsum sit amet velit . Suspendisse id sem consectetuer libero luctus adipiscing . Las citas en bloque se pueden anidar (es decir, una cita en bloque en una cita en bloque) agregando niveles adicionales de >: > This is the first level of quoting . > > > This is nested blockquote . > > Back to the first level . Las citas en bloque pueden contener otros elementos de Markdown, incluidos encabezados, listas y bloques de c\u00f3digo: > ## This is a header . > > 1 . This is the first list item . > 2 . This is the second list item . > > Here ' s some example code: > > return shell_exec ( \" echo $input | $markdown_script \" ) ; Cualquier editor de texto decente deber\u00eda facilitar las citas al estilo del correo electr\u00f3nico. Por ejemplo, con BBEdit, puede hacer una selecci\u00f3n y elegir Aumentar Nivel de Cita en el men\u00fa Texto. LISTS Markdown admite listas ordenadas (numeradas) y no ordenadas (con vi\u00f1etas). Las listas desordenadas utilizan asteriscos, m\u00e1s y guiones - de manera intercambiable - como marcadores de lista: * Red * Green * Blue es equivalente a: + Red + Green + Blue y: - Red - Green - Blue Las listas ordenads usan numeros seguidas de puntos: 1 . Bird 2 . McHale 3 . Parish Es importante tener en cuenta que los n\u00fameros que usas para marcar la lista no tienen efecto en la salida HTML que Markdown produce. El HTML Markdown que produce la lista anterior es: <ol> <li> Bird </li> <li> McHale </li> <li> Parish </li> </ol> Si en cambio escribiste la lista en Markdown as\u00ed: 1 . Bird 1 . McHale 1 . Parish o incluso: 3 . Bird 1 . McHale 8 . Parish obtendr\u00edas exactamente la misma salida HTML. El punto es que, si lo deseas, puedes usar n\u00fameros ordinales en sus listas de Markdown ordenadas, para que los n\u00fameros en su fuente coincidan con los n\u00fameros en su HTML publicado. Pero si quieres ser flojo, no tienes que hacerlo. Sin embargo, si utilizas la numeraci\u00f3n de la lista diferida, a\u00fan debes comenzar la lista con el n\u00famero 1. En alg\u00fan momento en el futuro, Markdown puede admitir el inicio de listas ordenadas en un n\u00famero arbitrario. Los marcadores de lista generalmente comienzan en el margen izquierdo, pero pueden estar indentados por hasta tres espacios. Los marcadores de lista deben ir seguidos de uno o m\u00e1s espacios o una pesta\u00f1a. To make lists look nice, you can wrap items with hanging indents: * Lorem ipsum dolor sit amet , consectetuer adipiscing elit . Aliquam hendrerit mi posuere lectus . Vestibulum enim wisi , viverra nec , fringilla in , laoreet vitae , risus . * Donec sit amet nisl . Aliquam semper ipsum sit amet velit . Suspendisse id sem consectetuer libero luctus adipiscing . Pero si quieres ser flojo, no tienes que: * Lorem ipsum dolor sit amet , consectetuer adipiscing elit . Aliquam hendrerit mi posuere lectus . Vestibulum enim wisi , viverra nec , fringilla in , laoreet vitae , risus . * Donec sit amet nisl . Aliquam semper ipsum sit amet velit . Suspendisse id sem consectetuer libero luctus adipiscing . Si los elementos de la lista est\u00e1n separados por l\u00edneas en blanco, Markdown ajustar\u00e1 los elementos en etiquetas <p> en la salida HTML. Por ejemplo, esta entrada: * Bird * Magic Se convertir\u00e1 en: <ul> <li> Bird </li> <li> Magic </li> </ul> Pero esto: * Bird * Magic Se convertir\u00e1 en: <ul> <li><p> Bird </p></li> <li><p> Magic </p></li> </ul> Los elementos de la lista pueden consistir en m\u00faltiples p\u00e1rrafos. Cada p\u00e1rrafo posterior en un elemento de la lista debe estar sangrado por 4 espacios o una pesta\u00f1a: 1 . This is a list item with two paragraphs . Lorem ipsum dolor sit amet , consectetuer adipiscing elit . Aliquam hendrerit mi posuere lectus . Vestibulum enim wisi , viverra nec , fringilla in , laoreet vitae , risus . Donec sit amet nisl . Aliquam semper ipsum sit amet velit . 2 . Suspendisse id sem consectetuer libero luctus adipiscing . Se ve bien si indentas cada l\u00ednea de los p\u00e1rrafos posteriores, pero aqu\u00ed nuevamente, Markdown te permitir\u00e1 ser perezoso: * This is a list item with two paragraphs . This is the second paragraph in the list item . You ' re only required to indent the first line . Lorem ipsum dolor sit amet , consectetuer adipiscing elit . * Another item in the same list . Para colocar una cita en bloque dentro de un elemento de la lista, los delimitadores de la cita (>) en bloque deben indentarse: * A list item with a blockquote : > This is a blockquote > inside a list item . To put a code block within a list item , the code block needs to be indented twice \u2009 \u2014 \u2009 8 spaces or two tabs : * A list item with a code block : < code goes here > Vale la pena se\u00f1alar que es posible activar una lista ordenada por accidente, escribiendo algo como esto: 1986 . What a great season . In other words , a number - period - space sequence at the beginning of a line . To avoid this , you can backslash - escape the period : 1986 \\ . What a great season . CODE BLOCKS Los bloques de c\u00f3digo formateados previamente se utilizan para escribir sobre c\u00f3digo fuente de programaci\u00f3n o marcado. En lugar de formar p\u00e1rrafos normales, las l\u00edneas de un bloque de c\u00f3digo se interpretan literalmente. Markdown envuelve un bloque de c\u00f3digo en las etiquetas <pre> y <code> . Para producir un bloque de c\u00f3digo en Markdown, simplemente sangra cada l\u00ednea del bloque por al menos 4 espacios o 1 pesta\u00f1a. Por ejemplo, dada esta entrada: This is a normal paragraph : This is a code block . Markdown generar\u00e1: <p> This is a normal paragraph: </p> <pre><code> This is a code block. </code></pre> Se elimina un nivel de sangr\u00eda, 4 espacios o 1 pesta\u00f1a, de cada l\u00ednea del bloque de c\u00f3digo. Por ejemplo, esto: Here is an example of AppleScript : tell application \" Foo \" beep end tell Se convertir\u00e1 en: < p > Here is an example of AppleScript : </ p > < pre >< code > tell application \" Foo \" beep end tell </ code ></ pre > Un bloque de c\u00f3digo contin\u00faa hasta que alcanza una l\u00ednea que no est\u00e1 sangrada (o al final del art\u00edculo). Dentro de un bloque de c\u00f3digo, los s\u00edmbolos (&) y los corchetes angulares ( ) se convierten autom\u00e1ticamente en entidades HTML. Esto hace que sea muy f\u00e1cil incluir un c\u00f3digo fuente HTML de ejemplo usando Markdown: simplemente p\u00e9guelo e indentif\u00edquelo, y Markdown se encargar\u00e1 de la molestia de codificar los s\u00edmbolos y los corchetes angulares. Por ejemplo, esto: <div class= \"footer\" > &copy; 2004 Foo Corporation </div> Se convertir\u00e1 en: <pre><code><div class= \"footer\" > &amp; copy; 2004 Foo Corporation </div> </code></pre> La sintaxis de Markdown normal no se procesa dentro de los bloques de c\u00f3digo. Por ejemplo, los asteriscos son solo asteriscos literales dentro de un bloque de c\u00f3digo. Esto significa que tambi\u00e9n es f\u00e1cil usar Markdown para escribir sobre la sintaxis propia de Markdown. REGLAS HORIZONTALES Puede producir una etiqueta de regla horizontal (<hr />) colocando tres o m\u00e1s guiones, asteriscos o guiones bajos en una l\u00ednea por s\u00ed mismos. Si lo desea, puede usar espacios entre los guiones o asteriscos. Cada una de las siguientes l\u00edneas producir\u00e1 una regla horizontal: * * * *** ***** - - - --------------------------------------- ELEMENTOS SPAN LINKS Markdown admite dos estilos de enlaces: en l\u00ednea y de referencia. En ambos estilos, el texto del enlace est\u00e1 delimitado por [corchetes]. Para crear un enlace en l\u00ednea, use un conjunto de par\u00e9ntesis regulares inmediatamente despu\u00e9s del corchete de cierre del texto del enlace. Dentro de los par\u00e9ntesis, coloque la URL donde desea que apunte el enlace, junto con un t\u00edtulo opcional para el enlace, entre comillas. Por ejemplo: This is [ an example ]( http : //example.com/ \"Title\") inline link. [ This link ]( http : //example.net/) has no title attribute. Producir\u00e1: <p> This is <a href= \"http://example.com/\" title= \"Title\" > an example </a> inline link. </p> <p><a href= \"http://example.net/\" > This link </a> has no title attribute. </p> Si se refiere a un recurso local en el mismo servidor, puede usar rutas relativas: See my [ About ] ( / about / ) page for details . Los enlaces de estilo de referencia usan un segundo conjunto de corchetes, dentro del cual coloca una etiqueta de su elecci\u00f3n para identificar el enlace: This is [ an example ][ id ] reference - style link . Opcionalmente, puede usar un espacio para separar los conjuntos de corchetes: This is [ an example ] [ id ] reference - style link . Luego, en cualquier parte del documento, define su etiqueta de enlace de esta manera, en una l\u00ednea por s\u00ed misma: [ id ] : http : // example . com / \"Optional Title Here\" Es decir: Corchetes que contienen el identificador de enlace (opcionalmente sangrado del margen izquierdo usando hasta tres espacios); seguido de dos puntos; seguido de uno o m\u00e1s espacios (o pesta\u00f1as); seguido de la URL del enlace; opcionalmente seguido por un atributo de t\u00edtulo para el enlace, entre comillas dobles o simples, o entre par\u00e9ntesis. Las siguientes tres definiciones de enlace son equivalentes: [ foo ] : http : // example . com / \"Optional Title Here\" [ foo ] : http : // example . com / 'Optional Title Here' [ foo ] : http : // example . com / ( Optional Title Here ) NOTA: Hay un error conocido en Markdown.pl 1.0.1 que evita que se usen comillas simples para delimitar los t\u00edtulos de los enlaces. La URL del enlace puede, opcionalmente, estar entre corchetes angulares: [ id ] : < http : // example . com /> \"Optional Title Here\" Puede colocar el atributo de t\u00edtulo en la siguiente l\u00ednea y usar espacios o pesta\u00f1as adicionales para el relleno, que tiende a verse mejor con URL m\u00e1s largas: [ id ] : http : // example . com / longish / path / to / resource / here \"Optional Title Here\" Las definiciones de enlace solo se usan para crear enlaces durante el procesamiento de Markdown, y se eliminan de su documento en la salida HTML. Los nombres de definici\u00f3n de enlace pueden consistir en letras, n\u00fameros, espacios y signos de puntuaci\u00f3n, pero no distinguen entre may\u00fasculas y min\u00fasculas. P.ej. estos dos enlaces: [link text][a] [link text][A] son equivalentes El acceso directo impl\u00edcito al nombre del enlace le permite omitir el nombre del enlace, en cuyo caso el texto del enlace se usa como nombre. Simplemente use un conjunto vac\u00edo de corchetes; por ejemplo, para vincular la palabra \"Google\" al sitio web google.com, simplemente puede escribir: [ Google ] [] Y luego defina el enlace: [ Google ] : http : // google . com / Como los nombres de los enlaces pueden contener espacios, este acceso directo incluso funciona para varias palabras en el texto del enlace: Visit [ Daring Fireball ][] for more information . Y entonces, define el link: [ Daring Fireball ] : http : //daringfireball.net/ Las definiciones de enlace se pueden colocar en cualquier parte de su documento Markdown. Se tiende a ponerlos inmediatamente despu\u00e9s de cada p\u00e1rrafo en el que se usan, pero si lo desea, puede ponerlos todos al final de su documento, como notas a pie de p\u00e1gina. Aqu\u00ed hay un ejemplo de enlaces de referencia en acci\u00f3n: I get 10 times more traffic from [ Google ] [ 1 ] than from [ Yahoo ] [ 2 ] or [ MSN ] [ 3 ] . [ 1 ] : http : // google . com / \"Google\" [ 2 ] : http : // search . yahoo . com / \"Yahoo Search\" [ 3 ] : http : // search . msn . com / \"MSN Search\" Usando el acceso directo de nombre de enlace impl\u00edcito, en su lugar podr\u00eda escribir: I get 10 times more traffic from [ Google ] [] than from [ Yahoo ] [] or [ MSN ] [] . [ google ] : http : // google . com / \"Google\" [ yahoo ] : http : // search . yahoo . com / \"Yahoo Search\" [ msn ] : http : // search . msn . com / \"MSN Search\" Los dos ejemplos anteriores producir\u00e1n la siguiente salida HTML: <p> I get 10 times more traffic from <a href= \"http://google.com/\" title= \"Google\" > Google </a> than from <a href= \"http://search.yahoo.com/\" title= \"Yahoo Search\" > Yahoo </a> or <a href= \"http://search.msn.com/\" title= \"MSN Search\" > MSN </a> . </p> A modo de comparaci\u00f3n, aqu\u00ed est\u00e1 el mismo p\u00e1rrafo escrito con el estilo de enlace en l\u00ednea de Markdown: I get 10 times more traffic from [ Google ] ( http : // google . com / \"Google\" ) than from [ Yahoo ] ( http : // search . yahoo . com / \"Yahoo Search\" ) or [ MSN ] ( http : // search . msn . com / \"MSN Search\" ). El punto de los enlaces de estilo de referencia no es que sean m\u00e1s f\u00e1ciles de escribir. El punto es que con los enlaces de estilo de referencia, la fuente de su documento es mucho m\u00e1s legible. Compare los ejemplos anteriores: usando enlaces de estilo de referencia, el p\u00e1rrafo en s\u00ed solo tiene 81 caracteres de longitud; con enlaces de estilo en l\u00ednea, tiene 176 caracteres; y como HTML sin procesar, tiene 234 caracteres. En el HTML sin formato, hay m\u00e1s marcado que texto. Con los enlaces de estilo de referencia de Markdown, un documento fuente se parece mucho m\u00e1s a la salida final, tal como se representa en un navegador. Al permitirle mover los metadatos relacionados con el marcado fuera del p\u00e1rrafo, puede agregar enlaces sin interrumpir el flujo narrativo de su prosa. \u00c9NFASIS Markdown trata los asteriscos (*) y los guiones bajos ( ) como indicadores de \u00e9nfasis. El texto envuelto con uno * o _ se envolver\u00e1 con una etiqueta HTML <em> ; los dobles * \u2019o \u2019s se envolver\u00e1n con una etiqueta HTML <strong> . Por ejemplo, esta entrada: * single asterisks * _single underscores_ ** double asterisks ** __double underscores__ producir\u00e1: <em> single asterisks </em> <em> single underscores </em> <strong> double asterisks </strong> <strong> double underscores </strong> Puedes usar el estilo que prefieras; La \u00fanica restricci\u00f3n es que se debe usar el mismo car\u00e1cter para abrir y cerrar un intervalo de \u00e9nfasis. El \u00e9nfasis se puede usar en medio de una palabra: un * frigging * believable Pero si rodea un * o _ con espacios, se tratar\u00e1 como un asterisco literal o gui\u00f3n bajo. Para producir un asterisco literal o un gui\u00f3n bajo en una posici\u00f3n donde de otro modo se usar\u00eda como un delimitador de \u00e9nfasis, puede hacer una barra invertida para escapar de \u00e9l: \\ * this text is surrounded by literal asterisks \\ * Para indicar un intervalo de c\u00f3digo, envu\u00e9lvalo con comillas de retroceso (`). A diferencia de un bloque de c\u00f3digo preformateado, un intervalo de c\u00f3digo indica c\u00f3digo dentro de un p\u00e1rrafo normal. Por ejemplo: Use the ` printf () ` function . producir\u00e1: <p> Use the <code> printf() </code> function. </p> Para incluir un car\u00e1cter de retroceso literal dentro de un intervalo de c\u00f3digo, puede usar m\u00faltiples retrocesos como delimitadores de apertura y cierre: `` There is a literal backtick ( ` ) here . `` que producir\u00e1 esto: <p><code> There is a literal backtick (`) here. </code></p> Los delimitadores de retroceso que rodean un tramo de c\u00f3digo pueden incluir espacios, uno despu\u00e9s de la apertura, uno antes del cierre. Esto le permite colocar caracteres de retroceso literal al principio o al final de un intervalo de c\u00f3digo: A single backtick in a code span : `` ` `` A backtick-delimited string in a code span: `` ` foo ` ` ` producir\u00e1: < p > A single backtick in a code span : < code > `</code></p> <p>A backtick-delimited string in a code span: <code>` foo `</ code ></ p > Con una extensi\u00f3n de c\u00f3digo, los signos de uni\u00f3n y los corchetes angulares se codifican autom\u00e1ticamente como entidades HTML, lo que facilita la inclusi\u00f3n de ejemplos de etiquetas HTML. Markdown convertir\u00e1 esto: Please don ' t use any `< blink >` tags . en: <p> Please don't use any <code><blink></code> tags. </p> Puedes escribir esto: `&# 8212 ; ` is the decimal - encoded equivalent of `& mdash ; ` . para producir: <p><code> &amp; #8212; </code> is the decimal-encoded equivalent of <code> &amp; mdash; </code> . </p> IM\u00c1GENES Es cierto que es bastante dif\u00edcil dise\u00f1ar una sintaxis \"natural\" para colocar im\u00e1genes en un formato de documento de texto sin formato. Markdown utiliza una sintaxis de imagen que pretende parecerse a la sintaxis de los enlaces, lo que permite dos estilos: en l\u00ednea y de referencia. La sintaxis de la imagen en l\u00ednea se ve as\u00ed: ! [ Alt text ]( / path / to / img . jpg ) ! [ Alt text ]( / path / to / img . jpg \"Optional title\" ) Es decir: Un signo de exclamaci\u00f3n:!; seguido de un conjunto de corchetes, que contiene el texto del atributo alt para la imagen; seguido de un conjunto de par\u00e9ntesis, que contiene la URL o la ruta a la imagen, y un atributo de t\u00edtulo opcional entre comillas dobles o simples. La sintaxis de la imagen de estilo de referencia se ve as\u00ed: ! [ Alt text ][ id ] Donde \"id\" es el nombre de una referencia de imagen definida. Las referencias de imagen se definen utilizando una sintaxis id\u00e9ntica a las referencias de enlace: [ id ] : url / to / image \"Optional title attribute\" Al escribir estas l\u00edneas, Markdown no tiene sintaxis para especificar las dimensiones de una imagen; Si esto es importante para usted, simplemente puede usar etiquetas HTML normales <img> . MISCEL\u00c1NEO LINKS AUTOM\u00c1TICOS Markdown admite un estilo de acceso directo para crear enlaces \"autom\u00e1ticos\" para URL y direcciones de correo electr\u00f3nico: simplemente rodee la URL o la direcci\u00f3n de correo electr\u00f3nico con corchetes angulares. Lo que esto significa es que si desea mostrar el texto real de una URL o direcci\u00f3n de correo electr\u00f3nico, y tambi\u00e9n hacer que sea un enlace en el que se pueda hacer clic, puede hacer esto: < http : // example . com /> Markdown convertir\u00e1 esto en: <a href= \"http://example.com/\" > http://example.com/ </a> Los enlaces autom\u00e1ticos para direcciones de correo electr\u00f3nico funcionan de manera similar, excepto que Markdown tambi\u00e9n realizar\u00e1 un poco de codificaci\u00f3n aleatoria de entidades decimales y hexadecimales para ayudar a ocultar su direcci\u00f3n de los robots de spam que recolectan direcciones. Por ejemplo, Markdown convertir\u00e1 esto: < address @example . com > en algo como esto: <a href= \"&#x6D;&#x61;i&#x6C;&#x74;&#x6F;:&#x61;&#x64;&#x64;&#x72;&#x65; &#115;&#115;&#64;&#101;&#120;&#x61;&#109;&#x70;&#x6C;e&#x2E;&#99;&#111; &#109;\" > &#x61;&#x64;&#x64;&#x72;&#x65;&#115;&#115;&#64;&#101;&#120;&#x61; &#109;&#x70;&#x6C; e &#x2E;&#99;&#111;&#109; </a> que se mostrar\u00e1 en un navegador como un enlace en el que se puede hacer clic en \"direcci\u00f3n@ejemplo.com\". (Este tipo de truco de codificaci\u00f3n de entidades realmente enga\u00f1ar\u00e1 a muchos, si no a la mayor\u00eda, a los robots de recolecci\u00f3n de direcciones, pero definitivamente no los enga\u00f1ar\u00e1 a todos. Es mejor que nada, pero una direcci\u00f3n publicada de esta manera probablemente comenzar\u00e1 a recibir correo no deseado.) ESCAPE DE BARRA INVERTIDA Markdown le permite usar escapes de barra invertida para generar caracteres literales que de otro modo tendr\u00edan un significado especial en la sintaxis de formato de Markdown. Por ejemplo, si desea rodear una palabra con asteriscos literales (en lugar de una etiqueta HTML <em> ), puede usar barras invertidas antes de los asteriscos, de esta manera: \\ * literal asterisks \\ * Markdown proporciona escapes de barra invertida para los siguientes caracteres: \\ barra invertida ` retroceso * asterisco _ guion bajo {} llaves [] corchetes () par\u00e9ntesis # s\u00edmbolo de hash + signo m\u00e1s - signo menos ( gui\u00f3n ) . punto ! signo de exclamaci\u00f3n","title":"Gu\u00eda de Markdown"},{"location":"markdown-guide/#guia-de-markdown","text":"Nota: esta gu\u00eda est\u00e1 totalmente basada en la gu\u00eda de DaringFireball . y traducida al espa\u00f1ol.","title":"GU\u00cdA DE MARKDOWN"},{"location":"markdown-guide/#elementos-en-bloque","text":"","title":"ELEMENTOS EN BLOQUE"},{"location":"markdown-guide/#encabezados","text":"Markdown admite dos estilos de encabezados, Setext y atx. Los encabezados de estilo de texto est\u00e1n \"subrayados\" usando signos de igual (para encabezados de primer nivel) y guiones (para encabezados de segundo nivel). Por ejemplo: This is an H1 ============= This is an H2 ------------- Cualquier n\u00famero de subrayado = 's o' funcionar\u00e1. Los encabezados de estilo Atx usan 1-6 caracteres hash al comienzo de la l\u00ednea, correspondientes a los niveles de encabezado 1-6. Por ejemplo: # This is an H1 ## This is an H2 ###### This is an H6 Opcionalmente, puede \"cerrar\" los encabezados de estilo atx. Esto es puramente cosm\u00e9tico; puede usarlo si cree que se ve mejor. Los hashes de cierre ni siquiera necesitan coincidir con el n\u00famero de hashes utilizados para abrir el encabezado. (El n\u00famero de hashes de apertura determina el nivel del encabezado): # This is an H1 # ## This is an H2 ## ### This is an H3 ######","title":"ENCABEZADOS"},{"location":"markdown-guide/#citas-en-bloque","text":"Markdown utiliza caracteres de estilo de correo electr\u00f3nico > para comillas en bloque. Si est\u00e1 familiarizado con citar pasajes de texto en un mensaje de correo electr\u00f3nico, entonces sabe c\u00f3mo crear una cita en bloque en Markdown. Se ve mejor si ajusta firmemente el texto y pone un > antes de cada l\u00ednea: > This is a blockquote with two paragraphs . Lorem ipsum dolor sit amet , > consectetuer adipiscing elit . Aliquam hendrerit mi posuere lectus . > Vestibulum enim wisi , viverra nec , fringilla in , laoreet vitae , risus . > > Donec sit amet nisl . Aliquam semper ipsum sit amet velit . Suspendisse > id sem consectetuer libero luctus adipiscing . Markdown allows you to be lazy and only put the > before the first line of a hard - wrapped paragraph : > This is a blockquote with two paragraphs . Lorem ipsum dolor sit amet , consectetuer adipiscing elit . Aliquam hendrerit mi posuere lectus . Vestibulum enim wisi , viverra nec , fringilla in , laoreet vitae , risus . > Donec sit amet nisl . Aliquam semper ipsum sit amet velit . Suspendisse id sem consectetuer libero luctus adipiscing . Las citas en bloque se pueden anidar (es decir, una cita en bloque en una cita en bloque) agregando niveles adicionales de >: > This is the first level of quoting . > > > This is nested blockquote . > > Back to the first level . Las citas en bloque pueden contener otros elementos de Markdown, incluidos encabezados, listas y bloques de c\u00f3digo: > ## This is a header . > > 1 . This is the first list item . > 2 . This is the second list item . > > Here ' s some example code: > > return shell_exec ( \" echo $input | $markdown_script \" ) ; Cualquier editor de texto decente deber\u00eda facilitar las citas al estilo del correo electr\u00f3nico. Por ejemplo, con BBEdit, puede hacer una selecci\u00f3n y elegir Aumentar Nivel de Cita en el men\u00fa Texto.","title":"CITAS EN BLOQUE"},{"location":"markdown-guide/#lists","text":"Markdown admite listas ordenadas (numeradas) y no ordenadas (con vi\u00f1etas). Las listas desordenadas utilizan asteriscos, m\u00e1s y guiones - de manera intercambiable - como marcadores de lista: * Red * Green * Blue es equivalente a: + Red + Green + Blue y: - Red - Green - Blue Las listas ordenads usan numeros seguidas de puntos: 1 . Bird 2 . McHale 3 . Parish Es importante tener en cuenta que los n\u00fameros que usas para marcar la lista no tienen efecto en la salida HTML que Markdown produce. El HTML Markdown que produce la lista anterior es: <ol> <li> Bird </li> <li> McHale </li> <li> Parish </li> </ol> Si en cambio escribiste la lista en Markdown as\u00ed: 1 . Bird 1 . McHale 1 . Parish o incluso: 3 . Bird 1 . McHale 8 . Parish obtendr\u00edas exactamente la misma salida HTML. El punto es que, si lo deseas, puedes usar n\u00fameros ordinales en sus listas de Markdown ordenadas, para que los n\u00fameros en su fuente coincidan con los n\u00fameros en su HTML publicado. Pero si quieres ser flojo, no tienes que hacerlo. Sin embargo, si utilizas la numeraci\u00f3n de la lista diferida, a\u00fan debes comenzar la lista con el n\u00famero 1. En alg\u00fan momento en el futuro, Markdown puede admitir el inicio de listas ordenadas en un n\u00famero arbitrario. Los marcadores de lista generalmente comienzan en el margen izquierdo, pero pueden estar indentados por hasta tres espacios. Los marcadores de lista deben ir seguidos de uno o m\u00e1s espacios o una pesta\u00f1a. To make lists look nice, you can wrap items with hanging indents: * Lorem ipsum dolor sit amet , consectetuer adipiscing elit . Aliquam hendrerit mi posuere lectus . Vestibulum enim wisi , viverra nec , fringilla in , laoreet vitae , risus . * Donec sit amet nisl . Aliquam semper ipsum sit amet velit . Suspendisse id sem consectetuer libero luctus adipiscing . Pero si quieres ser flojo, no tienes que: * Lorem ipsum dolor sit amet , consectetuer adipiscing elit . Aliquam hendrerit mi posuere lectus . Vestibulum enim wisi , viverra nec , fringilla in , laoreet vitae , risus . * Donec sit amet nisl . Aliquam semper ipsum sit amet velit . Suspendisse id sem consectetuer libero luctus adipiscing . Si los elementos de la lista est\u00e1n separados por l\u00edneas en blanco, Markdown ajustar\u00e1 los elementos en etiquetas <p> en la salida HTML. Por ejemplo, esta entrada: * Bird * Magic Se convertir\u00e1 en: <ul> <li> Bird </li> <li> Magic </li> </ul> Pero esto: * Bird * Magic Se convertir\u00e1 en: <ul> <li><p> Bird </p></li> <li><p> Magic </p></li> </ul> Los elementos de la lista pueden consistir en m\u00faltiples p\u00e1rrafos. Cada p\u00e1rrafo posterior en un elemento de la lista debe estar sangrado por 4 espacios o una pesta\u00f1a: 1 . This is a list item with two paragraphs . Lorem ipsum dolor sit amet , consectetuer adipiscing elit . Aliquam hendrerit mi posuere lectus . Vestibulum enim wisi , viverra nec , fringilla in , laoreet vitae , risus . Donec sit amet nisl . Aliquam semper ipsum sit amet velit . 2 . Suspendisse id sem consectetuer libero luctus adipiscing . Se ve bien si indentas cada l\u00ednea de los p\u00e1rrafos posteriores, pero aqu\u00ed nuevamente, Markdown te permitir\u00e1 ser perezoso: * This is a list item with two paragraphs . This is the second paragraph in the list item . You ' re only required to indent the first line . Lorem ipsum dolor sit amet , consectetuer adipiscing elit . * Another item in the same list . Para colocar una cita en bloque dentro de un elemento de la lista, los delimitadores de la cita (>) en bloque deben indentarse: * A list item with a blockquote : > This is a blockquote > inside a list item . To put a code block within a list item , the code block needs to be indented twice \u2009 \u2014 \u2009 8 spaces or two tabs : * A list item with a code block : < code goes here > Vale la pena se\u00f1alar que es posible activar una lista ordenada por accidente, escribiendo algo como esto: 1986 . What a great season . In other words , a number - period - space sequence at the beginning of a line . To avoid this , you can backslash - escape the period : 1986 \\ . What a great season .","title":"LISTS"},{"location":"markdown-guide/#code-blocks","text":"Los bloques de c\u00f3digo formateados previamente se utilizan para escribir sobre c\u00f3digo fuente de programaci\u00f3n o marcado. En lugar de formar p\u00e1rrafos normales, las l\u00edneas de un bloque de c\u00f3digo se interpretan literalmente. Markdown envuelve un bloque de c\u00f3digo en las etiquetas <pre> y <code> . Para producir un bloque de c\u00f3digo en Markdown, simplemente sangra cada l\u00ednea del bloque por al menos 4 espacios o 1 pesta\u00f1a. Por ejemplo, dada esta entrada: This is a normal paragraph : This is a code block . Markdown generar\u00e1: <p> This is a normal paragraph: </p> <pre><code> This is a code block. </code></pre> Se elimina un nivel de sangr\u00eda, 4 espacios o 1 pesta\u00f1a, de cada l\u00ednea del bloque de c\u00f3digo. Por ejemplo, esto: Here is an example of AppleScript : tell application \" Foo \" beep end tell Se convertir\u00e1 en: < p > Here is an example of AppleScript : </ p > < pre >< code > tell application \" Foo \" beep end tell </ code ></ pre > Un bloque de c\u00f3digo contin\u00faa hasta que alcanza una l\u00ednea que no est\u00e1 sangrada (o al final del art\u00edculo). Dentro de un bloque de c\u00f3digo, los s\u00edmbolos (&) y los corchetes angulares ( ) se convierten autom\u00e1ticamente en entidades HTML. Esto hace que sea muy f\u00e1cil incluir un c\u00f3digo fuente HTML de ejemplo usando Markdown: simplemente p\u00e9guelo e indentif\u00edquelo, y Markdown se encargar\u00e1 de la molestia de codificar los s\u00edmbolos y los corchetes angulares. Por ejemplo, esto: <div class= \"footer\" > &copy; 2004 Foo Corporation </div> Se convertir\u00e1 en: <pre><code><div class= \"footer\" > &amp; copy; 2004 Foo Corporation </div> </code></pre> La sintaxis de Markdown normal no se procesa dentro de los bloques de c\u00f3digo. Por ejemplo, los asteriscos son solo asteriscos literales dentro de un bloque de c\u00f3digo. Esto significa que tambi\u00e9n es f\u00e1cil usar Markdown para escribir sobre la sintaxis propia de Markdown.","title":"CODE BLOCKS"},{"location":"markdown-guide/#reglas-horizontales","text":"Puede producir una etiqueta de regla horizontal (<hr />) colocando tres o m\u00e1s guiones, asteriscos o guiones bajos en una l\u00ednea por s\u00ed mismos. Si lo desea, puede usar espacios entre los guiones o asteriscos. Cada una de las siguientes l\u00edneas producir\u00e1 una regla horizontal: * * * *** ***** - - - ---------------------------------------","title":"REGLAS HORIZONTALES"},{"location":"markdown-guide/#elementos-span","text":"","title":"ELEMENTOS SPAN"},{"location":"markdown-guide/#links","text":"Markdown admite dos estilos de enlaces: en l\u00ednea y de referencia. En ambos estilos, el texto del enlace est\u00e1 delimitado por [corchetes]. Para crear un enlace en l\u00ednea, use un conjunto de par\u00e9ntesis regulares inmediatamente despu\u00e9s del corchete de cierre del texto del enlace. Dentro de los par\u00e9ntesis, coloque la URL donde desea que apunte el enlace, junto con un t\u00edtulo opcional para el enlace, entre comillas. Por ejemplo: This is [ an example ]( http : //example.com/ \"Title\") inline link. [ This link ]( http : //example.net/) has no title attribute. Producir\u00e1: <p> This is <a href= \"http://example.com/\" title= \"Title\" > an example </a> inline link. </p> <p><a href= \"http://example.net/\" > This link </a> has no title attribute. </p> Si se refiere a un recurso local en el mismo servidor, puede usar rutas relativas: See my [ About ] ( / about / ) page for details . Los enlaces de estilo de referencia usan un segundo conjunto de corchetes, dentro del cual coloca una etiqueta de su elecci\u00f3n para identificar el enlace: This is [ an example ][ id ] reference - style link . Opcionalmente, puede usar un espacio para separar los conjuntos de corchetes: This is [ an example ] [ id ] reference - style link . Luego, en cualquier parte del documento, define su etiqueta de enlace de esta manera, en una l\u00ednea por s\u00ed misma: [ id ] : http : // example . com / \"Optional Title Here\" Es decir: Corchetes que contienen el identificador de enlace (opcionalmente sangrado del margen izquierdo usando hasta tres espacios); seguido de dos puntos; seguido de uno o m\u00e1s espacios (o pesta\u00f1as); seguido de la URL del enlace; opcionalmente seguido por un atributo de t\u00edtulo para el enlace, entre comillas dobles o simples, o entre par\u00e9ntesis. Las siguientes tres definiciones de enlace son equivalentes: [ foo ] : http : // example . com / \"Optional Title Here\" [ foo ] : http : // example . com / 'Optional Title Here' [ foo ] : http : // example . com / ( Optional Title Here ) NOTA: Hay un error conocido en Markdown.pl 1.0.1 que evita que se usen comillas simples para delimitar los t\u00edtulos de los enlaces. La URL del enlace puede, opcionalmente, estar entre corchetes angulares: [ id ] : < http : // example . com /> \"Optional Title Here\" Puede colocar el atributo de t\u00edtulo en la siguiente l\u00ednea y usar espacios o pesta\u00f1as adicionales para el relleno, que tiende a verse mejor con URL m\u00e1s largas: [ id ] : http : // example . com / longish / path / to / resource / here \"Optional Title Here\" Las definiciones de enlace solo se usan para crear enlaces durante el procesamiento de Markdown, y se eliminan de su documento en la salida HTML. Los nombres de definici\u00f3n de enlace pueden consistir en letras, n\u00fameros, espacios y signos de puntuaci\u00f3n, pero no distinguen entre may\u00fasculas y min\u00fasculas. P.ej. estos dos enlaces: [link text][a] [link text][A] son equivalentes El acceso directo impl\u00edcito al nombre del enlace le permite omitir el nombre del enlace, en cuyo caso el texto del enlace se usa como nombre. Simplemente use un conjunto vac\u00edo de corchetes; por ejemplo, para vincular la palabra \"Google\" al sitio web google.com, simplemente puede escribir: [ Google ] [] Y luego defina el enlace: [ Google ] : http : // google . com / Como los nombres de los enlaces pueden contener espacios, este acceso directo incluso funciona para varias palabras en el texto del enlace: Visit [ Daring Fireball ][] for more information . Y entonces, define el link: [ Daring Fireball ] : http : //daringfireball.net/ Las definiciones de enlace se pueden colocar en cualquier parte de su documento Markdown. Se tiende a ponerlos inmediatamente despu\u00e9s de cada p\u00e1rrafo en el que se usan, pero si lo desea, puede ponerlos todos al final de su documento, como notas a pie de p\u00e1gina. Aqu\u00ed hay un ejemplo de enlaces de referencia en acci\u00f3n: I get 10 times more traffic from [ Google ] [ 1 ] than from [ Yahoo ] [ 2 ] or [ MSN ] [ 3 ] . [ 1 ] : http : // google . com / \"Google\" [ 2 ] : http : // search . yahoo . com / \"Yahoo Search\" [ 3 ] : http : // search . msn . com / \"MSN Search\" Usando el acceso directo de nombre de enlace impl\u00edcito, en su lugar podr\u00eda escribir: I get 10 times more traffic from [ Google ] [] than from [ Yahoo ] [] or [ MSN ] [] . [ google ] : http : // google . com / \"Google\" [ yahoo ] : http : // search . yahoo . com / \"Yahoo Search\" [ msn ] : http : // search . msn . com / \"MSN Search\" Los dos ejemplos anteriores producir\u00e1n la siguiente salida HTML: <p> I get 10 times more traffic from <a href= \"http://google.com/\" title= \"Google\" > Google </a> than from <a href= \"http://search.yahoo.com/\" title= \"Yahoo Search\" > Yahoo </a> or <a href= \"http://search.msn.com/\" title= \"MSN Search\" > MSN </a> . </p> A modo de comparaci\u00f3n, aqu\u00ed est\u00e1 el mismo p\u00e1rrafo escrito con el estilo de enlace en l\u00ednea de Markdown: I get 10 times more traffic from [ Google ] ( http : // google . com / \"Google\" ) than from [ Yahoo ] ( http : // search . yahoo . com / \"Yahoo Search\" ) or [ MSN ] ( http : // search . msn . com / \"MSN Search\" ). El punto de los enlaces de estilo de referencia no es que sean m\u00e1s f\u00e1ciles de escribir. El punto es que con los enlaces de estilo de referencia, la fuente de su documento es mucho m\u00e1s legible. Compare los ejemplos anteriores: usando enlaces de estilo de referencia, el p\u00e1rrafo en s\u00ed solo tiene 81 caracteres de longitud; con enlaces de estilo en l\u00ednea, tiene 176 caracteres; y como HTML sin procesar, tiene 234 caracteres. En el HTML sin formato, hay m\u00e1s marcado que texto. Con los enlaces de estilo de referencia de Markdown, un documento fuente se parece mucho m\u00e1s a la salida final, tal como se representa en un navegador. Al permitirle mover los metadatos relacionados con el marcado fuera del p\u00e1rrafo, puede agregar enlaces sin interrumpir el flujo narrativo de su prosa.","title":"LINKS"},{"location":"markdown-guide/#enfasis","text":"Markdown trata los asteriscos (*) y los guiones bajos ( ) como indicadores de \u00e9nfasis. El texto envuelto con uno * o _ se envolver\u00e1 con una etiqueta HTML <em> ; los dobles * \u2019o \u2019s se envolver\u00e1n con una etiqueta HTML <strong> . Por ejemplo, esta entrada: * single asterisks * _single underscores_ ** double asterisks ** __double underscores__ producir\u00e1: <em> single asterisks </em> <em> single underscores </em> <strong> double asterisks </strong> <strong> double underscores </strong> Puedes usar el estilo que prefieras; La \u00fanica restricci\u00f3n es que se debe usar el mismo car\u00e1cter para abrir y cerrar un intervalo de \u00e9nfasis. El \u00e9nfasis se puede usar en medio de una palabra: un * frigging * believable Pero si rodea un * o _ con espacios, se tratar\u00e1 como un asterisco literal o gui\u00f3n bajo. Para producir un asterisco literal o un gui\u00f3n bajo en una posici\u00f3n donde de otro modo se usar\u00eda como un delimitador de \u00e9nfasis, puede hacer una barra invertida para escapar de \u00e9l: \\ * this text is surrounded by literal asterisks \\ * Para indicar un intervalo de c\u00f3digo, envu\u00e9lvalo con comillas de retroceso (`). A diferencia de un bloque de c\u00f3digo preformateado, un intervalo de c\u00f3digo indica c\u00f3digo dentro de un p\u00e1rrafo normal. Por ejemplo: Use the ` printf () ` function . producir\u00e1: <p> Use the <code> printf() </code> function. </p> Para incluir un car\u00e1cter de retroceso literal dentro de un intervalo de c\u00f3digo, puede usar m\u00faltiples retrocesos como delimitadores de apertura y cierre: `` There is a literal backtick ( ` ) here . `` que producir\u00e1 esto: <p><code> There is a literal backtick (`) here. </code></p> Los delimitadores de retroceso que rodean un tramo de c\u00f3digo pueden incluir espacios, uno despu\u00e9s de la apertura, uno antes del cierre. Esto le permite colocar caracteres de retroceso literal al principio o al final de un intervalo de c\u00f3digo: A single backtick in a code span : `` ` `` A backtick-delimited string in a code span: `` ` foo ` ` ` producir\u00e1: < p > A single backtick in a code span : < code > `</code></p> <p>A backtick-delimited string in a code span: <code>` foo `</ code ></ p > Con una extensi\u00f3n de c\u00f3digo, los signos de uni\u00f3n y los corchetes angulares se codifican autom\u00e1ticamente como entidades HTML, lo que facilita la inclusi\u00f3n de ejemplos de etiquetas HTML. Markdown convertir\u00e1 esto: Please don ' t use any `< blink >` tags . en: <p> Please don't use any <code><blink></code> tags. </p> Puedes escribir esto: `&# 8212 ; ` is the decimal - encoded equivalent of `& mdash ; ` . para producir: <p><code> &amp; #8212; </code> is the decimal-encoded equivalent of <code> &amp; mdash; </code> . </p>","title":"\u00c9NFASIS"},{"location":"markdown-guide/#imagenes","text":"Es cierto que es bastante dif\u00edcil dise\u00f1ar una sintaxis \"natural\" para colocar im\u00e1genes en un formato de documento de texto sin formato. Markdown utiliza una sintaxis de imagen que pretende parecerse a la sintaxis de los enlaces, lo que permite dos estilos: en l\u00ednea y de referencia. La sintaxis de la imagen en l\u00ednea se ve as\u00ed: ! [ Alt text ]( / path / to / img . jpg ) ! [ Alt text ]( / path / to / img . jpg \"Optional title\" ) Es decir: Un signo de exclamaci\u00f3n:!; seguido de un conjunto de corchetes, que contiene el texto del atributo alt para la imagen; seguido de un conjunto de par\u00e9ntesis, que contiene la URL o la ruta a la imagen, y un atributo de t\u00edtulo opcional entre comillas dobles o simples. La sintaxis de la imagen de estilo de referencia se ve as\u00ed: ! [ Alt text ][ id ] Donde \"id\" es el nombre de una referencia de imagen definida. Las referencias de imagen se definen utilizando una sintaxis id\u00e9ntica a las referencias de enlace: [ id ] : url / to / image \"Optional title attribute\" Al escribir estas l\u00edneas, Markdown no tiene sintaxis para especificar las dimensiones de una imagen; Si esto es importante para usted, simplemente puede usar etiquetas HTML normales <img> .","title":"IM\u00c1GENES"},{"location":"markdown-guide/#miscelaneo","text":"","title":"MISCEL\u00c1NEO"},{"location":"markdown-guide/#links-automaticos","text":"Markdown admite un estilo de acceso directo para crear enlaces \"autom\u00e1ticos\" para URL y direcciones de correo electr\u00f3nico: simplemente rodee la URL o la direcci\u00f3n de correo electr\u00f3nico con corchetes angulares. Lo que esto significa es que si desea mostrar el texto real de una URL o direcci\u00f3n de correo electr\u00f3nico, y tambi\u00e9n hacer que sea un enlace en el que se pueda hacer clic, puede hacer esto: < http : // example . com /> Markdown convertir\u00e1 esto en: <a href= \"http://example.com/\" > http://example.com/ </a> Los enlaces autom\u00e1ticos para direcciones de correo electr\u00f3nico funcionan de manera similar, excepto que Markdown tambi\u00e9n realizar\u00e1 un poco de codificaci\u00f3n aleatoria de entidades decimales y hexadecimales para ayudar a ocultar su direcci\u00f3n de los robots de spam que recolectan direcciones. Por ejemplo, Markdown convertir\u00e1 esto: < address @example . com > en algo como esto: <a href= \"&#x6D;&#x61;i&#x6C;&#x74;&#x6F;:&#x61;&#x64;&#x64;&#x72;&#x65; &#115;&#115;&#64;&#101;&#120;&#x61;&#109;&#x70;&#x6C;e&#x2E;&#99;&#111; &#109;\" > &#x61;&#x64;&#x64;&#x72;&#x65;&#115;&#115;&#64;&#101;&#120;&#x61; &#109;&#x70;&#x6C; e &#x2E;&#99;&#111;&#109; </a> que se mostrar\u00e1 en un navegador como un enlace en el que se puede hacer clic en \"direcci\u00f3n@ejemplo.com\". (Este tipo de truco de codificaci\u00f3n de entidades realmente enga\u00f1ar\u00e1 a muchos, si no a la mayor\u00eda, a los robots de recolecci\u00f3n de direcciones, pero definitivamente no los enga\u00f1ar\u00e1 a todos. Es mejor que nada, pero una direcci\u00f3n publicada de esta manera probablemente comenzar\u00e1 a recibir correo no deseado.)","title":"LINKS AUTOM\u00c1TICOS"},{"location":"markdown-guide/#escape-de-barra-invertida","text":"Markdown le permite usar escapes de barra invertida para generar caracteres literales que de otro modo tendr\u00edan un significado especial en la sintaxis de formato de Markdown. Por ejemplo, si desea rodear una palabra con asteriscos literales (en lugar de una etiqueta HTML <em> ), puede usar barras invertidas antes de los asteriscos, de esta manera: \\ * literal asterisks \\ * Markdown proporciona escapes de barra invertida para los siguientes caracteres: \\ barra invertida ` retroceso * asterisco _ guion bajo {} llaves [] corchetes () par\u00e9ntesis # s\u00edmbolo de hash + signo m\u00e1s - signo menos ( gui\u00f3n ) . punto ! signo de exclamaci\u00f3n","title":"ESCAPE DE BARRA INVERTIDA"},{"location":"quickstart/","text":"Comenzar a usar Andino Indice Primeros pasos Entrar y salir de tu portal Permisos de usuario Elementos de tu portal Organizaciones Secci\u00f3n Organizaciones con datos Secci\u00f3n Acerca Temas Datasets Recursos Campos de un recurso Series de tiempo Etiquetas Personalizar el portal Integrar Andino con Google Analytics Consultas sobre Andino Otros contenidos \u00fatiles Primeros pasos \u00a1Un aplauso, ya est\u00e1s abriendo tus datos! Esta gu\u00eda te ayudar\u00e1 a: Conocer los elementos del cat\u00e1logo e identificar d\u00f3nde se ven en el portal. Personalizar el portal. Crear datasets, recursos, organizaciones y temas. Asignar permisos de usuarios. Integrar con Google Analytics. \u00a1Arranquemos! Entrar y salir de tu portal Cada vez que quieras entrar al portal, podr\u00e1s hacerlo desde http:// tu-url.com /ingresar . Permisos de usuario Desde agosto de 2017, en Andino hay dos tipos de usuarios: los administradores y los colaboradores . El primer usuario administrador siempre es creado por el t\u00e9cnico en sistemas que instal\u00f3 Andino. Los administradores de Andino pueden invitar a m\u00e1s personas a colaborar en la apertura de datos, eligiendo el tipo que quieren asignar : Administrador : podr\u00e1 crear usuarios, editar la configuraci\u00f3n general del portal; crear, actualizar y borrar todos los datasets; y gestionar temas y organizaciones. Colaborador : podr\u00e1 crear, actualizar y borrar datasets s\u00f3lo de las organizaciones que tenga asignadas (por eso es importante que primero crees en tu Andino las organizaciones en las que necesit\u00e1s colaboradores). Asign\u00e1 permisos desde Mi cuenta > Crear usuarios . Elementos de tu portal Organizaciones Son los organismos que abren o mantienen cada dataset. Es muy importante que crees las organizaciones antes de que generes un dataset que est\u00e9 asociado a ella. \u00bfD\u00f3nde lo veo en el portal? Como uno de los filtros de la vista de Datasets. Como n\u00famero agregado, en la P\u00e1gina principal de tu portal, en caso de que hayas elegido la vista que muestra el n\u00famero de Organizaciones con datos. Buenas pr\u00e1cticas al crear Organizaciones con datos Ten\u00e9 en cuenta que siempre que borres una organizaci\u00f3n, todos los conjuntos de datos (y tambi\u00e9n los recursos), se borrar\u00e1n definitivamente. \u00bfC\u00f3mo los creo? And\u00e1 a P\u00e1gina principal > Crear Organizaciones . En caso de que hayas elegido que tu portal tenga una secci\u00f3n de Organizaciones con datos, tambi\u00e9n se mostrar\u00e1n all\u00ed. Secci\u00f3n Organizaciones con datos Esta secci\u00f3n es opcional . Te permite armar un \u00e1rbol de jerarqu\u00edas con las organizaciones que abrieron datos en tu portal. Los organismos que se muestran en esta parte de tu portal son los mismos que asign\u00e1s a los datasets y que cre\u00e1s antes de generar estos \u00faltimos. \u00bfD\u00f3nde lo veo en el portal? En P\u00e1gina principal > Organizaciones con datos . Buenas pr\u00e1cticas al crear la secci\u00f3n Organizaciones con datos Es importante que tengas bien en claro qu\u00e9 organizaciones dependenden de otras, para que el \u00e1rbol de jerarqu\u00edas represente bien las correspondencias. \u00bfC\u00f3mo las creo? Como la secci\u00f3n Organizaciones con datos es opcional, pod\u00e9s elegir que se vea en tu portal. Para eso, and\u00e1 a Configuraciones > Organizaciones con datos y tild\u00e1 la habilitaci\u00f3n. Secci\u00f3n Acerca Esta secci\u00f3n es opcional . Te permite darle la oportunidad a los usuarios que naveguen tu portal de leer informaci\u00f3n del mismo para un mejor entendimiento. Tipos de Acerca Existen tres tipos diferentes que vas a poder elegir: Sin secci\u00f3n de acerca : para cuando se decida no mostrar informaci\u00f3n. Secci\u00f3n con informaci\u00f3n b\u00e1sica : existir\u00e1 un bot\u00f3n que lleve al usuario a una p\u00e1gina donde encontrar\u00e1 informaci\u00f3n b\u00e1sica sobre el portal (un t\u00edtulo y una descripci\u00f3n). Estar\u00e1 ubicado en P\u00e1gina Principal > Acerca . Secciones personalizadas : se crear\u00e1n varias secciones personalizadas que vas a poder modificar a gusto. El bot\u00f3n Acerca ahora desplegar\u00e1 un men\u00fa que contendr\u00e1 todas y cada una de las secciones que hayas a\u00f1adido al portal. Para cada secci\u00f3n, se necesitar\u00e1 un archivo (de formato .html) con el contenido que quieras mostrar. \u00bfC\u00f3mo elijo el tipo de Acerca? And\u00e1 a P\u00e1gina Principal > Usuario > Configuraci\u00f3n > Otras secciones del portal > Acerca (opcional) \u00bfC\u00f3mo puedo escribir y mostrar informaci\u00f3n b\u00e1sica? Habiendo elegido la segunda opci\u00f3n , pod\u00e9s modificar el t\u00edtulo y la descripci\u00f3n. \u00bfC\u00f3mo puedo crear y mostrar mis secciones personalizadas? Habiendo elegido la tercera opci\u00f3n , podr\u00e1s ir creando tus secciones escribiendo un t\u00edtulo y un nombre de archivo. Record\u00e1 que, para cada secci\u00f3n, ser\u00e1 necesario guardar un archivo (de formato .html) para que el portal pueda mostrar su contenido. \u00bfD\u00f3nde a\u00f1ado los archivos requeridos para las secciones? Dentro del container, dichos archivos deben ser guardados en el directorio /var/lib/ckan/theme_config/templates/ . De no existir la carpeta /templates , se deber\u00e1 crearla utilizando dos comandos: mkdir /var/lib/ckan/theme_config/templates chown www-data:www-data /var/lib/ckan/theme_config/templates/ (www-data es el usuario con el que se corre el proceso apache en el sistema operativo Ubuntu ) Dentro de cada archivo deber\u00e1 estar el contenido de su secci\u00f3n correspondiente. Por favor, no te olvides de que el nombre del archivo debe coincidir con lo escrito en el campo 'Nombre del archivo' de la secci\u00f3n. \u00bfD\u00f3nde y c\u00f3mo puedo guardar im\u00e1genes para mostrarlas en mis secciones? \u00bfC\u00f3mo las muestro en mis templates? Dentro del container, las im\u00e1genes deben ser guardadas en una carpeta llamada \"user_images\". Para poder copiar y pegar una imagen en dicha carpeta existe un comando que pod\u00e9s usar, pero primero ten\u00e9s que hacer tres cosas: Dentro del contenedor, ejecutar este comando: chown www - data : www - data / usr / lib / ckan / default / src / ckanext - gobar - theme / ckanext / gobar_theme / public / user_images / En caso de que hayas cambiado manualmente el puerto del contenedor, saber cu\u00e1l es (el default es 8080) Tener preparado el nombre del contenedor (ya que queremos decirle al comando en qu\u00e9 lugar vamos a guardar la imagen) El nombre del contenedor se consigue escribiendo en una terminal dentro del host: sudo docker - compose - f latest . yml ps | grep < puerto del container > S\u00f3lo nos queda guardar la imagen: docker cp < nombre de la imagen > < nombre del contendor portal > : / usr / lib / ckan / default / src / ckanext - gobar - theme / ckanext / gobar_theme / public / user_images / Supongamos que guardaste una imagen llamada 'mi_imagen.png'; para poder utilizarla, pod\u00e9s escribir dentro de tu template esta l\u00ednea (completa): < img src = \"/user_images/mi_imagen.png\" > Temas Son las categor\u00edas en las que se pueden clasificar todos los datasets de tu portal. Hay dos taxonom\u00edas de temas: Temas globales , que ya vienen con Andino, y que necesit\u00e1s elegir para cada dataset. Estos temas no se ven en tu portal, pero es necesario que lo elijas para que el portal nacional datos.gob.ar pueda republicar el dataset seg\u00fan esta clasificaci\u00f3n. Por ejemplo: \"Econom\u00eda y finanzas\". Temas espec\u00edficos , que son opcionales, pero que te recomendamos con \u00e9nfasis que agregues a todos tus conjuntos de datos porque son los temas que van a ver tus usuarios. Por ejemplo, si el tema global era \"Econom\u00eda y finanzas\", un tema espec\u00edfico podr\u00eda ser \"Compras\". \u00bfD\u00f3nde lo veo en el portal? En la P\u00e1gina principal de tu cat\u00e1logo de datos. Tambi\u00e9n como detalle de cada dataset espec\u00edfico. Buenas pr\u00e1cticas al crear Temas espec\u00edficos Intent\u00e1 crear los temas espec\u00edficos a conciencia para poder reutilizarlos a futuro. No crees un tema espec\u00edfico por cada dataset. Asegurate de que cada tema espec\u00edfico sea un aparte m\u00e1s peque\u00f1a dentro de los Temas globales. \u00bfC\u00f3mo los creo? And\u00e1 a P\u00e1gina principal > Crear tema . \u00bfC\u00f3mo los asigno? Cada vez que generes un nuevo dataset , el formulario te pedir\u00e1 que asignes temas. Record\u00e1 siempre reutilizar los que ya hayas creado y no repetirlos. Datasets Tambi\u00e9n los llamamos \"conjuntos de datos\". Son la pieza principal de tu portal o cat\u00e1logo de datos. Cada dataset est\u00e1 formado por uno o m\u00e1s recursos. \u00bfD\u00f3nde los veo en el portal? Todos los datasets que subas al portal se ver\u00e1n en la secci\u00f3n Datasets . Adem\u00e1s, podr\u00e1s destacar los que creas m\u00e1s importantes en la P\u00e1gina principal. Buenas pr\u00e1cticas al crear datasets T\u00edtulos de los datasets : es el primer vistazo que los usuarios tendr\u00e1n sobre su contenido. Por eso, intent\u00e1 no superar los 100 caracteres. Prest\u00e1 especial atenci\u00f3n a las may\u00fasculas. S\u00f3lo los sustantivos propios las necesitan. Descripci\u00f3n de los datasets : es el detalle que le cont\u00e1s a los usuarios. Por esa raz\u00f3n, es importante que trates de dar una explicaci\u00f3n general de los datos con los que se va a encontrar. Intent\u00e1 no superar los 500 caracteres. \u00bfC\u00f3mo los creo? Ingres\u00e1 a tu cuenta y and\u00e1 a P\u00e1gina principal > Crear dataset . Siempre podr\u00e1s editar los dataset que hayas creado. Para eso, ingres\u00e1 a tu cuenta > P\u00e1gina principal > Datasets > Editar dataset . Recursos Cada dataset est\u00e1 formado por, al menos, un recurso. Por eso decimos que los recursos son la pieza de informaci\u00f3n m\u00e1s peque\u00f1a del cat\u00e1logo y los verdaderos activos de datos del portal. \u00bfD\u00f3nde los veo en el portal? P\u00e1gina principal > Datasets > Clic en el recurso espec\u00edfico. Buenas pr\u00e1cticas al crear recursos Segu\u00ed los mismos criterios de escritura que con los datasets. T\u00edtulos de los recursos : intent\u00e1 no superar los 150 caracteres. Descripci\u00f3n de los recursos : intent\u00e1 no superar los 200 caracteres. \u00bfC\u00f3mo los creo? Ingres\u00e1 a tu cuenta y and\u00e1 a P\u00e1gina principal > Crear dataset. Una vez que completes el dataset, podr\u00e1s agregar recursos. Al igual que con los datasets, siempre podr\u00e1s editar los recursos que hayas creado. Para eso, ingres\u00e1 a tu cuenta > P\u00e1gina principal > Datasets > Editar dataset > Editar recursos. \u00bfEn qu\u00e9 consiste embeberlos? Significa poder utilizar el preview de un recurso perteneciente a otro portal. Para hacerlo, se debe hacer click en el bot\u00f3n \"Embeber\", lo cual mostrar\u00e1 una ventana con el c\u00f3digo HTML de un iframe que pod\u00e9s usar en alguna parte de tu portal, junto con los valores configurables del ancho y la altura que quer\u00e9s que tenga el preview. Ten\u00e9 en cuenta que, para que se puedan embeber los recursos de tu portal, necesit\u00e1s agregar la URL de tu portal al whitelist para CORS en el archivo de configuraci\u00f3n . Campos de un recurso Los recursos pueden tener mucha informaci\u00f3n y ser dif\u00edciles de comprender. Para ayudar a los usuarios que ven nuestros recursos, Andino permite documentar qu\u00e9 contiene cada campo. \u00bfD\u00f3nde los veo en el portal? Los recursos que tengan informaci\u00f3n sobre sus campos se visualizar\u00e1n en la vista de un recurso. Buenas pr\u00e1cticas al cargar campos de un recurso Puede ser de mucha ayuda para los usuarios que siempre cargues al menos los siguientes campos: - T\u00edtulo de la columna - Tipo de dato - Descripci\u00f3n Tambi\u00e9n pod\u00e9s usar estos campos para documentar aspectos m\u00e1s avanzados de las columnas de un recurso: - Unidad de medida - Identificador - Tipo de dato especial - Detalle de tipo especial Series de tiempo Andino permite documentar recursos que publican series de tiempo . Un recurso con series de tiempo es un archivo CSV de determinada estructura . \u00bfC\u00f3mo documento una serie de tiempo? En el formulario de carga de un recurso vas a encontrar campos avanzados y especiales que necesit\u00e1s usar para documentar las columnas de una tabla que contiene series de tiempo. Los campos Tipo de dato especial y Detalle de tipo especial te permiten marcar la columna del \u00edndice de tiempo y qu\u00e9 frecuencia tiene. Tipo de dato especial : marcar la columna que tiene las fechas como \"Indice de tiempo\". Detalle de tipo de dato especial : especificar la frecuencia del \u00edndice (anual, diaria, mensual, etc). Los campos Unidad de medida e Identificador te permiten documentar cada una de las columnas, que son tus series de tiempo. Unidad de medida : es la unidad de medida en que est\u00e1 expresada la serie (\"Millones de pesos corrientes\", \"Kil\u00f3metros\", \"Millones de d\u00f3lares americanos\") Identificador : es un identificador \u00fanico de la serie para toda la APN. Debe ser inmutable en el tiempo para la serie, no muy largo (entre 6 y 20 caracteres aproximadamente) y no pisarse potencialmente con otras series de la Administraci\u00f3n P\u00fablica Nacional. Para conocer m\u00e1s sobre series de tiempo mir\u00e1 la documentaci\u00f3n completa en el perfil de metadatos. Etiquetas Son las palabras que ayudan a los usuarios a filtrar y encontrar los datasets. Cuanto m\u00e1s amplia y uniforme sea la lista de Etiquetas, mayor es su poder de ayuda. \u00bfD\u00f3nde las veo en el portal? En cada dataset espec\u00edfico. Buenas pr\u00e1cticas al crear etiquetas Us\u00e1 may\u00fasculas s\u00f3lo donde corresponda. Identific\u00e1 palabras claves. Respet\u00e1 las etiquetas anteriores. Agreg\u00e1 sin\u00f3nimos y us\u00e1 lenguaje natural. Trat\u00e1 de usar una sola palabra, siempre en plural. Si la etiqueta tiene m\u00e1s de una palabra, separalas por un espacio. Por ejemplo: \"declaraciones juradas\". \u00c9stas son algunas preguntas \u00fatiles a la hora de pensar las etiquetas: \u00bfCu\u00e1l es el tema? \u00bfQu\u00e9 aspectos ser\u00e1n de inter\u00e9s para los usuarios? \u00bfDe qu\u00e9 otro modo buscar\u00eda el usuario esta informaci\u00f3n? \u00bfDe qu\u00e9 tipo de informaci\u00f3n se trata? \u00bfQu\u00e9 \u00e1rea la provee? \u00bfC\u00f3mo las creo? Al igual que con los Temas, cada vez que generes un nuevo dataset, el formulario te pedir\u00e1 que asignes un etiqueta. Record\u00e1 siempre reutilizar las que ya hayas creado y no repetirlas. Personalizar el portal Hacer que tu portal represente tu organizaci\u00f3n es muy f\u00e1cil. Por favor, and\u00e1 a la P\u00e1gina principal > Configuraci\u00f3n . Llegar\u00e1s a la secci\u00f3n que te permite cambiar c\u00f3mo luce la portada de tu cat\u00e1logo de datos y cada secci\u00f3n en particular. Integrar Andino con Google Analytics Por favor, escribinos y contanos con qu\u00e9 casilla de e-mail quer\u00e9s tener permisos para ver las m\u00e9tricas de tu Andino. Consultas sobre Andino Andino es un portal abierto en constante desarrollo para ser usado por toda la comunidad de datos. Por eso, cuando incorporamos una nueva mejora, cuidamos mucho su compatibilidad con la versi\u00f3n anterior . Como la comunidad de datos es grande, por ahora no podemos dar soporte t\u00e9cnico frente a modificaciones particulares del c\u00f3digo . Sin embargo, pod\u00e9s contactarnos para despejar dudas . Te invitamos a crear issues o enviarnos sugerencias en caso de que encuentren alg\u00fan bug o tengas feedback . Tambi\u00e9n pod\u00e9s mandarnos tu comentario o consulta a datos@modernizacion.gob.ar Otros contenidos \u00fatiles Gu\u00eda para el uso y la publicaci\u00f3n de metadatos Gu\u00eda para la identificaci\u00f3n y uso de entidades interoperables Gu\u00eda para la publicaci\u00f3n de datos en formatos abiertos","title":"Comenzar a usar Andino"},{"location":"quickstart/#comenzar-a-usar-andino","text":"","title":"Comenzar a usar Andino"},{"location":"quickstart/#indice","text":"Primeros pasos Entrar y salir de tu portal Permisos de usuario Elementos de tu portal Organizaciones Secci\u00f3n Organizaciones con datos Secci\u00f3n Acerca Temas Datasets Recursos Campos de un recurso Series de tiempo Etiquetas Personalizar el portal Integrar Andino con Google Analytics Consultas sobre Andino Otros contenidos \u00fatiles","title":"Indice"},{"location":"quickstart/#primeros-pasos","text":"\u00a1Un aplauso, ya est\u00e1s abriendo tus datos! Esta gu\u00eda te ayudar\u00e1 a: Conocer los elementos del cat\u00e1logo e identificar d\u00f3nde se ven en el portal. Personalizar el portal. Crear datasets, recursos, organizaciones y temas. Asignar permisos de usuarios. Integrar con Google Analytics. \u00a1Arranquemos!","title":"Primeros pasos"},{"location":"quickstart/#entrar-y-salir-de-tu-portal","text":"Cada vez que quieras entrar al portal, podr\u00e1s hacerlo desde http:// tu-url.com /ingresar .","title":"Entrar y salir de tu portal"},{"location":"quickstart/#permisos-de-usuario","text":"Desde agosto de 2017, en Andino hay dos tipos de usuarios: los administradores y los colaboradores . El primer usuario administrador siempre es creado por el t\u00e9cnico en sistemas que instal\u00f3 Andino. Los administradores de Andino pueden invitar a m\u00e1s personas a colaborar en la apertura de datos, eligiendo el tipo que quieren asignar : Administrador : podr\u00e1 crear usuarios, editar la configuraci\u00f3n general del portal; crear, actualizar y borrar todos los datasets; y gestionar temas y organizaciones. Colaborador : podr\u00e1 crear, actualizar y borrar datasets s\u00f3lo de las organizaciones que tenga asignadas (por eso es importante que primero crees en tu Andino las organizaciones en las que necesit\u00e1s colaboradores). Asign\u00e1 permisos desde Mi cuenta > Crear usuarios .","title":"Permisos de usuario"},{"location":"quickstart/#elementos-de-tu-portal","text":"","title":"Elementos de tu portal"},{"location":"quickstart/#organizaciones","text":"Son los organismos que abren o mantienen cada dataset. Es muy importante que crees las organizaciones antes de que generes un dataset que est\u00e9 asociado a ella.","title":"Organizaciones"},{"location":"quickstart/#donde-lo-veo-en-el-portal","text":"Como uno de los filtros de la vista de Datasets. Como n\u00famero agregado, en la P\u00e1gina principal de tu portal, en caso de que hayas elegido la vista que muestra el n\u00famero de Organizaciones con datos.","title":"\u00bfD\u00f3nde lo veo en el portal?"},{"location":"quickstart/#buenas-practicas-al-crear-organizaciones-con-datos","text":"Ten\u00e9 en cuenta que siempre que borres una organizaci\u00f3n, todos los conjuntos de datos (y tambi\u00e9n los recursos), se borrar\u00e1n definitivamente.","title":"Buenas pr\u00e1cticas al crear Organizaciones con datos"},{"location":"quickstart/#como-los-creo","text":"And\u00e1 a P\u00e1gina principal > Crear Organizaciones . En caso de que hayas elegido que tu portal tenga una secci\u00f3n de Organizaciones con datos, tambi\u00e9n se mostrar\u00e1n all\u00ed.","title":"\u00bfC\u00f3mo los creo?"},{"location":"quickstart/#seccion-organizaciones-con-datos","text":"Esta secci\u00f3n es opcional . Te permite armar un \u00e1rbol de jerarqu\u00edas con las organizaciones que abrieron datos en tu portal. Los organismos que se muestran en esta parte de tu portal son los mismos que asign\u00e1s a los datasets y que cre\u00e1s antes de generar estos \u00faltimos.","title":"Secci\u00f3n Organizaciones con datos"},{"location":"quickstart/#donde-lo-veo-en-el-portal_1","text":"En P\u00e1gina principal > Organizaciones con datos .","title":"\u00bfD\u00f3nde lo veo en el portal?"},{"location":"quickstart/#buenas-practicas-al-crear-la-seccion-organizaciones-con-datos","text":"Es importante que tengas bien en claro qu\u00e9 organizaciones dependenden de otras, para que el \u00e1rbol de jerarqu\u00edas represente bien las correspondencias.","title":"Buenas pr\u00e1cticas al crear la secci\u00f3n Organizaciones con datos"},{"location":"quickstart/#como-las-creo","text":"Como la secci\u00f3n Organizaciones con datos es opcional, pod\u00e9s elegir que se vea en tu portal. Para eso, and\u00e1 a Configuraciones > Organizaciones con datos y tild\u00e1 la habilitaci\u00f3n.","title":"\u00bfC\u00f3mo las creo?"},{"location":"quickstart/#seccion-acerca","text":"Esta secci\u00f3n es opcional . Te permite darle la oportunidad a los usuarios que naveguen tu portal de leer informaci\u00f3n del mismo para un mejor entendimiento.","title":"Secci\u00f3n Acerca"},{"location":"quickstart/#tipos-de-acerca","text":"Existen tres tipos diferentes que vas a poder elegir: Sin secci\u00f3n de acerca : para cuando se decida no mostrar informaci\u00f3n. Secci\u00f3n con informaci\u00f3n b\u00e1sica : existir\u00e1 un bot\u00f3n que lleve al usuario a una p\u00e1gina donde encontrar\u00e1 informaci\u00f3n b\u00e1sica sobre el portal (un t\u00edtulo y una descripci\u00f3n). Estar\u00e1 ubicado en P\u00e1gina Principal > Acerca . Secciones personalizadas : se crear\u00e1n varias secciones personalizadas que vas a poder modificar a gusto. El bot\u00f3n Acerca ahora desplegar\u00e1 un men\u00fa que contendr\u00e1 todas y cada una de las secciones que hayas a\u00f1adido al portal. Para cada secci\u00f3n, se necesitar\u00e1 un archivo (de formato .html) con el contenido que quieras mostrar.","title":"Tipos de Acerca"},{"location":"quickstart/#como-elijo-el-tipo-de-acerca","text":"And\u00e1 a P\u00e1gina Principal > Usuario > Configuraci\u00f3n > Otras secciones del portal > Acerca (opcional)","title":"\u00bfC\u00f3mo elijo el tipo de Acerca?"},{"location":"quickstart/#como-puedo-escribir-y-mostrar-informacion-basica","text":"Habiendo elegido la segunda opci\u00f3n , pod\u00e9s modificar el t\u00edtulo y la descripci\u00f3n.","title":"\u00bfC\u00f3mo puedo escribir y mostrar informaci\u00f3n b\u00e1sica?"},{"location":"quickstart/#como-puedo-crear-y-mostrar-mis-secciones-personalizadas","text":"Habiendo elegido la tercera opci\u00f3n , podr\u00e1s ir creando tus secciones escribiendo un t\u00edtulo y un nombre de archivo. Record\u00e1 que, para cada secci\u00f3n, ser\u00e1 necesario guardar un archivo (de formato .html) para que el portal pueda mostrar su contenido.","title":"\u00bfC\u00f3mo puedo crear y mostrar mis secciones personalizadas?"},{"location":"quickstart/#donde-anado-los-archivos-requeridos-para-las-secciones","text":"Dentro del container, dichos archivos deben ser guardados en el directorio /var/lib/ckan/theme_config/templates/ . De no existir la carpeta /templates , se deber\u00e1 crearla utilizando dos comandos: mkdir /var/lib/ckan/theme_config/templates chown www-data:www-data /var/lib/ckan/theme_config/templates/ (www-data es el usuario con el que se corre el proceso apache en el sistema operativo Ubuntu ) Dentro de cada archivo deber\u00e1 estar el contenido de su secci\u00f3n correspondiente. Por favor, no te olvides de que el nombre del archivo debe coincidir con lo escrito en el campo 'Nombre del archivo' de la secci\u00f3n.","title":"\u00bfD\u00f3nde a\u00f1ado los archivos requeridos para las secciones?"},{"location":"quickstart/#donde-y-como-puedo-guardar-imagenes-para-mostrarlas-en-mis-secciones-como-las-muestro-en-mis-templates","text":"Dentro del container, las im\u00e1genes deben ser guardadas en una carpeta llamada \"user_images\". Para poder copiar y pegar una imagen en dicha carpeta existe un comando que pod\u00e9s usar, pero primero ten\u00e9s que hacer tres cosas: Dentro del contenedor, ejecutar este comando: chown www - data : www - data / usr / lib / ckan / default / src / ckanext - gobar - theme / ckanext / gobar_theme / public / user_images / En caso de que hayas cambiado manualmente el puerto del contenedor, saber cu\u00e1l es (el default es 8080) Tener preparado el nombre del contenedor (ya que queremos decirle al comando en qu\u00e9 lugar vamos a guardar la imagen) El nombre del contenedor se consigue escribiendo en una terminal dentro del host: sudo docker - compose - f latest . yml ps | grep < puerto del container > S\u00f3lo nos queda guardar la imagen: docker cp < nombre de la imagen > < nombre del contendor portal > : / usr / lib / ckan / default / src / ckanext - gobar - theme / ckanext / gobar_theme / public / user_images / Supongamos que guardaste una imagen llamada 'mi_imagen.png'; para poder utilizarla, pod\u00e9s escribir dentro de tu template esta l\u00ednea (completa): < img src = \"/user_images/mi_imagen.png\" >","title":"\u00bfD\u00f3nde y c\u00f3mo puedo guardar im\u00e1genes para mostrarlas en mis secciones? \u00bfC\u00f3mo las muestro en mis templates?"},{"location":"quickstart/#temas","text":"Son las categor\u00edas en las que se pueden clasificar todos los datasets de tu portal. Hay dos taxonom\u00edas de temas: Temas globales , que ya vienen con Andino, y que necesit\u00e1s elegir para cada dataset. Estos temas no se ven en tu portal, pero es necesario que lo elijas para que el portal nacional datos.gob.ar pueda republicar el dataset seg\u00fan esta clasificaci\u00f3n. Por ejemplo: \"Econom\u00eda y finanzas\". Temas espec\u00edficos , que son opcionales, pero que te recomendamos con \u00e9nfasis que agregues a todos tus conjuntos de datos porque son los temas que van a ver tus usuarios. Por ejemplo, si el tema global era \"Econom\u00eda y finanzas\", un tema espec\u00edfico podr\u00eda ser \"Compras\".","title":"Temas"},{"location":"quickstart/#donde-lo-veo-en-el-portal_2","text":"En la P\u00e1gina principal de tu cat\u00e1logo de datos. Tambi\u00e9n como detalle de cada dataset espec\u00edfico.","title":"\u00bfD\u00f3nde lo veo en el portal?"},{"location":"quickstart/#buenas-practicas-al-crear-temas-especificos","text":"Intent\u00e1 crear los temas espec\u00edficos a conciencia para poder reutilizarlos a futuro. No crees un tema espec\u00edfico por cada dataset. Asegurate de que cada tema espec\u00edfico sea un aparte m\u00e1s peque\u00f1a dentro de los Temas globales.","title":"Buenas pr\u00e1cticas al crear Temas espec\u00edficos"},{"location":"quickstart/#como-los-creo_1","text":"And\u00e1 a P\u00e1gina principal > Crear tema .","title":"\u00bfC\u00f3mo los creo?"},{"location":"quickstart/#como-los-asigno","text":"Cada vez que generes un nuevo dataset , el formulario te pedir\u00e1 que asignes temas. Record\u00e1 siempre reutilizar los que ya hayas creado y no repetirlos.","title":"\u00bfC\u00f3mo los asigno?"},{"location":"quickstart/#datasets","text":"Tambi\u00e9n los llamamos \"conjuntos de datos\". Son la pieza principal de tu portal o cat\u00e1logo de datos. Cada dataset est\u00e1 formado por uno o m\u00e1s recursos.","title":"Datasets"},{"location":"quickstart/#donde-los-veo-en-el-portal","text":"Todos los datasets que subas al portal se ver\u00e1n en la secci\u00f3n Datasets . Adem\u00e1s, podr\u00e1s destacar los que creas m\u00e1s importantes en la P\u00e1gina principal.","title":"\u00bfD\u00f3nde los veo en el portal?"},{"location":"quickstart/#buenas-practicas-al-crear-datasets","text":"T\u00edtulos de los datasets : es el primer vistazo que los usuarios tendr\u00e1n sobre su contenido. Por eso, intent\u00e1 no superar los 100 caracteres. Prest\u00e1 especial atenci\u00f3n a las may\u00fasculas. S\u00f3lo los sustantivos propios las necesitan. Descripci\u00f3n de los datasets : es el detalle que le cont\u00e1s a los usuarios. Por esa raz\u00f3n, es importante que trates de dar una explicaci\u00f3n general de los datos con los que se va a encontrar. Intent\u00e1 no superar los 500 caracteres.","title":"Buenas pr\u00e1cticas al crear datasets"},{"location":"quickstart/#como-los-creo_2","text":"Ingres\u00e1 a tu cuenta y and\u00e1 a P\u00e1gina principal > Crear dataset . Siempre podr\u00e1s editar los dataset que hayas creado. Para eso, ingres\u00e1 a tu cuenta > P\u00e1gina principal > Datasets > Editar dataset .","title":"\u00bfC\u00f3mo los creo?"},{"location":"quickstart/#recursos","text":"Cada dataset est\u00e1 formado por, al menos, un recurso. Por eso decimos que los recursos son la pieza de informaci\u00f3n m\u00e1s peque\u00f1a del cat\u00e1logo y los verdaderos activos de datos del portal.","title":"Recursos"},{"location":"quickstart/#donde-los-veo-en-el-portal_1","text":"P\u00e1gina principal > Datasets > Clic en el recurso espec\u00edfico.","title":"\u00bfD\u00f3nde los veo en el portal?"},{"location":"quickstart/#buenas-practicas-al-crear-recursos","text":"Segu\u00ed los mismos criterios de escritura que con los datasets. T\u00edtulos de los recursos : intent\u00e1 no superar los 150 caracteres. Descripci\u00f3n de los recursos : intent\u00e1 no superar los 200 caracteres.","title":"Buenas pr\u00e1cticas al crear recursos"},{"location":"quickstart/#como-los-creo_3","text":"Ingres\u00e1 a tu cuenta y and\u00e1 a P\u00e1gina principal > Crear dataset. Una vez que completes el dataset, podr\u00e1s agregar recursos. Al igual que con los datasets, siempre podr\u00e1s editar los recursos que hayas creado. Para eso, ingres\u00e1 a tu cuenta > P\u00e1gina principal > Datasets > Editar dataset > Editar recursos.","title":"\u00bfC\u00f3mo los creo?"},{"location":"quickstart/#en-que-consiste-embeberlos","text":"Significa poder utilizar el preview de un recurso perteneciente a otro portal. Para hacerlo, se debe hacer click en el bot\u00f3n \"Embeber\", lo cual mostrar\u00e1 una ventana con el c\u00f3digo HTML de un iframe que pod\u00e9s usar en alguna parte de tu portal, junto con los valores configurables del ancho y la altura que quer\u00e9s que tenga el preview. Ten\u00e9 en cuenta que, para que se puedan embeber los recursos de tu portal, necesit\u00e1s agregar la URL de tu portal al whitelist para CORS en el archivo de configuraci\u00f3n .","title":"\u00bfEn qu\u00e9 consiste embeberlos?"},{"location":"quickstart/#campos-de-un-recurso","text":"Los recursos pueden tener mucha informaci\u00f3n y ser dif\u00edciles de comprender. Para ayudar a los usuarios que ven nuestros recursos, Andino permite documentar qu\u00e9 contiene cada campo.","title":"Campos de un recurso"},{"location":"quickstart/#donde-los-veo-en-el-portal_2","text":"Los recursos que tengan informaci\u00f3n sobre sus campos se visualizar\u00e1n en la vista de un recurso.","title":"\u00bfD\u00f3nde los veo en el portal?"},{"location":"quickstart/#buenas-practicas-al-cargar-campos-de-un-recurso","text":"Puede ser de mucha ayuda para los usuarios que siempre cargues al menos los siguientes campos: - T\u00edtulo de la columna - Tipo de dato - Descripci\u00f3n Tambi\u00e9n pod\u00e9s usar estos campos para documentar aspectos m\u00e1s avanzados de las columnas de un recurso: - Unidad de medida - Identificador - Tipo de dato especial - Detalle de tipo especial","title":"Buenas pr\u00e1cticas al cargar campos de un recurso"},{"location":"quickstart/#series-de-tiempo","text":"Andino permite documentar recursos que publican series de tiempo . Un recurso con series de tiempo es un archivo CSV de determinada estructura .","title":"Series de tiempo"},{"location":"quickstart/#como-documento-una-serie-de-tiempo","text":"En el formulario de carga de un recurso vas a encontrar campos avanzados y especiales que necesit\u00e1s usar para documentar las columnas de una tabla que contiene series de tiempo. Los campos Tipo de dato especial y Detalle de tipo especial te permiten marcar la columna del \u00edndice de tiempo y qu\u00e9 frecuencia tiene. Tipo de dato especial : marcar la columna que tiene las fechas como \"Indice de tiempo\". Detalle de tipo de dato especial : especificar la frecuencia del \u00edndice (anual, diaria, mensual, etc). Los campos Unidad de medida e Identificador te permiten documentar cada una de las columnas, que son tus series de tiempo. Unidad de medida : es la unidad de medida en que est\u00e1 expresada la serie (\"Millones de pesos corrientes\", \"Kil\u00f3metros\", \"Millones de d\u00f3lares americanos\") Identificador : es un identificador \u00fanico de la serie para toda la APN. Debe ser inmutable en el tiempo para la serie, no muy largo (entre 6 y 20 caracteres aproximadamente) y no pisarse potencialmente con otras series de la Administraci\u00f3n P\u00fablica Nacional. Para conocer m\u00e1s sobre series de tiempo mir\u00e1 la documentaci\u00f3n completa en el perfil de metadatos.","title":"\u00bfC\u00f3mo documento una serie de tiempo?"},{"location":"quickstart/#etiquetas","text":"Son las palabras que ayudan a los usuarios a filtrar y encontrar los datasets. Cuanto m\u00e1s amplia y uniforme sea la lista de Etiquetas, mayor es su poder de ayuda.","title":"Etiquetas"},{"location":"quickstart/#donde-las-veo-en-el-portal","text":"En cada dataset espec\u00edfico.","title":"\u00bfD\u00f3nde las veo en el portal?"},{"location":"quickstart/#buenas-practicas-al-crear-etiquetas","text":"Us\u00e1 may\u00fasculas s\u00f3lo donde corresponda. Identific\u00e1 palabras claves. Respet\u00e1 las etiquetas anteriores. Agreg\u00e1 sin\u00f3nimos y us\u00e1 lenguaje natural. Trat\u00e1 de usar una sola palabra, siempre en plural. Si la etiqueta tiene m\u00e1s de una palabra, separalas por un espacio. Por ejemplo: \"declaraciones juradas\". \u00c9stas son algunas preguntas \u00fatiles a la hora de pensar las etiquetas: \u00bfCu\u00e1l es el tema? \u00bfQu\u00e9 aspectos ser\u00e1n de inter\u00e9s para los usuarios? \u00bfDe qu\u00e9 otro modo buscar\u00eda el usuario esta informaci\u00f3n? \u00bfDe qu\u00e9 tipo de informaci\u00f3n se trata? \u00bfQu\u00e9 \u00e1rea la provee?","title":"Buenas pr\u00e1cticas al crear etiquetas"},{"location":"quickstart/#como-las-creo_1","text":"Al igual que con los Temas, cada vez que generes un nuevo dataset, el formulario te pedir\u00e1 que asignes un etiqueta. Record\u00e1 siempre reutilizar las que ya hayas creado y no repetirlas.","title":"\u00bfC\u00f3mo las creo?"},{"location":"quickstart/#personalizar-el-portal","text":"Hacer que tu portal represente tu organizaci\u00f3n es muy f\u00e1cil. Por favor, and\u00e1 a la P\u00e1gina principal > Configuraci\u00f3n . Llegar\u00e1s a la secci\u00f3n que te permite cambiar c\u00f3mo luce la portada de tu cat\u00e1logo de datos y cada secci\u00f3n en particular.","title":"Personalizar el portal"},{"location":"quickstart/#integrar-andino-con-google-analytics","text":"Por favor, escribinos y contanos con qu\u00e9 casilla de e-mail quer\u00e9s tener permisos para ver las m\u00e9tricas de tu Andino.","title":"Integrar Andino con Google Analytics"},{"location":"quickstart/#consultas-sobre-andino","text":"Andino es un portal abierto en constante desarrollo para ser usado por toda la comunidad de datos. Por eso, cuando incorporamos una nueva mejora, cuidamos mucho su compatibilidad con la versi\u00f3n anterior . Como la comunidad de datos es grande, por ahora no podemos dar soporte t\u00e9cnico frente a modificaciones particulares del c\u00f3digo . Sin embargo, pod\u00e9s contactarnos para despejar dudas . Te invitamos a crear issues o enviarnos sugerencias en caso de que encuentren alg\u00fan bug o tengas feedback . Tambi\u00e9n pod\u00e9s mandarnos tu comentario o consulta a datos@modernizacion.gob.ar","title":"Consultas sobre Andino"},{"location":"quickstart/#otros-contenidos-utiles","text":"Gu\u00eda para el uso y la publicaci\u00f3n de metadatos Gu\u00eda para la identificaci\u00f3n y uso de entidades interoperables Gu\u00eda para la publicaci\u00f3n de datos en formatos abiertos","title":"Otros contenidos \u00fatiles"},{"location":"time-series/","text":"Publicar series de tiempo Andino permite documentar archivos CSV como series de tiempo (indicadores con evoluci\u00f3n temporal) para que aparezcan en la API de Series de Tiempo y en el Explorador de Series de Tiempo . Indice 1. Crear una distribuci\u00f3n de series de tiempo Fechas en formato YYYY-MM-DD Fecha m\u00e1s antigua primero a la m\u00e1s reciente al final Fechas continuas Fecha inicial del per\u00edodo Usar \",\" como separador de columnas Usar \".\" como separador decimal No usar separador de miles 2. Documentar la distribuci\u00f3n en Andino A. Crear o editar el dataset que contendr\u00e1 al recurso B. Agregar un nuevo recurso y documentar sus metadatos usuales C. Documentar el \u00edndice de tiempo D. Documentar las series de tiempo 3. Dar aviso a Datos Argentina 4. Activar el explorador de series en tu Andino 1. Crear una distribuci\u00f3n de series de tiempo Una distribuci\u00f3n de series de tiempo es un archivo CSV donde la primer columna contiene las fechas y cada una de las otras columnas es una serie de tiempo. As\u00ed se ve una tabla de series de tiempo en una planilla de c\u00e1lculo como Excel, Libre Office o Google Spreadsheet: indice_tiempo oferta_global_pib oferta_global_importacion demanda_global_exportacion demanda_global_ibif demanda_global_consumo_priv 1993-01-01 236520.0336 22027.59999 16340.95975 45069.41348 31952.717 1994-01-01 250307.886 26682.25975 18840.403 51231.4255 32094.804 1995-01-01 243186.1018 24065.62925 23084.79625 44528.27725 32338.89925 1996-01-01 256626.244 28284.11475 24850.043 48483.8615 33040.55475 1997-01-01 277441.3173 35884.496 27876.14225 57047.5 34104.32325 1998-01-01 288123.3068 38903.79175 30837.53425 60780.6695 35249.1645 1999-01-01 278369.0138 34520.59125 30448.89575 53116.3155 36173.34075 La tabla puede ser generada con un software de planilla de c\u00e1lculo, una rutina programada o incluso a mano con un editor de texto! Pero en cualquier caso ten\u00e9s que guardarla como un archivo CSV: indice_tiempo , oferta_global_pib , oferta_global_importacion , demanda_global_exportacion , demanda_global_ibif , demanda_global_consumo_priv 1993 - 01 - 01 , 236520 . 033577 , 22027 . 5999938 , 16340 . 9597519 , 45069 . 4134803 , 31952 . 717001 1994 - 01 - 01 , 250307 . 886 , 26682 . 25975 , 18840 . 403 , 51231 . 4255 , 32094 . 804 1995 - 01 - 01 , 243186 . 10175 , 24065 . 62925 , 23084 . 79625 , 44528 . 27725 , 32338 . 89925 1996 - 01 - 01 , 256626 . 244 , 28284 . 11475 , 24850 . 043 , 48483 . 8615 , 33040 . 55475 1997 - 01 - 01 , 277441 . 31725 , 35884 . 496 , 27876 . 14225 , 57047 . 5 , 34104 . 32325 1998 - 01 - 01 , 288123 . 30675 , 38903 . 79175 , 30837 . 53425 , 60780 . 6695 , 35249 . 1645 1999 - 01 - 01 , 278369 . 01375 , 34520 . 59125 , 30448 . 89575 , 53116 . 3155 , 36173 . 34075 Es muy importante que el archivo CSV cumpla con estas condiciones: Fechas en formato YYYY-MM-DD El \u00edndice de tiempo debe tener las fechas en formato YYYY-MM-DD . Este es el est\u00e1ndar ISO 8601. Por ejemplo: 12/03/2001 no est\u00e1 soportado, debe escribirse 2001-03-12. Fechas estandarizadas en planillas de c\u00e1lculo Las planillas de c\u00e1lculo suelen leer de distintas maneras las fechas y a veces es dif\u00edcil controlar en qu\u00e9 formato se guardan cuando \"export\u00e1s a CSV\" o \"guard\u00e1s como CSV\". El mejor consejo: seleccion\u00e1 la columna completa que va a ser el \u00edndice de tiempo, asignale un formato de \"Texto\" y escrib\u00ed las fechas despu\u00e9s, como cadenas de texto (as\u00ed evit\u00e1s que la planilla de c\u00e1lculo las lea como fechas). Fecha m\u00e1s antigua primero a la m\u00e1s reciente al final El indice de tiempo debe comenzar por la fecha m\u00e1s antigua y terminar por la m\u00e1s reciente. Menor a mayor, orden ascendente. indice_tiempo_correcto indice_tiempo_incorrecto 1993-01-01 1999-01-01 1994-01-01 1998-01-01 1995-01-01 1997-01-01 1996-01-01 1996-01-01 1997-01-01 1995-01-01 Fechas continuas Al \u00edndice de tiempo no le pueden faltar valores intermedios. Si no hay datos de una serie para determinado per\u00edodo, debe estar la celda en blanco. indice_tiempo_correcto indice_tiempo_incorrecto 1993-01-01 1993-01-01 1994-01-01 1994-01-01 1995-01-01 1997-01-01 1996-01-01 1998-01-01 1997-01-01 1999-01-01 Fecha inicial del per\u00edodo Para representar per\u00edodos m\u00e1s largos que una fecha (el caso de todas las frecuencias de tiempo m\u00e1s bajas que la diaria) debe usarse siempre la fecha completa del comienzo del per\u00edodo . Mensual indice_tiempo_correcto indice_tiempo_incorrecto 1980-01-01 1980-01-31 1980-02-01 1980-02-28 1980-03-01 1980-03-31 Trimestral indice_tiempo_correcto indice_tiempo_incorrecto 1980-01-01 1980-02-01 1980-04-01 1980-05-01 1980-07-01 1980-08-01 1980-10-01 1980-11-01 Semestral indice_tiempo_correcto indice_tiempo_incorrecto indice_tiempo_incorrecto 1980-01-01 1980-01-01 1980-01-31 1980-07-01 1980-08-01 1980-07-31 1981-01-01 1981-01-01 1981-01-31 Usar \",\" como separador de columnas Las columnas del CSV deben estar separadas con \",\". No con \";\", \"|\" ni ning\u00fan otro caracter. Correcto indice_tiempo , oferta_global_pib , oferta_global_importacion , demanda_global_exportacion , demanda_global_ibif , demanda_global_consumo_priv 1993 - 01 - 01 , 236520 . 033577 , 22027 . 5999938 , 16340 . 9597519 , 45069 . 4134803 , 31952 . 717001 1994 - 01 - 01 , 250307 . 886 , 26682 . 25975 , 18840 . 403 , 51231 . 4255 , 32094 . 804 1995 - 01 - 01 , 243186 . 10175 , 24065 . 62925 , 23084 . 79625 , 44528 . 27725 , 32338 . 89925 Incorrecto indice_tiempo ; oferta_global_pib ; oferta_global_importacion ; demanda_global_exportacion ; demanda_global_ibif ; demanda_global_consumo_priv 1993 - 01 - 01 ; 236520 . 033577 ; 22027 . 5999938 ; 16340 . 9597519 ; 45069 . 4134803 ; 31952 . 717001 1994 - 01 - 01 ; 250307 . 886 ; 26682 . 25975 ; 18840 . 403 ; 51231 . 4255 ; 32094 . 804 1995 - 01 - 01 ; 243186 . 10175 ; 24065 . 62925 ; 23084 . 79625 ; 44528 . 27725 ; 32338 . 89925 Usar \".\" como separador decimal Los n\u00fameros decimales deben usar \".\" como separador decimal. No usar \",\". Correcto indice_tiempo , oferta_global_pib , oferta_global_importacion , demanda_global_exportacion , demanda_global_ibif , demanda_global_consumo_priv 1993 - 01 - 01 , 236520 . 033577 , 22027 . 5999938 , 16340 . 9597519 , 45069 . 4134803 , 31952 . 717001 1994 - 01 - 01 , 250307 . 886 , 26682 . 25975 , 18840 . 403 , 51231 . 4255 , 32094 . 804 1995 - 01 - 01 , 243186 . 10175 , 24065 . 62925 , 23084 . 79625 , 44528 . 27725 , 32338 . 89925 Incorrecto indice_tiempo , oferta_global_pib , oferta_global_importacion , demanda_global_exportacion , demanda_global_ibif , demanda_global_consumo_priv 1993 - 01 - 01 , \"236520,033577\" , \"22027,5999938\" , \"16340,9597519\" , \"45069,4134803\" , \"31952,717001\" 1994 - 01 - 01 , \"250307,886\" , \"26682,25975\" , \"18840,403\" , \"51231,4255\" , \"32094,804\" 1995 - 01 - 01 , \"243186,10175\" , \"24065,62925\" , \"23084,79625\" , \"44528,27725\" , \"32338,89925\" No usar separador de miles Los n\u00fameros decimales no deben usar separador de miles. Correcto indice_tiempo , oferta_global_pib , oferta_global_importacion , demanda_global_exportacion , demanda_global_ibif , demanda_global_consumo_priv 1993 - 01 - 01 , 236520 . 033577 , 22027 . 5999938 , 16340 . 9597519 , 45069 . 4134803 , 31952 . 717001 1994 - 01 - 01 , 250307 . 886 , 26682 . 25975 , 18840 . 403 , 51231 . 4255 , 32094 . 804 1995 - 01 - 01 , 243186 . 10175 , 24065 . 62925 , 23084 . 79625 , 44528 . 27725 , 32338 . 89925 Incorrecto indice_tiempo , oferta_global_pib , oferta_global_importacion , demanda_global_exportacion , demanda_global_ibif , demanda_global_consumo_priv 1993 - 01 - 01 , \"236,520.033577\" , \"22,027.5999938\" , \"16,340.9597519\" , \"45,069.4134803\" , \"31,952.717001\" 1994 - 01 - 01 , \"250,307.886\" , \"26,682.25975\" , \"18,840.403\" , \"51,231.4255\" , \"32,094.804\" 1995 - 01 - 01 , \"243,186.10175\" , \"24,065.62925\" , \"23,084.79625\" , \"44,528.27725\" , \"32,338.89925\" Separador de miles al exportar planilla de c\u00e1lculo a CSV Algunas planillas de c\u00e1lculo (como Excel en algunas versiones) exportan a CSV agregando el separador de miles si el usuario eligi\u00f3 un formato de visualizaci\u00f3n de n\u00famero que lo incluye. Para evitarlo, seleccionar las columnas que contienen las series y elegir un formato de visualizaci\u00f3n de n\u00famero sin separador de miles . 2. Documentar la distribuci\u00f3n en Andino Una vez que creaste el CSV, es hora de cargarlo y documentarlo en Andino. A. Crear o editar el dataset que contendr\u00e1 al recurso Si no creaste el Dataset que contendr\u00e1 el nuevo recurso/distribuci\u00f3n de series de tiempo, ten\u00e9s que crear un nuevo Dataset. Si el Dataset ya existe, s\u00f3lo ten\u00e9s que agregar un nuevo recurso. B. Agregar un nuevo recurso y documentar sus metadatos usuales Documentar un recurso de series de tiempo es igual que documentar cualquier otro recurso, hasta que llegues a la secci\u00f3n \" Documentaci\u00f3n de los campos del recurso \". Subir archivo, o copiar URL de descarga Record\u00e1 que pod\u00e9s cargar el archivo directamente en Andino o pod\u00e9s cargarlo en cualquier otro sistema, y cargar la URL de descarga en Andino . Esto puede ser \u00fatil si el CSV se genera autom\u00e1ticamente en otro sistema y se publica en l\u00ednea. Tambi\u00e9n pod\u00e9s cargar el archivo a Andino por API . C. Documentar el \u00edndice de tiempo Una vez que lleg\u00e1s a la secci\u00f3n \" Documentaci\u00f3n de los campos del recurso \", ten\u00e9s que documentar la primer columna del CSV: el \u00edndice de tiempo . T\u00edtulo de la columna : debe ser exactamente el mismo t\u00edtulo que tiene en el CSV. Ej.: indice_tiempo . Tipo de dato : debe ser \"Fecha ISO-8601 (date)\" . Indica a la aplicaci\u00f3n que los valores del campo son fechas estandarizadas. Tipo de dato especial : debe elegirse \"\u00cdndice de tiempo\" en el selector. Indica a la aplicaci\u00f3n que el campo cumple con todas las propiedades de un \u00edndice de tiempo, tal como se explic\u00f3 en la secci\u00f3n anterior. Detalle del tipo de datos especial : debe seleccionarse la frecuencia del \u00edndice de tiempo. D. Documentar las series de tiempo El resto de las columnas a documentar son las series de tiempo. T\u00edtulo de la columna : debe ser exactamente el mismo t\u00edtulo que tiene en el CSV. Ej.: pib_precios_corrientes . No puede superar los 60 caracteres en ning\u00fan caso. Tipo de dato : puede ser \"N\u00famero decimal (number)\" o \"N\u00famero entero (integer)\" . Las series s\u00f3lo pueden tener n\u00fameros enteros o decimales como valores. Descripci\u00f3n de la columna : es el metadato m\u00e1s importante por el cual los usuarios van a buscar esa serie. La descripci\u00f3n no debe dejar lugar a dudas de qu\u00e9 serie se trata y conviene que siga una estructura com\u00fan. Ej.: \"Indice de Precios al Consumidor. Nivel General Nacional. Base diciembre 2016.\" Unidad : es la unidad de medida en que est\u00e1n expresados los valores num\u00e9ricos de la serie. Ej.: \"Millones de pesos de 2004\" , \"Kilogramos\" o \"Millones de USD corrientes\" Identificador : es el c\u00f3digo que identifica un\u00edvocamente a la serie dentro de toda la base de series de tiempo de la Administraci\u00f3n P\u00fablica Nacional. Debe pensarse de forma que no sea muy largo pero no pueda pisarse con otras series: \"ipc\" es un mal c\u00f3digo, mientras que \"ipc_0001\" es mejor. Conviene decidir una estructura o convenci\u00f3n para generar los c\u00f3digos de las series del organismo y ce\u00f1irse a ella. 3. Dar aviso a Datos Argentina Una vez que documentaste un nuevo recurso de series de tiempo, escribinos a datos@modernizacion.gob.ar para que lo federemos en la API y te ayudemos a resolver cualquier problema! A partir de que se federa por primera vez, la API revisar\u00e1 autom\u00e1ticamente 4 veces por d\u00eda el archivo CSV y los metadatos para reflejar cualquier cambio que hagas. 4. Activar el explorador de series en tu Andino Las series federadas en la API tambi\u00e9n se pueden ver en tu Andino, activando el explorador de series. Tildar el casillero \u00bfQuer\u00e9s que esta secci\u00f3n se vea en tu portal? Elegir series destacadas en \u00bfQuer\u00e9s destacar algunas series? escribiendo los identificadores de las series separados por comas \",\". Si sos un organismo de la Administraci\u00f3n P\u00fablica Nacional de Argentina, el campo URI de la API de Series no debe modificarse! Si desplegaste una instancia propia de la aplicaci\u00f3n de la API pod\u00e9s cambiar la URL a donde apunta Andino.","title":"Publicar series de tiempo"},{"location":"time-series/#publicar-series-de-tiempo","text":"Andino permite documentar archivos CSV como series de tiempo (indicadores con evoluci\u00f3n temporal) para que aparezcan en la API de Series de Tiempo y en el Explorador de Series de Tiempo .","title":"Publicar series de tiempo"},{"location":"time-series/#indice","text":"1. Crear una distribuci\u00f3n de series de tiempo Fechas en formato YYYY-MM-DD Fecha m\u00e1s antigua primero a la m\u00e1s reciente al final Fechas continuas Fecha inicial del per\u00edodo Usar \",\" como separador de columnas Usar \".\" como separador decimal No usar separador de miles 2. Documentar la distribuci\u00f3n en Andino A. Crear o editar el dataset que contendr\u00e1 al recurso B. Agregar un nuevo recurso y documentar sus metadatos usuales C. Documentar el \u00edndice de tiempo D. Documentar las series de tiempo 3. Dar aviso a Datos Argentina 4. Activar el explorador de series en tu Andino","title":"Indice"},{"location":"time-series/#1-crear-una-distribucion-de-series-de-tiempo","text":"Una distribuci\u00f3n de series de tiempo es un archivo CSV donde la primer columna contiene las fechas y cada una de las otras columnas es una serie de tiempo. As\u00ed se ve una tabla de series de tiempo en una planilla de c\u00e1lculo como Excel, Libre Office o Google Spreadsheet: indice_tiempo oferta_global_pib oferta_global_importacion demanda_global_exportacion demanda_global_ibif demanda_global_consumo_priv 1993-01-01 236520.0336 22027.59999 16340.95975 45069.41348 31952.717 1994-01-01 250307.886 26682.25975 18840.403 51231.4255 32094.804 1995-01-01 243186.1018 24065.62925 23084.79625 44528.27725 32338.89925 1996-01-01 256626.244 28284.11475 24850.043 48483.8615 33040.55475 1997-01-01 277441.3173 35884.496 27876.14225 57047.5 34104.32325 1998-01-01 288123.3068 38903.79175 30837.53425 60780.6695 35249.1645 1999-01-01 278369.0138 34520.59125 30448.89575 53116.3155 36173.34075 La tabla puede ser generada con un software de planilla de c\u00e1lculo, una rutina programada o incluso a mano con un editor de texto! Pero en cualquier caso ten\u00e9s que guardarla como un archivo CSV: indice_tiempo , oferta_global_pib , oferta_global_importacion , demanda_global_exportacion , demanda_global_ibif , demanda_global_consumo_priv 1993 - 01 - 01 , 236520 . 033577 , 22027 . 5999938 , 16340 . 9597519 , 45069 . 4134803 , 31952 . 717001 1994 - 01 - 01 , 250307 . 886 , 26682 . 25975 , 18840 . 403 , 51231 . 4255 , 32094 . 804 1995 - 01 - 01 , 243186 . 10175 , 24065 . 62925 , 23084 . 79625 , 44528 . 27725 , 32338 . 89925 1996 - 01 - 01 , 256626 . 244 , 28284 . 11475 , 24850 . 043 , 48483 . 8615 , 33040 . 55475 1997 - 01 - 01 , 277441 . 31725 , 35884 . 496 , 27876 . 14225 , 57047 . 5 , 34104 . 32325 1998 - 01 - 01 , 288123 . 30675 , 38903 . 79175 , 30837 . 53425 , 60780 . 6695 , 35249 . 1645 1999 - 01 - 01 , 278369 . 01375 , 34520 . 59125 , 30448 . 89575 , 53116 . 3155 , 36173 . 34075 Es muy importante que el archivo CSV cumpla con estas condiciones:","title":"1. Crear una distribuci\u00f3n de series de tiempo"},{"location":"time-series/#fechas-en-formato-yyyy-mm-dd","text":"El \u00edndice de tiempo debe tener las fechas en formato YYYY-MM-DD . Este es el est\u00e1ndar ISO 8601. Por ejemplo: 12/03/2001 no est\u00e1 soportado, debe escribirse 2001-03-12. Fechas estandarizadas en planillas de c\u00e1lculo Las planillas de c\u00e1lculo suelen leer de distintas maneras las fechas y a veces es dif\u00edcil controlar en qu\u00e9 formato se guardan cuando \"export\u00e1s a CSV\" o \"guard\u00e1s como CSV\". El mejor consejo: seleccion\u00e1 la columna completa que va a ser el \u00edndice de tiempo, asignale un formato de \"Texto\" y escrib\u00ed las fechas despu\u00e9s, como cadenas de texto (as\u00ed evit\u00e1s que la planilla de c\u00e1lculo las lea como fechas).","title":"Fechas en formato  YYYY-MM-DD"},{"location":"time-series/#fecha-mas-antigua-primero-a-la-mas-reciente-al-final","text":"El indice de tiempo debe comenzar por la fecha m\u00e1s antigua y terminar por la m\u00e1s reciente. Menor a mayor, orden ascendente. indice_tiempo_correcto indice_tiempo_incorrecto 1993-01-01 1999-01-01 1994-01-01 1998-01-01 1995-01-01 1997-01-01 1996-01-01 1996-01-01 1997-01-01 1995-01-01","title":"Fecha m\u00e1s antigua primero a la m\u00e1s reciente al final"},{"location":"time-series/#fechas-continuas","text":"Al \u00edndice de tiempo no le pueden faltar valores intermedios. Si no hay datos de una serie para determinado per\u00edodo, debe estar la celda en blanco. indice_tiempo_correcto indice_tiempo_incorrecto 1993-01-01 1993-01-01 1994-01-01 1994-01-01 1995-01-01 1997-01-01 1996-01-01 1998-01-01 1997-01-01 1999-01-01","title":"Fechas continuas"},{"location":"time-series/#fecha-inicial-del-periodo","text":"Para representar per\u00edodos m\u00e1s largos que una fecha (el caso de todas las frecuencias de tiempo m\u00e1s bajas que la diaria) debe usarse siempre la fecha completa del comienzo del per\u00edodo . Mensual indice_tiempo_correcto indice_tiempo_incorrecto 1980-01-01 1980-01-31 1980-02-01 1980-02-28 1980-03-01 1980-03-31 Trimestral indice_tiempo_correcto indice_tiempo_incorrecto 1980-01-01 1980-02-01 1980-04-01 1980-05-01 1980-07-01 1980-08-01 1980-10-01 1980-11-01 Semestral indice_tiempo_correcto indice_tiempo_incorrecto indice_tiempo_incorrecto 1980-01-01 1980-01-01 1980-01-31 1980-07-01 1980-08-01 1980-07-31 1981-01-01 1981-01-01 1981-01-31","title":"Fecha inicial del per\u00edodo"},{"location":"time-series/#usar-como-separador-de-columnas","text":"Las columnas del CSV deben estar separadas con \",\". No con \";\", \"|\" ni ning\u00fan otro caracter. Correcto indice_tiempo , oferta_global_pib , oferta_global_importacion , demanda_global_exportacion , demanda_global_ibif , demanda_global_consumo_priv 1993 - 01 - 01 , 236520 . 033577 , 22027 . 5999938 , 16340 . 9597519 , 45069 . 4134803 , 31952 . 717001 1994 - 01 - 01 , 250307 . 886 , 26682 . 25975 , 18840 . 403 , 51231 . 4255 , 32094 . 804 1995 - 01 - 01 , 243186 . 10175 , 24065 . 62925 , 23084 . 79625 , 44528 . 27725 , 32338 . 89925 Incorrecto indice_tiempo ; oferta_global_pib ; oferta_global_importacion ; demanda_global_exportacion ; demanda_global_ibif ; demanda_global_consumo_priv 1993 - 01 - 01 ; 236520 . 033577 ; 22027 . 5999938 ; 16340 . 9597519 ; 45069 . 4134803 ; 31952 . 717001 1994 - 01 - 01 ; 250307 . 886 ; 26682 . 25975 ; 18840 . 403 ; 51231 . 4255 ; 32094 . 804 1995 - 01 - 01 ; 243186 . 10175 ; 24065 . 62925 ; 23084 . 79625 ; 44528 . 27725 ; 32338 . 89925","title":"Usar \",\" como separador de columnas"},{"location":"time-series/#usar-como-separador-decimal","text":"Los n\u00fameros decimales deben usar \".\" como separador decimal. No usar \",\". Correcto indice_tiempo , oferta_global_pib , oferta_global_importacion , demanda_global_exportacion , demanda_global_ibif , demanda_global_consumo_priv 1993 - 01 - 01 , 236520 . 033577 , 22027 . 5999938 , 16340 . 9597519 , 45069 . 4134803 , 31952 . 717001 1994 - 01 - 01 , 250307 . 886 , 26682 . 25975 , 18840 . 403 , 51231 . 4255 , 32094 . 804 1995 - 01 - 01 , 243186 . 10175 , 24065 . 62925 , 23084 . 79625 , 44528 . 27725 , 32338 . 89925 Incorrecto indice_tiempo , oferta_global_pib , oferta_global_importacion , demanda_global_exportacion , demanda_global_ibif , demanda_global_consumo_priv 1993 - 01 - 01 , \"236520,033577\" , \"22027,5999938\" , \"16340,9597519\" , \"45069,4134803\" , \"31952,717001\" 1994 - 01 - 01 , \"250307,886\" , \"26682,25975\" , \"18840,403\" , \"51231,4255\" , \"32094,804\" 1995 - 01 - 01 , \"243186,10175\" , \"24065,62925\" , \"23084,79625\" , \"44528,27725\" , \"32338,89925\"","title":"Usar \".\" como separador decimal"},{"location":"time-series/#no-usar-separador-de-miles","text":"Los n\u00fameros decimales no deben usar separador de miles. Correcto indice_tiempo , oferta_global_pib , oferta_global_importacion , demanda_global_exportacion , demanda_global_ibif , demanda_global_consumo_priv 1993 - 01 - 01 , 236520 . 033577 , 22027 . 5999938 , 16340 . 9597519 , 45069 . 4134803 , 31952 . 717001 1994 - 01 - 01 , 250307 . 886 , 26682 . 25975 , 18840 . 403 , 51231 . 4255 , 32094 . 804 1995 - 01 - 01 , 243186 . 10175 , 24065 . 62925 , 23084 . 79625 , 44528 . 27725 , 32338 . 89925 Incorrecto indice_tiempo , oferta_global_pib , oferta_global_importacion , demanda_global_exportacion , demanda_global_ibif , demanda_global_consumo_priv 1993 - 01 - 01 , \"236,520.033577\" , \"22,027.5999938\" , \"16,340.9597519\" , \"45,069.4134803\" , \"31,952.717001\" 1994 - 01 - 01 , \"250,307.886\" , \"26,682.25975\" , \"18,840.403\" , \"51,231.4255\" , \"32,094.804\" 1995 - 01 - 01 , \"243,186.10175\" , \"24,065.62925\" , \"23,084.79625\" , \"44,528.27725\" , \"32,338.89925\" Separador de miles al exportar planilla de c\u00e1lculo a CSV Algunas planillas de c\u00e1lculo (como Excel en algunas versiones) exportan a CSV agregando el separador de miles si el usuario eligi\u00f3 un formato de visualizaci\u00f3n de n\u00famero que lo incluye. Para evitarlo, seleccionar las columnas que contienen las series y elegir un formato de visualizaci\u00f3n de n\u00famero sin separador de miles .","title":"No usar separador de miles"},{"location":"time-series/#2-documentar-la-distribucion-en-andino","text":"Una vez que creaste el CSV, es hora de cargarlo y documentarlo en Andino.","title":"2. Documentar la distribuci\u00f3n en Andino"},{"location":"time-series/#a-crear-o-editar-el-dataset-que-contendra-al-recurso","text":"Si no creaste el Dataset que contendr\u00e1 el nuevo recurso/distribuci\u00f3n de series de tiempo, ten\u00e9s que crear un nuevo Dataset. Si el Dataset ya existe, s\u00f3lo ten\u00e9s que agregar un nuevo recurso.","title":"A. Crear o editar el dataset que contendr\u00e1 al recurso"},{"location":"time-series/#b-agregar-un-nuevo-recurso-y-documentar-sus-metadatos-usuales","text":"Documentar un recurso de series de tiempo es igual que documentar cualquier otro recurso, hasta que llegues a la secci\u00f3n \" Documentaci\u00f3n de los campos del recurso \". Subir archivo, o copiar URL de descarga Record\u00e1 que pod\u00e9s cargar el archivo directamente en Andino o pod\u00e9s cargarlo en cualquier otro sistema, y cargar la URL de descarga en Andino . Esto puede ser \u00fatil si el CSV se genera autom\u00e1ticamente en otro sistema y se publica en l\u00ednea. Tambi\u00e9n pod\u00e9s cargar el archivo a Andino por API .","title":"B. Agregar un nuevo recurso y documentar sus metadatos usuales"},{"location":"time-series/#c-documentar-el-indice-de-tiempo","text":"Una vez que lleg\u00e1s a la secci\u00f3n \" Documentaci\u00f3n de los campos del recurso \", ten\u00e9s que documentar la primer columna del CSV: el \u00edndice de tiempo . T\u00edtulo de la columna : debe ser exactamente el mismo t\u00edtulo que tiene en el CSV. Ej.: indice_tiempo . Tipo de dato : debe ser \"Fecha ISO-8601 (date)\" . Indica a la aplicaci\u00f3n que los valores del campo son fechas estandarizadas. Tipo de dato especial : debe elegirse \"\u00cdndice de tiempo\" en el selector. Indica a la aplicaci\u00f3n que el campo cumple con todas las propiedades de un \u00edndice de tiempo, tal como se explic\u00f3 en la secci\u00f3n anterior. Detalle del tipo de datos especial : debe seleccionarse la frecuencia del \u00edndice de tiempo.","title":"C. Documentar el \u00edndice de tiempo"},{"location":"time-series/#d-documentar-las-series-de-tiempo","text":"El resto de las columnas a documentar son las series de tiempo. T\u00edtulo de la columna : debe ser exactamente el mismo t\u00edtulo que tiene en el CSV. Ej.: pib_precios_corrientes . No puede superar los 60 caracteres en ning\u00fan caso. Tipo de dato : puede ser \"N\u00famero decimal (number)\" o \"N\u00famero entero (integer)\" . Las series s\u00f3lo pueden tener n\u00fameros enteros o decimales como valores. Descripci\u00f3n de la columna : es el metadato m\u00e1s importante por el cual los usuarios van a buscar esa serie. La descripci\u00f3n no debe dejar lugar a dudas de qu\u00e9 serie se trata y conviene que siga una estructura com\u00fan. Ej.: \"Indice de Precios al Consumidor. Nivel General Nacional. Base diciembre 2016.\" Unidad : es la unidad de medida en que est\u00e1n expresados los valores num\u00e9ricos de la serie. Ej.: \"Millones de pesos de 2004\" , \"Kilogramos\" o \"Millones de USD corrientes\" Identificador : es el c\u00f3digo que identifica un\u00edvocamente a la serie dentro de toda la base de series de tiempo de la Administraci\u00f3n P\u00fablica Nacional. Debe pensarse de forma que no sea muy largo pero no pueda pisarse con otras series: \"ipc\" es un mal c\u00f3digo, mientras que \"ipc_0001\" es mejor. Conviene decidir una estructura o convenci\u00f3n para generar los c\u00f3digos de las series del organismo y ce\u00f1irse a ella.","title":"D. Documentar las series de tiempo"},{"location":"time-series/#3-dar-aviso-a-datos-argentina","text":"Una vez que documentaste un nuevo recurso de series de tiempo, escribinos a datos@modernizacion.gob.ar para que lo federemos en la API y te ayudemos a resolver cualquier problema! A partir de que se federa por primera vez, la API revisar\u00e1 autom\u00e1ticamente 4 veces por d\u00eda el archivo CSV y los metadatos para reflejar cualquier cambio que hagas.","title":"3. Dar aviso a Datos Argentina"},{"location":"time-series/#4-activar-el-explorador-de-series-en-tu-andino","text":"Las series federadas en la API tambi\u00e9n se pueden ver en tu Andino, activando el explorador de series. Tildar el casillero \u00bfQuer\u00e9s que esta secci\u00f3n se vea en tu portal? Elegir series destacadas en \u00bfQuer\u00e9s destacar algunas series? escribiendo los identificadores de las series separados por comas \",\". Si sos un organismo de la Administraci\u00f3n P\u00fablica Nacional de Argentina, el campo URI de la API de Series no debe modificarse! Si desplegaste una instancia propia de la aplicaci\u00f3n de la API pod\u00e9s cambiar la URL a donde apunta Andino.","title":"4. Activar el explorador de series en tu Andino"},{"location":"usage/","text":"","title":"Usage"},{"location":"developers/checklist/","text":"Checklist para la puesta en producci\u00f3n Si est\u00e1s por configurar tu instancia de Andino para un ambiente productivo, tenemos algunas recomendaciones para que sigas y verifiques si tu instancia est\u00e1 bien configurada. Indice Verific\u00e1 que tu instancia de Andino tenga un nombre de dominio \u00fanico y bien configurado Verificar si mi Andino tiene el nombre de dominio configurado correctamente Actualizando el nombre de dominio asignado a Andino Verific\u00e1 que el contenedor portal pueda resolver el nombre de dominio asignado a la instancia Seguir las recomendaciones de seguridad Verific\u00e1 que tu instancia de Andino tenga un nombre de dominio \u00fanico y bien configurado Para el correcto funcionamiento de tu instancia de Andino, es recomendable que la misma tenga un \u00fanico nombre de dominio asignado. Una vez que tengas definido el nombre de dominio (ej: datos.ministerio.gob.ar ) y el mismo se resuelva a la IP p\u00fablica asignado al host de tu Andino (o al load balancer / frontend server que opcionalmente tengas) es importante que tu instancia de Andino conozca ese nombre de dominio y que est\u00e9 configurado para responder al mismo. Verificar si mi Andino tiene el nombre de dominio configurado correctamente Para saber si tu instancia de Andino tiene el nombre de dominio correctamente configurado segu\u00ed los siguientes pasos, ejecutando el comando en el directorio de instalaci\u00f3n de Andino (ej: /etc/portal ): docker - compose - f latest . yml exec portal grep ckan \\. site_url / etc / ckan / default / production . ini Si tu sitio est\u00e1 bien configurado, el valor del par\u00e1metro de configuraci\u00f3n ckan.site_url deber\u00e1 coincidir con el nombre de dominio de tu Andino (incluyendo el schema , http o https ): ckan . site_url = http : // datos . ministerio . gob . ar / Si \u00e9ste no coincide, deber\u00e1s modificar el valor del par\u00e1metro en la configuraci\u00f3n de tu Andino. Actualizando el nombre de dominio asignado a Andino Para actualizar el nombre de dominio que tiene tu andino (por ejemplo datos.ministerio.gob.ar ) deb\u00e9s ejecutar el siguiente comando: docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" ckan.site_url=http://datos.ministerio.gob.ar/ \" ; Verific\u00e1 que el contenedor portal pueda resolver el nombre de dominio asignado a la instancia Para asegurar el correcto funcionamiento de algunos componentes de la arquitectura de Andino, es necesario que desde dentro de los contenedores Docker que forman parte de la soluci\u00f3n, el nombre de dominio asignado a tu Andino pueda ser resuelto correctamente. La verificaci\u00f3n de tal condici\u00f3n est\u00e1 documentada en la secci\u00f3n DNS . Seguir las recomendaciones de seguridad La presente documentaci\u00f3n contiene un apartado acerca de recomendaciones de seguridad. Por favor leelas y segu\u00ed las recomendaciones .","title":"Recomendaciones para salir a producci\u00f3n"},{"location":"developers/checklist/#checklist-para-la-puesta-en-produccion","text":"Si est\u00e1s por configurar tu instancia de Andino para un ambiente productivo, tenemos algunas recomendaciones para que sigas y verifiques si tu instancia est\u00e1 bien configurada.","title":"Checklist para la puesta en producci\u00f3n"},{"location":"developers/checklist/#indice","text":"Verific\u00e1 que tu instancia de Andino tenga un nombre de dominio \u00fanico y bien configurado Verificar si mi Andino tiene el nombre de dominio configurado correctamente Actualizando el nombre de dominio asignado a Andino Verific\u00e1 que el contenedor portal pueda resolver el nombre de dominio asignado a la instancia Seguir las recomendaciones de seguridad","title":"Indice"},{"location":"developers/checklist/#verifica-que-tu-instancia-de-andino-tenga-un-nombre-de-dominio-unico-y-bien-configurado","text":"Para el correcto funcionamiento de tu instancia de Andino, es recomendable que la misma tenga un \u00fanico nombre de dominio asignado. Una vez que tengas definido el nombre de dominio (ej: datos.ministerio.gob.ar ) y el mismo se resuelva a la IP p\u00fablica asignado al host de tu Andino (o al load balancer / frontend server que opcionalmente tengas) es importante que tu instancia de Andino conozca ese nombre de dominio y que est\u00e9 configurado para responder al mismo.","title":"Verific\u00e1 que tu instancia de Andino tenga un nombre de dominio \u00fanico y bien configurado"},{"location":"developers/checklist/#verificar-si-mi-andino-tiene-el-nombre-de-dominio-configurado-correctamente","text":"Para saber si tu instancia de Andino tiene el nombre de dominio correctamente configurado segu\u00ed los siguientes pasos, ejecutando el comando en el directorio de instalaci\u00f3n de Andino (ej: /etc/portal ): docker - compose - f latest . yml exec portal grep ckan \\. site_url / etc / ckan / default / production . ini Si tu sitio est\u00e1 bien configurado, el valor del par\u00e1metro de configuraci\u00f3n ckan.site_url deber\u00e1 coincidir con el nombre de dominio de tu Andino (incluyendo el schema , http o https ): ckan . site_url = http : // datos . ministerio . gob . ar / Si \u00e9ste no coincide, deber\u00e1s modificar el valor del par\u00e1metro en la configuraci\u00f3n de tu Andino.","title":"Verificar si mi Andino tiene el nombre de dominio configurado correctamente"},{"location":"developers/checklist/#actualizando-el-nombre-de-dominio-asignado-a-andino","text":"Para actualizar el nombre de dominio que tiene tu andino (por ejemplo datos.ministerio.gob.ar ) deb\u00e9s ejecutar el siguiente comando: docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" ckan.site_url=http://datos.ministerio.gob.ar/ \" ;","title":"Actualizando el nombre de dominio asignado a Andino"},{"location":"developers/checklist/#verifica-que-el-contenedor-portal-pueda-resolver-el-nombre-de-dominio-asignado-a-la-instancia","text":"Para asegurar el correcto funcionamiento de algunos componentes de la arquitectura de Andino, es necesario que desde dentro de los contenedores Docker que forman parte de la soluci\u00f3n, el nombre de dominio asignado a tu Andino pueda ser resuelto correctamente. La verificaci\u00f3n de tal condici\u00f3n est\u00e1 documentada en la secci\u00f3n DNS .","title":"Verific\u00e1 que el contenedor portal pueda resolver el nombre de dominio asignado a la instancia"},{"location":"developers/checklist/#seguir-las-recomendaciones-de-seguridad","text":"La presente documentaci\u00f3n contiene un apartado acerca de recomendaciones de seguridad. Por favor leelas y segu\u00ed las recomendaciones .","title":"Seguir las recomendaciones de seguridad"},{"location":"developers/development/","text":"Desarrollo Indice Instalar un nuevo requerimiento en la imagen base Instalar nuevo requerimiento Configuraci\u00f3n Configuraci\u00f3n propia Inicio autom\u00e1tico Generaci\u00f3n del nuevo contenedor Probar modificaciones y nuevas funcionalidades Instalando Andino Actualizando Andino Utilizar una imagen custom de portal-base o portal-base-nginx Debugear Andino Instalar un nuevo requerimiento en la imagen base Si necesitamos instalar y configurar un nuevo requerimiento para andino, lo recomendable es instalarlo en la imagen de datosgobar/portal-base. Esto permitir\u00e1 mantener el build de datosgobar/portal-andino m\u00e1s peque\u00f1o y r\u00e1pido. Para ejemplificar esto, supondremos que queremos levantar los workers de RQ usando supervisor. Esta implementaci\u00f3n, presente en ckan 2.7 , require levantar supervisor con una configuraci\u00f3n especial para levantar los workers. Instalar nuevo requerimiento Para instalar supervisor en el portal base, podemos hacer uso de la tarea de ansible encargada de instalar los requerimientos para la aplicaci\u00f3n. A la fecha, este c\u00f3digo se encuentra en dependencies.yml La parte que instala los requerimientos quedar\u00eda as\u00ed: - name : Install dependencies apt : name : \"{{ item }}\" state : present with_items : - libevent-dev # Otras dependencias - gettext - supervisor Al agregar supervisor , \u00e9ste ser\u00e1 instalado cuando la generaci\u00f3n de la imagen termine. Ahora, lo siguiente s\u00f3lo ser\u00eda agregar la configuraci\u00f3n para levantar las colas de rq, con la configuraci\u00f3n que trae ckan. Configuraci\u00f3n El mejor punto para agregar esta configuraci\u00f3n es en el archivo configure.yml . El mismo es utilizado despu\u00e9s de que ckan es instalado, por lo que el archivo de configuraci\u00f3n ya est\u00e1 presente en el sistema. Para eso, a\u00f1adiremos una tarea m\u00e1s de ansible, usaremos el m\u00f3dulo copy . Al final de configure.yml , agregaremos algo como: # Otras tareas - name : Copy supervisor configuration copy : src : /usr/lib/ckan/default/src/ckan/ckan/config/supervisor-ckan-worker.conf dest : /etc/supervisor/conf.d/ remote_src : yes Configuraci\u00f3n propia Algo que podr\u00edamos desear es tener nuestra propia configuraci\u00f3n de supervisor, que se basa en la que nos provee ckan. Para esto, copiamos el archivo supervisor-ckan-worker.conf desde dentro del contenedor y lo colocamos al lado de production.ini.j2 , dentro del directorio templates/ckan . Luego, cambiamos la tarea de ansible para que copie nuestro archivo: # Otras tareas - name : Copy supervisor configuration copy : src : ckan/supervisor-ckan-worker.conf dest : /etc/supervisor/conf.d/ Inicio autom\u00e1tico Para lograr que supervisor se inicie autom\u00e1tiamente cada vez que se levante el portal, debemos correr service supervisor restart mientras esta se levanta, en \"runtime\". El mejor lugar para esto es el script que se corre por defecto: start_ckan.sh.j2 . En este script, agregamos los comandos que queremos antes de que la aplicaci\u00f3n sea iniciada: # otros comandos ... echo \" Iniciando Supervisor \" service supervisor restart service apache2 stop exec {{ CKAN_INIT }} / run_andino . sh Generaci\u00f3n del nuevo contenedor Ahora, para probar estos cambios, generamos una nueva imagen de datosgobar/portal-base : base_image = \"datosgobar/portal-base:test\" cd portal - base / ; docker build base_portal - t \"$base_image\" ; Esto generar\u00e1 una imagen con el tag (o nombre) \"datosgobar/portal-base:test\". Para hacer una prueba r\u00e1pida, podemos correr: docker run --rm -it datosgobar/portal-base:test supervisord -n Este comando iniciar\u00e1 un contenedor con supervisor corriendo. Deber\u00edamos ver en consola los siguiente mensajes (podemos salir del contenedor usando Ctrl+c ): 2018 - 06 - 22 18 : 55 : 46 , 593 CRIT Supervisor running as root ( no user in config file ) 2018 - 06 - 22 18 : 55 : 46 , 593 WARN Included extra file \"/etc/supervisor/conf.d/supervisor-ckan-worker.conf\" during parsing 2018 - 06 - 22 18 : 55 : 46 , 615 INFO RPC interface 'supervisor' initialized Para probar esto directamente en el contenedor de portl-andino , debemos generar una nueva imagen del contenedor en base a la imagen del portal base . Para esto, en el archivo Dockerfile del portal, cambiamos el FROM , utilizando la imagen temporal que acabamos de crear: FROM datosgobar / portal - base : test # ... otros comandos Ahora, generamos la nueva imagen: cd portal - andino / docker build - t portal - andino : test . Luego, iniciamos la aplicaci\u00f3n en modo desarrollo: cd portal - andino / . / dev . sh setup ; Una vez iniciada la aplicaci\u00f3n, entramos al contenedor y verificamos que supervisor est\u00e9 corriendo: cd portal - andino / . / dev . sh console # Una vez en el contenedor supervisorctl En este momento, deber\u00edamos ver el estado de supervisor. Para salir, usamos Ctrl + C . Si comprobamos que el nuevo requerimiento est\u00e1 instalado y configurado, volvemos el Dockerfile a su estado anterior (deshaciendo el cambio en el FROM ). Luego, debemos sacar una nueva imagen del portal-base y, finalmente, una nueva de portal-andino que se base en la anterior. Probar modificaciones y nuevas funcionalidades Para una mayor facilidad a la hora de desarrollar existe un archivo dev.sh , el cual contiene los siguientes comandos: install Instalar una instancia de Andino usando configuraciones espec\u00edficas ( usar '-h' para ver cu\u00e1les existen y para qu\u00e9 sirven ) update Actualizar una instancia de Andino usando configuraciones espec\u00edficas ( idem install ) exec Ejecutar el comando especificado en el contenedor de Andino logs Mostrar y seguir log del contenedor especificado ( default: Andino ) serve Usar un servidor de paster para debuguear f\u00e1cilmente la aplicaci\u00f3n en el puerto 5000 up Levantar los servicios stop Parar los servicios down Borrar los contenedores, sus vol\u00famenes, y el directorio de instalaci\u00f3n Instalando Andino Se utilizar\u00e1 el archivo dev.sh de portal-andino ejecutando la funci\u00f3n install , la cual permite levantar una instancia en base a los par\u00e1metros recibidos. Dicha funci\u00f3n puede ser usada para testear cambios en portal-andino, portal-andino-theme, y/o portal-base. Los par\u00e1metros a utilizar son: -h | --help mostrar ayuda -a | --andino_branch VALUE nombre del branch de portal-andino ( default: master ) -t | --theme_branch VALUE nombre del branch de portal-andino-theme ( default: master o el ya utilizado ) -b | --base_branch VALUE nombre del branch de portal-base --site_host VALUE nombre de dominio del portal ( default: localhost ) --nginx_host_port VALUE puerto a usar para HTTP --nginx_ssl activar la configuraci\u00f3n de SSL --nginx_ssl_port VALUE puerto a usar para HTTPS --ssl_key_path VALUE path a la clave privada del certificado SSL --ssl_crt_path VALUE path al certificado SSL --nginx-extended-cache activar la configuraci\u00f3n de cach\u00e9 extendida de Nginx --file_size_limit VALUE tamanio m\u00e1ximo en MB para archivos de recursos ( default: 300 , m\u00e1ximo recomendado: 1024 ) --theme_volume_src VALUE path del host donde se encuentra clonado portal-andino-theme para crear un volumen ( default: /dev/null para no usar un theme ) Todos los par\u00e1metros son opcionales. Para portal-andino y portal-andino-theme, el branch a utilizar, por default, ser\u00e1 master en ambos casos. Para portal-base, se defaultear\u00e1 a la versi\u00f3n que figure en el Dockerfile de portal-andino. Nota: Si se utiliza el nombre 'localhost' para la variable site_host , es posible que ocurra un error al intentar subir un archivo perteneciente a un recurso al Datastore: Error: Proceso completo pero no se pudo enviar a result_url. Para evitar este problema, se puede utilizar un hostname local diferente; seguir los siguientes pasos para utilizar uno nuevo: * Ejecutar vi /etc/hosts en el host * Puede existir la l\u00ednea 127.0.0.1 localhost , y tambi\u00e9n otras parecidas; hay que escribir una nueva (es necesario asegurarse de que la IP y el hostname de la que queremos escribir sean distintos a todos los anteriores). * Escribir una l\u00ednea nueva 127.0.X.1 nuevo_hostname , reemplazando la 'X' por alg\u00fan n\u00famero que no est\u00e9 en una de las IPs de arriba, y 'nuevo_hostname' por el que se quiera utilizar_ Actualizando Andino Para el mismo archivo, tambi\u00e9n existe una funci\u00f3n update , cuyo objetivo es actualizar una instancia ya levantada. Los par\u00e1metros que recibe son exactamente los mismos que para la funci\u00f3n de instalaci\u00f3n. Nota: si se desea mantener la configuraci\u00f3n de SSL y/o de la cach\u00e9 extendida, es necesario especificarlo utilizando los par\u00e1metros correspondientes. No ocurre lo mismo para los archivos del certificado, puesto que son persistidos al instalar Andino. Utilizar una imagen custom de portal-base o portal-base-nginx Si se quiere utilizar una imagen local en lugar de las existentes en https://hub.docker.com/r/datosgobar/portal-base, se debe correr este comando en el directorio donde se encuentra portal-base: docker build base_portal -t datosgobar/portal-base:{nombre que se le quiera dar a la imagen} Lo mismo aplica para Nginx: recordar que su Dockerfile est\u00e1 en nginx/ , por lo que el comando se debe correr ah\u00ed. Debugear Andino Para una instancia de Andino, se puede utilizar el comando ./dev.sh serve , el cual utiliza un servidor de paster que nos permite debuguear f\u00e1cilmente, ya que apache no lo permite. Durante la ejecuci\u00f3n de este comando, la aplicaci\u00f3n estar\u00e1 utilizando el puerto 5000 .","title":"Desarrollo"},{"location":"developers/development/#desarrollo","text":"","title":"Desarrollo"},{"location":"developers/development/#indice","text":"Instalar un nuevo requerimiento en la imagen base Instalar nuevo requerimiento Configuraci\u00f3n Configuraci\u00f3n propia Inicio autom\u00e1tico Generaci\u00f3n del nuevo contenedor Probar modificaciones y nuevas funcionalidades Instalando Andino Actualizando Andino Utilizar una imagen custom de portal-base o portal-base-nginx Debugear Andino","title":"Indice"},{"location":"developers/development/#instalar-un-nuevo-requerimiento-en-la-imagen-base","text":"Si necesitamos instalar y configurar un nuevo requerimiento para andino, lo recomendable es instalarlo en la imagen de datosgobar/portal-base. Esto permitir\u00e1 mantener el build de datosgobar/portal-andino m\u00e1s peque\u00f1o y r\u00e1pido. Para ejemplificar esto, supondremos que queremos levantar los workers de RQ usando supervisor. Esta implementaci\u00f3n, presente en ckan 2.7 , require levantar supervisor con una configuraci\u00f3n especial para levantar los workers.","title":"Instalar un nuevo requerimiento en la imagen base"},{"location":"developers/development/#instalar-nuevo-requerimiento","text":"Para instalar supervisor en el portal base, podemos hacer uso de la tarea de ansible encargada de instalar los requerimientos para la aplicaci\u00f3n. A la fecha, este c\u00f3digo se encuentra en dependencies.yml La parte que instala los requerimientos quedar\u00eda as\u00ed: - name : Install dependencies apt : name : \"{{ item }}\" state : present with_items : - libevent-dev # Otras dependencias - gettext - supervisor Al agregar supervisor , \u00e9ste ser\u00e1 instalado cuando la generaci\u00f3n de la imagen termine. Ahora, lo siguiente s\u00f3lo ser\u00eda agregar la configuraci\u00f3n para levantar las colas de rq, con la configuraci\u00f3n que trae ckan.","title":"Instalar nuevo requerimiento"},{"location":"developers/development/#configuracion","text":"El mejor punto para agregar esta configuraci\u00f3n es en el archivo configure.yml . El mismo es utilizado despu\u00e9s de que ckan es instalado, por lo que el archivo de configuraci\u00f3n ya est\u00e1 presente en el sistema. Para eso, a\u00f1adiremos una tarea m\u00e1s de ansible, usaremos el m\u00f3dulo copy . Al final de configure.yml , agregaremos algo como: # Otras tareas - name : Copy supervisor configuration copy : src : /usr/lib/ckan/default/src/ckan/ckan/config/supervisor-ckan-worker.conf dest : /etc/supervisor/conf.d/ remote_src : yes","title":"Configuraci\u00f3n"},{"location":"developers/development/#configuracion-propia","text":"Algo que podr\u00edamos desear es tener nuestra propia configuraci\u00f3n de supervisor, que se basa en la que nos provee ckan. Para esto, copiamos el archivo supervisor-ckan-worker.conf desde dentro del contenedor y lo colocamos al lado de production.ini.j2 , dentro del directorio templates/ckan . Luego, cambiamos la tarea de ansible para que copie nuestro archivo: # Otras tareas - name : Copy supervisor configuration copy : src : ckan/supervisor-ckan-worker.conf dest : /etc/supervisor/conf.d/","title":"Configuraci\u00f3n propia"},{"location":"developers/development/#inicio-automatico","text":"Para lograr que supervisor se inicie autom\u00e1tiamente cada vez que se levante el portal, debemos correr service supervisor restart mientras esta se levanta, en \"runtime\". El mejor lugar para esto es el script que se corre por defecto: start_ckan.sh.j2 . En este script, agregamos los comandos que queremos antes de que la aplicaci\u00f3n sea iniciada: # otros comandos ... echo \" Iniciando Supervisor \" service supervisor restart service apache2 stop exec {{ CKAN_INIT }} / run_andino . sh","title":"Inicio autom\u00e1tico"},{"location":"developers/development/#generacion-del-nuevo-contenedor","text":"Ahora, para probar estos cambios, generamos una nueva imagen de datosgobar/portal-base : base_image = \"datosgobar/portal-base:test\" cd portal - base / ; docker build base_portal - t \"$base_image\" ; Esto generar\u00e1 una imagen con el tag (o nombre) \"datosgobar/portal-base:test\". Para hacer una prueba r\u00e1pida, podemos correr: docker run --rm -it datosgobar/portal-base:test supervisord -n Este comando iniciar\u00e1 un contenedor con supervisor corriendo. Deber\u00edamos ver en consola los siguiente mensajes (podemos salir del contenedor usando Ctrl+c ): 2018 - 06 - 22 18 : 55 : 46 , 593 CRIT Supervisor running as root ( no user in config file ) 2018 - 06 - 22 18 : 55 : 46 , 593 WARN Included extra file \"/etc/supervisor/conf.d/supervisor-ckan-worker.conf\" during parsing 2018 - 06 - 22 18 : 55 : 46 , 615 INFO RPC interface 'supervisor' initialized Para probar esto directamente en el contenedor de portl-andino , debemos generar una nueva imagen del contenedor en base a la imagen del portal base . Para esto, en el archivo Dockerfile del portal, cambiamos el FROM , utilizando la imagen temporal que acabamos de crear: FROM datosgobar / portal - base : test # ... otros comandos Ahora, generamos la nueva imagen: cd portal - andino / docker build - t portal - andino : test . Luego, iniciamos la aplicaci\u00f3n en modo desarrollo: cd portal - andino / . / dev . sh setup ; Una vez iniciada la aplicaci\u00f3n, entramos al contenedor y verificamos que supervisor est\u00e9 corriendo: cd portal - andino / . / dev . sh console # Una vez en el contenedor supervisorctl En este momento, deber\u00edamos ver el estado de supervisor. Para salir, usamos Ctrl + C . Si comprobamos que el nuevo requerimiento est\u00e1 instalado y configurado, volvemos el Dockerfile a su estado anterior (deshaciendo el cambio en el FROM ). Luego, debemos sacar una nueva imagen del portal-base y, finalmente, una nueva de portal-andino que se base en la anterior.","title":"Generaci\u00f3n del nuevo contenedor"},{"location":"developers/development/#probar-modificaciones-y-nuevas-funcionalidades","text":"Para una mayor facilidad a la hora de desarrollar existe un archivo dev.sh , el cual contiene los siguientes comandos: install Instalar una instancia de Andino usando configuraciones espec\u00edficas ( usar '-h' para ver cu\u00e1les existen y para qu\u00e9 sirven ) update Actualizar una instancia de Andino usando configuraciones espec\u00edficas ( idem install ) exec Ejecutar el comando especificado en el contenedor de Andino logs Mostrar y seguir log del contenedor especificado ( default: Andino ) serve Usar un servidor de paster para debuguear f\u00e1cilmente la aplicaci\u00f3n en el puerto 5000 up Levantar los servicios stop Parar los servicios down Borrar los contenedores, sus vol\u00famenes, y el directorio de instalaci\u00f3n","title":"Probar modificaciones y nuevas funcionalidades"},{"location":"developers/development/#instalando-andino","text":"Se utilizar\u00e1 el archivo dev.sh de portal-andino ejecutando la funci\u00f3n install , la cual permite levantar una instancia en base a los par\u00e1metros recibidos. Dicha funci\u00f3n puede ser usada para testear cambios en portal-andino, portal-andino-theme, y/o portal-base. Los par\u00e1metros a utilizar son: -h | --help mostrar ayuda -a | --andino_branch VALUE nombre del branch de portal-andino ( default: master ) -t | --theme_branch VALUE nombre del branch de portal-andino-theme ( default: master o el ya utilizado ) -b | --base_branch VALUE nombre del branch de portal-base --site_host VALUE nombre de dominio del portal ( default: localhost ) --nginx_host_port VALUE puerto a usar para HTTP --nginx_ssl activar la configuraci\u00f3n de SSL --nginx_ssl_port VALUE puerto a usar para HTTPS --ssl_key_path VALUE path a la clave privada del certificado SSL --ssl_crt_path VALUE path al certificado SSL --nginx-extended-cache activar la configuraci\u00f3n de cach\u00e9 extendida de Nginx --file_size_limit VALUE tamanio m\u00e1ximo en MB para archivos de recursos ( default: 300 , m\u00e1ximo recomendado: 1024 ) --theme_volume_src VALUE path del host donde se encuentra clonado portal-andino-theme para crear un volumen ( default: /dev/null para no usar un theme ) Todos los par\u00e1metros son opcionales. Para portal-andino y portal-andino-theme, el branch a utilizar, por default, ser\u00e1 master en ambos casos. Para portal-base, se defaultear\u00e1 a la versi\u00f3n que figure en el Dockerfile de portal-andino. Nota: Si se utiliza el nombre 'localhost' para la variable site_host , es posible que ocurra un error al intentar subir un archivo perteneciente a un recurso al Datastore: Error: Proceso completo pero no se pudo enviar a result_url. Para evitar este problema, se puede utilizar un hostname local diferente; seguir los siguientes pasos para utilizar uno nuevo: * Ejecutar vi /etc/hosts en el host * Puede existir la l\u00ednea 127.0.0.1 localhost , y tambi\u00e9n otras parecidas; hay que escribir una nueva (es necesario asegurarse de que la IP y el hostname de la que queremos escribir sean distintos a todos los anteriores). * Escribir una l\u00ednea nueva 127.0.X.1 nuevo_hostname , reemplazando la 'X' por alg\u00fan n\u00famero que no est\u00e9 en una de las IPs de arriba, y 'nuevo_hostname' por el que se quiera utilizar_","title":"Instalando Andino"},{"location":"developers/development/#actualizando-andino","text":"Para el mismo archivo, tambi\u00e9n existe una funci\u00f3n update , cuyo objetivo es actualizar una instancia ya levantada. Los par\u00e1metros que recibe son exactamente los mismos que para la funci\u00f3n de instalaci\u00f3n. Nota: si se desea mantener la configuraci\u00f3n de SSL y/o de la cach\u00e9 extendida, es necesario especificarlo utilizando los par\u00e1metros correspondientes. No ocurre lo mismo para los archivos del certificado, puesto que son persistidos al instalar Andino.","title":"Actualizando Andino"},{"location":"developers/development/#utilizar-una-imagen-custom-de-portal-base-o-portal-base-nginx","text":"Si se quiere utilizar una imagen local en lugar de las existentes en https://hub.docker.com/r/datosgobar/portal-base, se debe correr este comando en el directorio donde se encuentra portal-base: docker build base_portal -t datosgobar/portal-base:{nombre que se le quiera dar a la imagen} Lo mismo aplica para Nginx: recordar que su Dockerfile est\u00e1 en nginx/ , por lo que el comando se debe correr ah\u00ed.","title":"Utilizar una imagen custom de portal-base o portal-base-nginx"},{"location":"developers/development/#debugear-andino","text":"Para una instancia de Andino, se puede utilizar el comando ./dev.sh serve , el cual utiliza un servidor de paster que nos permite debuguear f\u00e1cilmente, ya que apache no lo permite. Durante la ejecuci\u00f3n de este comando, la aplicaci\u00f3n estar\u00e1 utilizando el puerto 5000 .","title":"Debugear Andino"},{"location":"developers/dns/","text":"Configuraci\u00f3n de DNS Indice Introducci\u00f3n C\u00f3mo diagnosticar si tu andino tiene el problema C\u00f3mo resolver el problema Configuraci\u00f3n de DNS p\u00fablicos Configurar andino con el nuevo nombre de dominio Configurar un alias en la red de Docker para el contenedor nginx Verificando que el problema fue resuelto Introducci\u00f3n Algunas funcionalidades del Portal Andino requieren que la aplicaci\u00f3n web o procesos externos (ej: DataPusher) puedan navegar sin restricciones desde el proceso en el cual corre la aplicaci\u00f3n Python a la URL donde est\u00e1 publicado el sitio (definida por el setting ckan.site_url ). Esta URL debe poder ser accedida sin problemas de resoluci\u00f3n de nombres o de ruteo de IPs desde el mismo contenedor portal para el correcto funcionamiento del sitio. Algunas instancias de Andino han reportado problemas de funcionamiento debido a que la infraestructura donde est\u00e1n alojados no permite esta resoluci\u00f3n de nombres de manera correcta. Este art\u00edculo describe c\u00f3mo diagnosticar el problema y propone soluciones al mismo. Record\u00e1 que todos los comandos de este art\u00edculo deben ser ejecutados en el directorio donde instalaste andino, por ejemplo /etc/portal . C\u00f3mo diagnosticar si tu andino tiene el problema Para saber si es necesario realizar las configuraciones detalladas en este art\u00edculo, pod\u00e9s realizar los siguientes pasos detallados abajo. Obtener el valor de ckan.site_url : el valor se puede obtener ejecutando el siguiente comando: docker-compose -f latest.yml exec portal grep ckan\\.site_url /etc/ckan/default/production.ini . Ese comando deber\u00eda devolver ckan.site_url = <URL de tu Andino> . Evaluar si tu andino puede navegar hasta la URL del sitio. Ejecut\u00e1 el siguiente comando: docker-compose -f latest.yml exec portal curl <URL de tu Andino>/data.json . Si el segundo paso no devuelve una respuesta en formato json con la informaci\u00f3n del cat\u00e1logo de tu instancia id\u00e9ntica a la que obtendr\u00edas navegando desde tu navegador a <URL de tu Andino>/data.json (por ejemplo, luego de un rato obten\u00e9s curl: (7) Failed to connect to <URL de tu Andino> port 80: Connection timed out ), entonces deb\u00e9s aplicar la configuraci\u00f3n recomendada en este art\u00edculo . C\u00f3mo resolver el problema La soluci\u00f3n del problema se basa en asegurar que dentro de la red de Docker el nombre de dominio de Andino pueda resolverse correctamente a la IP p\u00fablica del host, a la IP privada dentro de la red en la que est\u00e1 o a la IP interna dentro de la red de Docker. Para lograrlo, planteamos distintas alternativas. Configuraci\u00f3n de DNS p\u00fablicos Este paso no est\u00e1 cubierto por esta documentaci\u00f3n, ya que puede ser resuelto mediante formas diversas, dependiendo de la infraestructura con la que cont\u00e1s. Lo que deb\u00e9s hacer es contactarte con tu administrador de infraestructura y solicitar una IP p\u00fablica fija y un nombre de dominio para la instancia de tu andino. Probablemente ya tengas un nombre de dominio asignado a tu instancia de andino, con lo cual pod\u00e9s saltar este paso. Configurar andino con el nuevo nombre de dominio Si ya ten\u00e9s un nombre de dominio asignado para acceder a tu andino, y cuando lo instalaste lo configuraste usando ese nombre de dominio, pod\u00e9s saltar este paso. Para configurar el nuevo nombre de dominio es necesario actualizar el setting ckan.site_url de la instancia de Andino. Esto lo pod\u00e9s lograr con el siguiente comando: docker-compose -f latest.yml exec portal /etc/ckan_init.d/update_conf.sh \"ckan.site_url=http://<tu nombre de dominio>\" . Pod\u00e9s verificar que haya quedado bien configurado ejecutando: docker-compose -f latest.yml exec portal grep ckan\\.site_url /etc/ckan/default/production.ini . Para reflejar los cambios, es neceario reiniciar la aplicaci\u00f3n web del contenedor portal : docker-compose -f latest.yml exec portal apachectl restart . Finalmente, si ya ten\u00edas datos cargados en tu andino, necesit\u00e1s regenerar el \u00edndice de b\u00fasqueda, usando el siguiente comando: docker-compose -f latest.yml exec portal /etc/ckan_init.d/run_rebuild_search.sh Configurar un alias en la red de Docker para el contenedor nginx Si, a\u00fan teniendo un nombre de dominio asignado, tu portal no puede resolver el mismo a la IP p\u00fablica del servidor, pod\u00e9s modificar la configuraci\u00f3n de la red de Docker usada por Andino para mapear el nombre de dominio de tu instancia al contenedor nginx . Acalaraci\u00f3n: Esta configuraci\u00f3n se realiza por defecto para todas las instancias de Andino desde la versi\u00f3n 2.5. Si tu instancia de Andino fue creada antes de la versi\u00f3n 2.5 , seguramente quieras realizar estos pasos. Para asegurarte de que la red interna de los contenedores de Docker que conforman Andino tienen la configuraci\u00f3n necesaria para la correcta resoluci\u00f3n de nombres, pod\u00e9s seguir los siguientes pasos (todos en el directorio de instalaci\u00f3n de Andino, por ejemplo /etc/portal ): Edit\u00e1 el archivo .env y asegurate que el valor del atributo SITE_HOST tenga el valor del hostname de tu instancia de Andino, sin http . Si no encontr\u00e1s una entrada para SITE_HOST en tu archivo .env , agregala al final. Por ejemplo deber\u00eda ser SITE_HOST=mi-andino.mi-ministerio.gob.ar . Descarg\u00e1 la \u00faltima versi\u00f3n de latest.yml : mv latest.yml latest.yml.bak && wget https://raw.githubusercontent.com/datosgobar/portal-andino/master/latest.yml . Probablemente ya tengas esta misma versi\u00f3n si actualizaste a Andino 2.5, pero para asegurarnos de que tengas los \u00faltimos cambios necesarios para esta configuraci\u00f3n es necesario realizar este paso. Recre\u00e1 el contenedor nginx : docker-compose -f latest.yml up -d nginx . Record\u00e1 que este paso puede generar algo de downtime , por lo que quiz\u00e1s sea prudente realizarlo en alg\u00fan horario con poco tr\u00e1fico en Andino. Verificando que el problema fue resuelto Si el problema fue resuelto, ahora podr\u00edas realizar el procedimiento detallado en C\u00f3mo diagnosticar si tu andino tiene el problema y deber\u00edas obtener un json como respuesta.","title":"Configuraci\u00f3n de DNS"},{"location":"developers/dns/#configuracion-de-dns","text":"","title":"Configuraci\u00f3n de DNS"},{"location":"developers/dns/#indice","text":"Introducci\u00f3n C\u00f3mo diagnosticar si tu andino tiene el problema C\u00f3mo resolver el problema Configuraci\u00f3n de DNS p\u00fablicos Configurar andino con el nuevo nombre de dominio Configurar un alias en la red de Docker para el contenedor nginx Verificando que el problema fue resuelto","title":"Indice"},{"location":"developers/dns/#introduccion","text":"Algunas funcionalidades del Portal Andino requieren que la aplicaci\u00f3n web o procesos externos (ej: DataPusher) puedan navegar sin restricciones desde el proceso en el cual corre la aplicaci\u00f3n Python a la URL donde est\u00e1 publicado el sitio (definida por el setting ckan.site_url ). Esta URL debe poder ser accedida sin problemas de resoluci\u00f3n de nombres o de ruteo de IPs desde el mismo contenedor portal para el correcto funcionamiento del sitio. Algunas instancias de Andino han reportado problemas de funcionamiento debido a que la infraestructura donde est\u00e1n alojados no permite esta resoluci\u00f3n de nombres de manera correcta. Este art\u00edculo describe c\u00f3mo diagnosticar el problema y propone soluciones al mismo. Record\u00e1 que todos los comandos de este art\u00edculo deben ser ejecutados en el directorio donde instalaste andino, por ejemplo /etc/portal .","title":"Introducci\u00f3n"},{"location":"developers/dns/#como-diagnosticar-si-tu-andino-tiene-el-problema","text":"Para saber si es necesario realizar las configuraciones detalladas en este art\u00edculo, pod\u00e9s realizar los siguientes pasos detallados abajo. Obtener el valor de ckan.site_url : el valor se puede obtener ejecutando el siguiente comando: docker-compose -f latest.yml exec portal grep ckan\\.site_url /etc/ckan/default/production.ini . Ese comando deber\u00eda devolver ckan.site_url = <URL de tu Andino> . Evaluar si tu andino puede navegar hasta la URL del sitio. Ejecut\u00e1 el siguiente comando: docker-compose -f latest.yml exec portal curl <URL de tu Andino>/data.json . Si el segundo paso no devuelve una respuesta en formato json con la informaci\u00f3n del cat\u00e1logo de tu instancia id\u00e9ntica a la que obtendr\u00edas navegando desde tu navegador a <URL de tu Andino>/data.json (por ejemplo, luego de un rato obten\u00e9s curl: (7) Failed to connect to <URL de tu Andino> port 80: Connection timed out ), entonces deb\u00e9s aplicar la configuraci\u00f3n recomendada en este art\u00edculo .","title":"C\u00f3mo diagnosticar si tu andino tiene el problema"},{"location":"developers/dns/#como-resolver-el-problema","text":"La soluci\u00f3n del problema se basa en asegurar que dentro de la red de Docker el nombre de dominio de Andino pueda resolverse correctamente a la IP p\u00fablica del host, a la IP privada dentro de la red en la que est\u00e1 o a la IP interna dentro de la red de Docker. Para lograrlo, planteamos distintas alternativas.","title":"C\u00f3mo resolver el problema"},{"location":"developers/dns/#configuracion-de-dns-publicos","text":"Este paso no est\u00e1 cubierto por esta documentaci\u00f3n, ya que puede ser resuelto mediante formas diversas, dependiendo de la infraestructura con la que cont\u00e1s. Lo que deb\u00e9s hacer es contactarte con tu administrador de infraestructura y solicitar una IP p\u00fablica fija y un nombre de dominio para la instancia de tu andino. Probablemente ya tengas un nombre de dominio asignado a tu instancia de andino, con lo cual pod\u00e9s saltar este paso.","title":"Configuraci\u00f3n de DNS p\u00fablicos"},{"location":"developers/dns/#configurar-andino-con-el-nuevo-nombre-de-dominio","text":"Si ya ten\u00e9s un nombre de dominio asignado para acceder a tu andino, y cuando lo instalaste lo configuraste usando ese nombre de dominio, pod\u00e9s saltar este paso. Para configurar el nuevo nombre de dominio es necesario actualizar el setting ckan.site_url de la instancia de Andino. Esto lo pod\u00e9s lograr con el siguiente comando: docker-compose -f latest.yml exec portal /etc/ckan_init.d/update_conf.sh \"ckan.site_url=http://<tu nombre de dominio>\" . Pod\u00e9s verificar que haya quedado bien configurado ejecutando: docker-compose -f latest.yml exec portal grep ckan\\.site_url /etc/ckan/default/production.ini . Para reflejar los cambios, es neceario reiniciar la aplicaci\u00f3n web del contenedor portal : docker-compose -f latest.yml exec portal apachectl restart . Finalmente, si ya ten\u00edas datos cargados en tu andino, necesit\u00e1s regenerar el \u00edndice de b\u00fasqueda, usando el siguiente comando: docker-compose -f latest.yml exec portal /etc/ckan_init.d/run_rebuild_search.sh","title":"Configurar andino con el nuevo nombre de dominio"},{"location":"developers/dns/#configurar-un-alias-en-la-red-de-docker-para-el-contenedor-nginx","text":"Si, a\u00fan teniendo un nombre de dominio asignado, tu portal no puede resolver el mismo a la IP p\u00fablica del servidor, pod\u00e9s modificar la configuraci\u00f3n de la red de Docker usada por Andino para mapear el nombre de dominio de tu instancia al contenedor nginx . Acalaraci\u00f3n: Esta configuraci\u00f3n se realiza por defecto para todas las instancias de Andino desde la versi\u00f3n 2.5. Si tu instancia de Andino fue creada antes de la versi\u00f3n 2.5 , seguramente quieras realizar estos pasos. Para asegurarte de que la red interna de los contenedores de Docker que conforman Andino tienen la configuraci\u00f3n necesaria para la correcta resoluci\u00f3n de nombres, pod\u00e9s seguir los siguientes pasos (todos en el directorio de instalaci\u00f3n de Andino, por ejemplo /etc/portal ): Edit\u00e1 el archivo .env y asegurate que el valor del atributo SITE_HOST tenga el valor del hostname de tu instancia de Andino, sin http . Si no encontr\u00e1s una entrada para SITE_HOST en tu archivo .env , agregala al final. Por ejemplo deber\u00eda ser SITE_HOST=mi-andino.mi-ministerio.gob.ar . Descarg\u00e1 la \u00faltima versi\u00f3n de latest.yml : mv latest.yml latest.yml.bak && wget https://raw.githubusercontent.com/datosgobar/portal-andino/master/latest.yml . Probablemente ya tengas esta misma versi\u00f3n si actualizaste a Andino 2.5, pero para asegurarnos de que tengas los \u00faltimos cambios necesarios para esta configuraci\u00f3n es necesario realizar este paso. Recre\u00e1 el contenedor nginx : docker-compose -f latest.yml up -d nginx . Record\u00e1 que este paso puede generar algo de downtime , por lo que quiz\u00e1s sea prudente realizarlo en alg\u00fan horario con poco tr\u00e1fico en Andino.","title":"Configurar un alias en la red de Docker para el contenedor nginx"},{"location":"developers/dns/#verificando-que-el-problema-fue-resuelto","text":"Si el problema fue resuelto, ahora podr\u00edas realizar el procedimiento detallado en C\u00f3mo diagnosticar si tu andino tiene el problema y deber\u00edas obtener un json como respuesta.","title":"Verificando que el problema fue resuelto"},{"location":"developers/docker/","text":"Generaci\u00f3n de im\u00e1genes Docker Generaci\u00f3n de im\u00e1genes Docker Para generar las im\u00e1genes, ejecutar la aplicaci\u00f3n y levantarla, previamente es necesario instalar Docker y docker-compose : Instalar Docker (la versi\u00f3n debe ser igual o m\u00e1s reciente a 17.05.0-ce (2017-05-04)) Instalar docker-compose Actualmente, el repositorio contiene 1 archivo Dockerfile y 2 archivos docker-compose Dockerfile : Se usa para generar la imagen de la aplicaci\u00f3n dev.yml : Archivo de docker-compose para levantar los servicios necesarios y generar la imagen de la aplicaci\u00f3n. latest.yml : Archivo de docker-compose para levantar la aplicaci\u00f3n a su \u00faltima version. (ver instalaci\u00f3n ) Para levantar toda la aplicacion, se puede correr: $ docker-compose -f dev.yml up -d nginx Si es la primera vez que se corre este comando, puede llegar a tardar bastante en descargar las im\u00e1genes. Una vez terminado, dejar en el puerto localhost:80 la aplicacion ejecut\u00e1ndose, pero antes se debe correr un comando para inicializar el desarrollo: $ docker exec - it andino / etc / ckan_init . d / init_dev . sh Tambi\u00e9n se pueden levantar los servicios por separado de la aplicaci\u00f3n: Los servicios : $ docker-compose -f dev.yml up --build --abort-on-container-exit db sol redis postfix La aplicaci\u00f3n andino que tendr\u00e1 el puerto 8080 y en el 8800 el datapusher. $ docker-compose -f dev.yml up --abort-on-container-exit --build --no-deps portal Nginx que estar\u00e1 en el puerto 80 : $ docker-compose -f dev.yml up -d --no-deps nginx Eso levantar\u00e1 la aplicaci\u00f3n con el directorio actual ( $PWD ) disponible dentro del directorio /dev-app del container. Para acceder a la aplicaci\u00f3n, hacer modificaciones en runtime , basta con correr el comando: $ docker - compose - f dev . yml exec andino / bin / bash","title":"Generaci\u00f3n de im\u00e1genes Docker"},{"location":"developers/docker/#generacion-de-imagenes-docker","text":"Generaci\u00f3n de im\u00e1genes Docker Para generar las im\u00e1genes, ejecutar la aplicaci\u00f3n y levantarla, previamente es necesario instalar Docker y docker-compose : Instalar Docker (la versi\u00f3n debe ser igual o m\u00e1s reciente a 17.05.0-ce (2017-05-04)) Instalar docker-compose Actualmente, el repositorio contiene 1 archivo Dockerfile y 2 archivos docker-compose Dockerfile : Se usa para generar la imagen de la aplicaci\u00f3n dev.yml : Archivo de docker-compose para levantar los servicios necesarios y generar la imagen de la aplicaci\u00f3n. latest.yml : Archivo de docker-compose para levantar la aplicaci\u00f3n a su \u00faltima version. (ver instalaci\u00f3n ) Para levantar toda la aplicacion, se puede correr: $ docker-compose -f dev.yml up -d nginx Si es la primera vez que se corre este comando, puede llegar a tardar bastante en descargar las im\u00e1genes. Una vez terminado, dejar en el puerto localhost:80 la aplicacion ejecut\u00e1ndose, pero antes se debe correr un comando para inicializar el desarrollo: $ docker exec - it andino / etc / ckan_init . d / init_dev . sh Tambi\u00e9n se pueden levantar los servicios por separado de la aplicaci\u00f3n: Los servicios : $ docker-compose -f dev.yml up --build --abort-on-container-exit db sol redis postfix La aplicaci\u00f3n andino que tendr\u00e1 el puerto 8080 y en el 8800 el datapusher. $ docker-compose -f dev.yml up --abort-on-container-exit --build --no-deps portal Nginx que estar\u00e1 en el puerto 80 : $ docker-compose -f dev.yml up -d --no-deps nginx Eso levantar\u00e1 la aplicaci\u00f3n con el directorio actual ( $PWD ) disponible dentro del directorio /dev-app del container. Para acceder a la aplicaci\u00f3n, hacer modificaciones en runtime , basta con correr el comando: $ docker - compose - f dev . yml exec andino / bin / bash","title":"Generaci\u00f3n de im\u00e1genes Docker"},{"location":"developers/https/","text":"Configuraci\u00f3n HTTPS Indice Certificado SSL Configuraci\u00f3n de SSL Modificar el puerto Realizar cambios en un Andino instalado Probar la configuraci\u00f3n Renovar certificados SSL Deshabilitar SSL Certificado SSL Andino cuenta con soporte builtin de certificados SSL. Es posible instalar Andino con SSL, actualizar una versi\u00f3n de Andino sin SSL y agregarle el soporte para SSL, e inclusive deshabilitar SSL a una instancia con SSL. Lo \u00fanico que un administrador de Andino necesita para habilitar SSL es contar con los certificados .key y .crt para nuestra aplicaci\u00f3n y la elecci\u00f3n de un puerto libre del host para usar SSL. C\u00f3mo obtener estos archivos est\u00e1 fuera del \"scope\" de esta documentaci\u00f3n. Si adem\u00e1s de un .crt se posee un bundle, se debe incluir el contenido del certificado en dicho bundle (tiene que estar al principio, antes del texto ya existente). Es recomendable asegurarse de que la key y el certificado sean compatibles. Esto se puede lograr de la siguiente manera: 1. Ejecutar openssl rsa -noout -text -in {path_de_la_key} 2. Ejecutar openssl x509 -noout -text -in {path_del_crt} 3. Asegurarse de que no haya habido ning\u00fan error durante los pasos anteriores 4. 1. Buscar el contenido de modulus en el resultado del paso 1 2. Buscar el contenido de Certificate -> Signature Algorithm -> Subject Public Key Info -> Public Key Algorithm -> Modulus en el resultado del paso 2 5. Comparar los contenidos encontrados Si los contenidos encontrados son id\u00e9nticos, entonces la key y el certificado son compatibles. Configuraci\u00f3n de SSL Tanto la instalaci\u00f3n como la actualizaci\u00f3n de un Andino emplean el uso de un par\u00e1metro llamado nginx_ssl , el cual puede ser utilizado para especificar que se desea utilizar SSL. Para especificar el path de los archivos del certificado, se debe utilizar los par\u00e1metros ssl_key_path y ssl_crt_path . Los archivos dentro del contenedor nginx se llamar\u00e1n andino.key y andino.crt respectivamente, y el proceso de instalaci\u00f3n o actualizaci\u00f3n los copiar\u00e1 en el directorio /etc/nginx/ssl . En caso de que al menos uno de estos archivos no est\u00e9, no se podr\u00e1 utilizar el archivo de configuraci\u00f3n para SSL y se elegir\u00e1 el default en su lugar. Hay que asegurarse de que el path de cada archivo sea v\u00e1lido (exista en el host), y que est\u00e9n especificados en la instalaci\u00f3n/actualizaci\u00f3n. Un navegador web no deber\u00eda mostrarnos ninguna advertencia si los certificados son correctos. Un ejemplo de uso dentro del comando de instalaci\u00f3n de Andino para los par\u00e1metros mencionados: --nginx_ssl --ssl_key_path=\"/home/miusuario/Desktop/mi_archivo_key.key\" --ssl_crt_path=\"/home/miusuario/Desktop/mi_archivo_crt.crt\" Estos par\u00e1metros de configuraci\u00f3n deben ser especificados en cada actualizaci\u00f3n de Andino, para mantener SSL habilitado. Modificar el puerto Para la instalaci\u00f3n de Andino, el puerto a ser utilizado por default es el 443, pero \u00e9ste puede ser cambiado mediante el par\u00e1metro nginx_ssl_port y un valor a elecci\u00f3n. Ejemplo: --nginx_ssl_port=8443 Es importante para los administradores saber que Andino tomar\u00e1 el puerto especificado (o el default) ya sea que el portal use o no use HTTPS. En caso de no querer usar HTTPS y que el host tenga erl puerto 443 tomado por un servidor web, es requisito especificar un puerto distinto (ejemplo: 8443) que ser\u00e1 reservado por Andino, pero no utilizado. Realizar cambios en un Andino instalado Para lograr que Andino implemente la configuraci\u00f3n HTTPS, es necesario realizar una actualizaci\u00f3n de andino y especificar las opciones detalladas en la secci\u00f3n Configuraci\u00f3n de SSL . Estas opciones solo son v\u00e1lidas a partir de Andino release-2.5.2 . Probar la configuraci\u00f3n Para asegurarse de que Nginx est\u00e9 utilizando la configuraci\u00f3n HTTPS, ejecutar el siguiente comando deber\u00eda mostrar nginx_ssl.conf : docker exec -it andino-nginx bash -c 'echo $NGINX_CONFIG_FILE' . Si se est\u00e1 implementando la configuraci\u00f3n HTTPS y los certificados fueron creados correctamente, el explorador deber\u00eda redirigir cualquier llamada HTTP a HTTPS. Si se especific\u00f3 un puerto para SSL, el portal deber\u00eda permitir el ingreso si el puerto es parte de la URL. Tambi\u00e9n deber\u00edas poder navegar el portal en el puerto SSL seleccionado. Renovar certificados SSL Para renovar los certificados SSL de tu instancia de Andino es tan sencillo como ejecutar una actualizaci\u00f3n de Andino. Para llevarlo a cabo es necesario que subas los dos archivos que componen el certificado ( .cer y .key ) y que ejecutes el comando de actualizaci\u00f3n de Andino, especificando la opci\u00f3n --nginx_ssl y las opciones que permiten configurar los archivos del certificado como esta\u00e1 especificado en la secci\u00f3n Configuraci\u00f3n de SSL . Si dese\u00e1s mantener la versi\u00f3n de Andino que ten\u00e9s, deb\u00e9s especificar la opci\u00f3n --andino_version con la versi\u00f3n de tu instancia de Andino. Deshabilitar SSL El proceso de deshabilitaci\u00f3n de SSL se puede lograr mediante la ejecuci\u00f3n del proceso de actualizaci\u00f3n de Andino update.py especificando el par\u00e1metro --andino_version a una versi\u00f3n igual a la del portal a configurar (es decir, se mantendr\u00e1 la misma versi\u00f3n), pero no especificando el par\u00e1metro --nginx_ssl . De esta manera el script de actualizaci\u00f3n usar\u00e1 la configuraci\u00f3n de Andino que no habilita HTTPS y se habilitar\u00e1 el acceso por el puerto 80. Ejemplo de uso: sudo wget https : // raw . github . com / datosgobar / portal - andino / master / install / update . py sudo python update . py --andino_version=<versi\u00f3n del andino del portal>","title":"Configuraci\u00f3n HTTPS"},{"location":"developers/https/#configuracion-https","text":"","title":"Configuraci\u00f3n HTTPS"},{"location":"developers/https/#indice","text":"Certificado SSL Configuraci\u00f3n de SSL Modificar el puerto Realizar cambios en un Andino instalado Probar la configuraci\u00f3n Renovar certificados SSL Deshabilitar SSL","title":"Indice"},{"location":"developers/https/#certificado-ssl","text":"Andino cuenta con soporte builtin de certificados SSL. Es posible instalar Andino con SSL, actualizar una versi\u00f3n de Andino sin SSL y agregarle el soporte para SSL, e inclusive deshabilitar SSL a una instancia con SSL. Lo \u00fanico que un administrador de Andino necesita para habilitar SSL es contar con los certificados .key y .crt para nuestra aplicaci\u00f3n y la elecci\u00f3n de un puerto libre del host para usar SSL. C\u00f3mo obtener estos archivos est\u00e1 fuera del \"scope\" de esta documentaci\u00f3n. Si adem\u00e1s de un .crt se posee un bundle, se debe incluir el contenido del certificado en dicho bundle (tiene que estar al principio, antes del texto ya existente). Es recomendable asegurarse de que la key y el certificado sean compatibles. Esto se puede lograr de la siguiente manera: 1. Ejecutar openssl rsa -noout -text -in {path_de_la_key} 2. Ejecutar openssl x509 -noout -text -in {path_del_crt} 3. Asegurarse de que no haya habido ning\u00fan error durante los pasos anteriores 4. 1. Buscar el contenido de modulus en el resultado del paso 1 2. Buscar el contenido de Certificate -> Signature Algorithm -> Subject Public Key Info -> Public Key Algorithm -> Modulus en el resultado del paso 2 5. Comparar los contenidos encontrados Si los contenidos encontrados son id\u00e9nticos, entonces la key y el certificado son compatibles.","title":"Certificado SSL"},{"location":"developers/https/#configuracion-de-ssl","text":"Tanto la instalaci\u00f3n como la actualizaci\u00f3n de un Andino emplean el uso de un par\u00e1metro llamado nginx_ssl , el cual puede ser utilizado para especificar que se desea utilizar SSL. Para especificar el path de los archivos del certificado, se debe utilizar los par\u00e1metros ssl_key_path y ssl_crt_path . Los archivos dentro del contenedor nginx se llamar\u00e1n andino.key y andino.crt respectivamente, y el proceso de instalaci\u00f3n o actualizaci\u00f3n los copiar\u00e1 en el directorio /etc/nginx/ssl . En caso de que al menos uno de estos archivos no est\u00e9, no se podr\u00e1 utilizar el archivo de configuraci\u00f3n para SSL y se elegir\u00e1 el default en su lugar. Hay que asegurarse de que el path de cada archivo sea v\u00e1lido (exista en el host), y que est\u00e9n especificados en la instalaci\u00f3n/actualizaci\u00f3n. Un navegador web no deber\u00eda mostrarnos ninguna advertencia si los certificados son correctos. Un ejemplo de uso dentro del comando de instalaci\u00f3n de Andino para los par\u00e1metros mencionados: --nginx_ssl --ssl_key_path=\"/home/miusuario/Desktop/mi_archivo_key.key\" --ssl_crt_path=\"/home/miusuario/Desktop/mi_archivo_crt.crt\" Estos par\u00e1metros de configuraci\u00f3n deben ser especificados en cada actualizaci\u00f3n de Andino, para mantener SSL habilitado.","title":"Configuraci\u00f3n de SSL"},{"location":"developers/https/#modificar-el-puerto","text":"Para la instalaci\u00f3n de Andino, el puerto a ser utilizado por default es el 443, pero \u00e9ste puede ser cambiado mediante el par\u00e1metro nginx_ssl_port y un valor a elecci\u00f3n. Ejemplo: --nginx_ssl_port=8443 Es importante para los administradores saber que Andino tomar\u00e1 el puerto especificado (o el default) ya sea que el portal use o no use HTTPS. En caso de no querer usar HTTPS y que el host tenga erl puerto 443 tomado por un servidor web, es requisito especificar un puerto distinto (ejemplo: 8443) que ser\u00e1 reservado por Andino, pero no utilizado.","title":"Modificar el puerto"},{"location":"developers/https/#realizar-cambios-en-un-andino-instalado","text":"Para lograr que Andino implemente la configuraci\u00f3n HTTPS, es necesario realizar una actualizaci\u00f3n de andino y especificar las opciones detalladas en la secci\u00f3n Configuraci\u00f3n de SSL . Estas opciones solo son v\u00e1lidas a partir de Andino release-2.5.2 .","title":"Realizar cambios en un Andino instalado"},{"location":"developers/https/#probar-la-configuracion","text":"Para asegurarse de que Nginx est\u00e9 utilizando la configuraci\u00f3n HTTPS, ejecutar el siguiente comando deber\u00eda mostrar nginx_ssl.conf : docker exec -it andino-nginx bash -c 'echo $NGINX_CONFIG_FILE' . Si se est\u00e1 implementando la configuraci\u00f3n HTTPS y los certificados fueron creados correctamente, el explorador deber\u00eda redirigir cualquier llamada HTTP a HTTPS. Si se especific\u00f3 un puerto para SSL, el portal deber\u00eda permitir el ingreso si el puerto es parte de la URL. Tambi\u00e9n deber\u00edas poder navegar el portal en el puerto SSL seleccionado.","title":"Probar la configuraci\u00f3n"},{"location":"developers/https/#renovar-certificados-ssl","text":"Para renovar los certificados SSL de tu instancia de Andino es tan sencillo como ejecutar una actualizaci\u00f3n de Andino. Para llevarlo a cabo es necesario que subas los dos archivos que componen el certificado ( .cer y .key ) y que ejecutes el comando de actualizaci\u00f3n de Andino, especificando la opci\u00f3n --nginx_ssl y las opciones que permiten configurar los archivos del certificado como esta\u00e1 especificado en la secci\u00f3n Configuraci\u00f3n de SSL . Si dese\u00e1s mantener la versi\u00f3n de Andino que ten\u00e9s, deb\u00e9s especificar la opci\u00f3n --andino_version con la versi\u00f3n de tu instancia de Andino.","title":"Renovar certificados SSL"},{"location":"developers/https/#deshabilitar-ssl","text":"El proceso de deshabilitaci\u00f3n de SSL se puede lograr mediante la ejecuci\u00f3n del proceso de actualizaci\u00f3n de Andino update.py especificando el par\u00e1metro --andino_version a una versi\u00f3n igual a la del portal a configurar (es decir, se mantendr\u00e1 la misma versi\u00f3n), pero no especificando el par\u00e1metro --nginx_ssl . De esta manera el script de actualizaci\u00f3n usar\u00e1 la configuraci\u00f3n de Andino que no habilita HTTPS y se habilitar\u00e1 el acceso por el puerto 80. Ejemplo de uso: sudo wget https : // raw . github . com / datosgobar / portal - andino / master / install / update . py sudo python update . py --andino_version=<versi\u00f3n del andino del portal>","title":"Deshabilitar SSL"},{"location":"developers/install/","text":"Instalaci\u00f3n Teniendo en cuenta la dificultad de implementaci\u00f3n e incluso la cantidad de pasos para lograr un deploy existoso, existen dos formas de instalar esta distribuci\u00f3n de CKAN . Si no ten\u00e9s muchos conocimientos de CKAN, Docker o de administraci\u00e9n de servidores en general, es recomendable usar la instalaci\u00f3n simplificada de Andino . Est\u00e1 pensada para que, en la menor cantidad de pasos y de manera sencilla, tengas un portal de datos funcionando. Si ya conoc\u00e9s la plataforma, ten\u00e9s experiencia con Docker o, simplemente, quer\u00e9s entender c\u00f3mo funciona esta implementaci\u00f3n, te sugiero que revises la instalacion avanzada de Andino Indice Dependencias Instalaci\u00f3n simplificada de andino Instalaci\u00f3n avanzada de andino Desinstalar andino Dependencias DOCKER: Gu\u00eda de instalaci\u00f3n . Versi\u00f3n m\u00ednima testeada : 1.13.1 Docker Compose: Gu\u00eda de instalaci\u00f3n . Versi\u00f3n m\u00ednima testeada : 1.12.0 Instalaci\u00f3n simplificada de andino La idea detr\u00e1s de esta implementaci\u00f3n de CKAN es que s\u00f3lo te encargues de tus datos , nada m\u00e1s. Por eso, si \"copi\u00e1s y peg\u00e1s\" el comando de consola, en s\u00f3lo unos momentos, tendr\u00e1s un Andino listo para usar. Esta clase de instalaci\u00f3n no requiere que clones el repositorio, ya que usamos contenedores alojados en DockerHub Ubuntu|Debian|RHEL|CentOS: Instalaci\u00f3n: Para la instalaci\u00f3n, usamos un script de python llamado install.py . El mismo requiere algunos par\u00e1metros espec\u00edficos, y existen otros que son opcionales: # Parametros de install.py [ -h ] Mostrar la ayuda del script --error_email Email donde se mandaran los errores del portal de ser necesario --site_host Dominio o IP del la aplicaci\u00f3n *sin el protocolo* --database_user Nombre del usuario de la base de datos a crear --database_password Contrase\u00f1a de la base de datos a crear --datastore_user Nombre del usuario de la base de datos del datastore a crear --datastore_password Contrase\u00f1a de la base de datos del datastore a crear [ --nginx-extended-cache ] Configura nginx con una configuraci\u00f3n extendida y configura el hook de invalidaci\u00f3n de cache de Andino para notificar a nginx [ --nginx_ssl ] Aplica la configuraci\u00f3n HTTPS en nginx. Requiere ambos archivos del certificado SSL para poder lograrlo ; en caso contrario, se utilizar\u00e1 la configuraci\u00f3n default [ --ssl_key_path SSL_KEY_PATH ] Path dentro del host donde est\u00e1 ubicado el archivo .key para el certificado SSL ; ser\u00e1 copiado al contenedor de nginx si tanto \u00e9ste como el .crt pueden ser encontrados [ --ssl_crt_path SSL_CRT_PATH ] Path dentro del host donde est\u00e1 ubicado el archivo .crt para el certificado SSL ; ser\u00e1 copiado al contenedor de nginx si tanto \u00e9ste como el .key pueden ser encontrados [ --nginx_port NGINX_PORT ] Puerto del servidor \"Host\" que se desea que se tome para recibir llamadas HTTP. Por defecto es el 80 . [ --nginx_ssl_port NGINX_SSL_PORT ] Puerto del servidor \"Host\" que se desea que se tome para recibir llamadas HTTPS. Por defecto es el 443 . Es importante para los administradores saber que Andino tomar\u00e1 el puerto especificado ( o el default ) ya sea que el portal use o no use HTTPS. En caso de no querer usar HTTPS y que el host tenga erl puerto 443 tomado por un servidor web, es requisito especificar un puerto distinto ( ejemplo: 8443 ) que ser\u00e1 reservado por Andino, pero no utilizado. [ --datastore_port DATASTORE_PORT ] Puerto del servidor \"Host\" que se desea que se tome para recibir llamadas HTTP al \"datastore\" . Por defecto es el 8800 . [ --install_directory INSTALL_DIRECTORY ] Directorio donde se desea instalar la aplicaci\u00f3n. Por defecto es ` /etc/portal ` ( recomendado ) [ --file_size_limit FILE_SIZE_LIMIT ] Configura el l\u00edmite de tama\u00f1o para subida de archivos en recursos. Para esta instalaci\u00f3n de ejemplo, usaremos estos par\u00e1metros para la aplicaci\u00f3n. Para los dem\u00e1s, usaremos los valores por defecto: Email donde se mandar\u00e1n los errores. EMAIL=admin@example.com Dominio o IP de la aplicaci\u00f3n sin el protocolo : HOST=datos.gob.ar Usuario de la base de datos: DB_USER=<my db user> Password de la base de datos: DB_PASS=<my db pass> Usuario del datastore: STORE_USER=<my datastore user> Password del datastore: STORE_PASS=<my datastore password> Nota : Si usamos una IP para la variable HOST , el env\u00edo de mails no funcionar\u00e1. Postfix require un \"fully-qualified domain name (FQDN)\". Ver la documentaci\u00f3n de Postfix para m\u00e1s detalles. Nota 2 : Si se utiliza el nombre 'localhost' para la variable site_host , es posible que ocurra un error al intentar subir un archivo perteneciente a un recurso al Datastore. Para evitar este problema, se debe utilizar un hostname diferente. # Primero especificamos los valores necesarios EMAIL = admin@example.com HOST = andino.midominio.com.ar DB_USER = my_database_user DB_PASS = my_database_pass STORE_USER = my_data_user STORE_PASS = my_data_pass wget https://raw.github.com/datosgobar/portal-andino/master/install/ { install,installation_manager } .py sudo python ./install.py \\ --error_email \" $EMAIL \" \\ --site_host = \" $HOST \" \\ --database_user = \" $DB_USER \" \\ --database_password = \" $DB_PASS \" \\ --datastore_user = \" $STORE_USER \" \\ --datastore_password = \" $STORE_PASS \" Instalaci\u00f3n avanzada de andino La instalaci\u00f3n avanzada est\u00e1 pensada para usuarios que quieren ver c\u00f3mo funciona internamente Andino Para instalar y ejecutar Andino, seguiremos estos pasos: Paso 1: Clonar repositorio. sudo mkdir /etc/portal cd /etc/portal sudo git clone https://github.com/datosgobar/portal-andino.git . Paso 2: Especificar las variables de entorno para el contenedor de postgresql. NOTA: Debemos usar un dominio v\u00e1lido para la variable DOMINIO , de otra forma el envio de mails no funcionar\u00e1. Postfix require un \"fully-qualified domain name (FQDN)\". Ver la documentaci\u00f3n de Postfix para m\u00e1s detalles. DB_USER = <my user> DB_PASS = <my pass> DOMINIO = andino.midominio.com.ar ANDINO_VERSION = <version que deseamos instalar> sudo su -c \"echo POSTGRES_USER= $DB_USER > .env\" sudo su -c \"echo POSTGRES_PASSWORD= $DB_PASS >> .env\" sudo su -c \"echo NGINX_HOST_PORT=80 >> .env\" sudo su -c \"echo DATASTORE_HOST_PORT=8800 >> .env\" sudo su -c \"echo maildomain= $DOMINIO >> .env\" sudo su -c \"echo ANDINO_TAG= $ANDINO_VERSION >> .env\" Paso 3: Construir y lanzar los contenedor de servicios usando el archivo latest.yml : docker-compose -f latest.yml up -d db postfix redis solr Paso 4: Construir y lanzar el contenedor de andino usando el archivo latest.yml : docker-compose -f latest.yml up -d portal Paso 5: Inicializar la base de datos y la configuraci\u00f3n de la aplicaci\u00f3n: EMAIL = admin@example.com HOST = datos.gob.ar DB_USER = <my db user> DB_PASS = <my db pass> STORE_USER = <my datastore user> STORE_PASS = <my datastore password> docker-compose -f latest.yml exec portal /etc/ckan_init.d/init.sh -e \" $EMAIL \" -h \" $HOST \" \\ -p \" $DB_USER \" -P \" $DB_PASS \" \\ -d \" $STORE_USER \" -D \" $STORE_PASS \" Paso 8: Construir el contenedor de nginx usando el archivo latest.yml : `docker-compose -f latest.yml up -d nginx Desinstalar andino Esta secuencia de comandos va a ELIMINAR TODOS LOS CONTENEDORES, IM\u00c1GENES y VOLUMENES de la aplicaci\u00f3n de la vm donde est\u00e1 instalada la plataforma. Esta operaci\u00f3n no es reversible. Perder\u00e1s todos tus datos si realizas esta operaci\u00f3n . app_dir = \"/etc/portal/\" cd $app_dir docker-compose -f latest.yml down -v cd ~/ sudo rm $app_dir -r","title":"Instalaci\u00f3n"},{"location":"developers/install/#instalacion","text":"Teniendo en cuenta la dificultad de implementaci\u00f3n e incluso la cantidad de pasos para lograr un deploy existoso, existen dos formas de instalar esta distribuci\u00f3n de CKAN . Si no ten\u00e9s muchos conocimientos de CKAN, Docker o de administraci\u00e9n de servidores en general, es recomendable usar la instalaci\u00f3n simplificada de Andino . Est\u00e1 pensada para que, en la menor cantidad de pasos y de manera sencilla, tengas un portal de datos funcionando. Si ya conoc\u00e9s la plataforma, ten\u00e9s experiencia con Docker o, simplemente, quer\u00e9s entender c\u00f3mo funciona esta implementaci\u00f3n, te sugiero que revises la instalacion avanzada de Andino","title":"Instalaci\u00f3n"},{"location":"developers/install/#indice","text":"Dependencias Instalaci\u00f3n simplificada de andino Instalaci\u00f3n avanzada de andino Desinstalar andino","title":"Indice"},{"location":"developers/install/#dependencias","text":"DOCKER: Gu\u00eda de instalaci\u00f3n . Versi\u00f3n m\u00ednima testeada : 1.13.1 Docker Compose: Gu\u00eda de instalaci\u00f3n . Versi\u00f3n m\u00ednima testeada : 1.12.0","title":"Dependencias"},{"location":"developers/install/#instalacion-simplificada-de-andino","text":"La idea detr\u00e1s de esta implementaci\u00f3n de CKAN es que s\u00f3lo te encargues de tus datos , nada m\u00e1s. Por eso, si \"copi\u00e1s y peg\u00e1s\" el comando de consola, en s\u00f3lo unos momentos, tendr\u00e1s un Andino listo para usar. Esta clase de instalaci\u00f3n no requiere que clones el repositorio, ya que usamos contenedores alojados en DockerHub Ubuntu|Debian|RHEL|CentOS: Instalaci\u00f3n: Para la instalaci\u00f3n, usamos un script de python llamado install.py . El mismo requiere algunos par\u00e1metros espec\u00edficos, y existen otros que son opcionales: # Parametros de install.py [ -h ] Mostrar la ayuda del script --error_email Email donde se mandaran los errores del portal de ser necesario --site_host Dominio o IP del la aplicaci\u00f3n *sin el protocolo* --database_user Nombre del usuario de la base de datos a crear --database_password Contrase\u00f1a de la base de datos a crear --datastore_user Nombre del usuario de la base de datos del datastore a crear --datastore_password Contrase\u00f1a de la base de datos del datastore a crear [ --nginx-extended-cache ] Configura nginx con una configuraci\u00f3n extendida y configura el hook de invalidaci\u00f3n de cache de Andino para notificar a nginx [ --nginx_ssl ] Aplica la configuraci\u00f3n HTTPS en nginx. Requiere ambos archivos del certificado SSL para poder lograrlo ; en caso contrario, se utilizar\u00e1 la configuraci\u00f3n default [ --ssl_key_path SSL_KEY_PATH ] Path dentro del host donde est\u00e1 ubicado el archivo .key para el certificado SSL ; ser\u00e1 copiado al contenedor de nginx si tanto \u00e9ste como el .crt pueden ser encontrados [ --ssl_crt_path SSL_CRT_PATH ] Path dentro del host donde est\u00e1 ubicado el archivo .crt para el certificado SSL ; ser\u00e1 copiado al contenedor de nginx si tanto \u00e9ste como el .key pueden ser encontrados [ --nginx_port NGINX_PORT ] Puerto del servidor \"Host\" que se desea que se tome para recibir llamadas HTTP. Por defecto es el 80 . [ --nginx_ssl_port NGINX_SSL_PORT ] Puerto del servidor \"Host\" que se desea que se tome para recibir llamadas HTTPS. Por defecto es el 443 . Es importante para los administradores saber que Andino tomar\u00e1 el puerto especificado ( o el default ) ya sea que el portal use o no use HTTPS. En caso de no querer usar HTTPS y que el host tenga erl puerto 443 tomado por un servidor web, es requisito especificar un puerto distinto ( ejemplo: 8443 ) que ser\u00e1 reservado por Andino, pero no utilizado. [ --datastore_port DATASTORE_PORT ] Puerto del servidor \"Host\" que se desea que se tome para recibir llamadas HTTP al \"datastore\" . Por defecto es el 8800 . [ --install_directory INSTALL_DIRECTORY ] Directorio donde se desea instalar la aplicaci\u00f3n. Por defecto es ` /etc/portal ` ( recomendado ) [ --file_size_limit FILE_SIZE_LIMIT ] Configura el l\u00edmite de tama\u00f1o para subida de archivos en recursos. Para esta instalaci\u00f3n de ejemplo, usaremos estos par\u00e1metros para la aplicaci\u00f3n. Para los dem\u00e1s, usaremos los valores por defecto: Email donde se mandar\u00e1n los errores. EMAIL=admin@example.com Dominio o IP de la aplicaci\u00f3n sin el protocolo : HOST=datos.gob.ar Usuario de la base de datos: DB_USER=<my db user> Password de la base de datos: DB_PASS=<my db pass> Usuario del datastore: STORE_USER=<my datastore user> Password del datastore: STORE_PASS=<my datastore password> Nota : Si usamos una IP para la variable HOST , el env\u00edo de mails no funcionar\u00e1. Postfix require un \"fully-qualified domain name (FQDN)\". Ver la documentaci\u00f3n de Postfix para m\u00e1s detalles. Nota 2 : Si se utiliza el nombre 'localhost' para la variable site_host , es posible que ocurra un error al intentar subir un archivo perteneciente a un recurso al Datastore. Para evitar este problema, se debe utilizar un hostname diferente. # Primero especificamos los valores necesarios EMAIL = admin@example.com HOST = andino.midominio.com.ar DB_USER = my_database_user DB_PASS = my_database_pass STORE_USER = my_data_user STORE_PASS = my_data_pass wget https://raw.github.com/datosgobar/portal-andino/master/install/ { install,installation_manager } .py sudo python ./install.py \\ --error_email \" $EMAIL \" \\ --site_host = \" $HOST \" \\ --database_user = \" $DB_USER \" \\ --database_password = \" $DB_PASS \" \\ --datastore_user = \" $STORE_USER \" \\ --datastore_password = \" $STORE_PASS \"","title":"Instalaci\u00f3n simplificada de andino"},{"location":"developers/install/#instalacion-avanzada-de-andino","text":"La instalaci\u00f3n avanzada est\u00e1 pensada para usuarios que quieren ver c\u00f3mo funciona internamente Andino Para instalar y ejecutar Andino, seguiremos estos pasos: Paso 1: Clonar repositorio. sudo mkdir /etc/portal cd /etc/portal sudo git clone https://github.com/datosgobar/portal-andino.git . Paso 2: Especificar las variables de entorno para el contenedor de postgresql. NOTA: Debemos usar un dominio v\u00e1lido para la variable DOMINIO , de otra forma el envio de mails no funcionar\u00e1. Postfix require un \"fully-qualified domain name (FQDN)\". Ver la documentaci\u00f3n de Postfix para m\u00e1s detalles. DB_USER = <my user> DB_PASS = <my pass> DOMINIO = andino.midominio.com.ar ANDINO_VERSION = <version que deseamos instalar> sudo su -c \"echo POSTGRES_USER= $DB_USER > .env\" sudo su -c \"echo POSTGRES_PASSWORD= $DB_PASS >> .env\" sudo su -c \"echo NGINX_HOST_PORT=80 >> .env\" sudo su -c \"echo DATASTORE_HOST_PORT=8800 >> .env\" sudo su -c \"echo maildomain= $DOMINIO >> .env\" sudo su -c \"echo ANDINO_TAG= $ANDINO_VERSION >> .env\" Paso 3: Construir y lanzar los contenedor de servicios usando el archivo latest.yml : docker-compose -f latest.yml up -d db postfix redis solr Paso 4: Construir y lanzar el contenedor de andino usando el archivo latest.yml : docker-compose -f latest.yml up -d portal Paso 5: Inicializar la base de datos y la configuraci\u00f3n de la aplicaci\u00f3n: EMAIL = admin@example.com HOST = datos.gob.ar DB_USER = <my db user> DB_PASS = <my db pass> STORE_USER = <my datastore user> STORE_PASS = <my datastore password> docker-compose -f latest.yml exec portal /etc/ckan_init.d/init.sh -e \" $EMAIL \" -h \" $HOST \" \\ -p \" $DB_USER \" -P \" $DB_PASS \" \\ -d \" $STORE_USER \" -D \" $STORE_PASS \" Paso 8: Construir el contenedor de nginx usando el archivo latest.yml : `docker-compose -f latest.yml up -d nginx","title":"Instalaci\u00f3n avanzada de andino"},{"location":"developers/install/#desinstalar-andino","text":"Esta secuencia de comandos va a ELIMINAR TODOS LOS CONTENEDORES, IM\u00c1GENES y VOLUMENES de la aplicaci\u00f3n de la vm donde est\u00e1 instalada la plataforma. Esta operaci\u00f3n no es reversible. Perder\u00e1s todos tus datos si realizas esta operaci\u00f3n . app_dir = \"/etc/portal/\" cd $app_dir docker-compose -f latest.yml down -v cd ~/ sudo rm $app_dir -r","title":"Desinstalar andino"},{"location":"developers/maintenance/","text":"Mantenimiento Indice Exploraci\u00f3n de la instancia de andino \u00bfQu\u00e9 est\u00e1 corriendo docker? Utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose Ingresar al contendor principal de andino Listar todas las Propiedades de cada contenedor Administraci\u00f3n de usuarios Crear un usuario ADMIN Listar mis usuarios Ver los datos de un usuario Crear un nuevo usuario Crear un nuevo usuario extendido Eliminar un usuario Cambiar password de un usuario Usuario administrador de CKAN Configuraciones de andino Modificar el archivo de configuraci\u00f3n Cambiar la configuraci\u00f3n del SMTP Cambiar el remitente de los correos electr\u00f3nicos que env\u00eda Andino Cambiar el id del container de Google Tag Manager Google Tag Manager Cambiar el id del tag de Google Analytics Indexar datasets con Google Dataset Search Deshabilitar la URL /catalog.xlsx Configuraci\u00f3n de la llamada de invalidaci\u00f3n de cach\u00e9 Cach\u00e9 externa Especificar las licencias a utilizar Configuraci\u00f3n de CORS Configuraci\u00f3n del explorador de series de tiempo Acceso a los datos de andino Encontrar los vol\u00famenes de mi andino dentro del filesystem del host Ver las direcciones IP de mis contenedores Ver las variables de entorno que tienen mis contenedores Acceder con un cliente de PostgreSQL a las bases de datos Eliminar objetos definitivamente Purgar Organizaciones Borradas Purgar Grupos Borrados Purgar Datasets Borrados Listar nombres de los datasets contenidos en Andino Backups Backup de la base de datos Realizar un backup del file system Realizar un backup de la configuraci\u00f3n Comandos de DataPusher Subir todos los recursos al Datastore Seguridad HTTPS Plugin ckanext-security Sistema y librer\u00edas Firewall SSH Optimizaci\u00f3n de logging Configurar otro logging driver Eliminar logs antiguos de Docker Eliminar logs dentro de Andino Exploraci\u00f3n de la instancia de andino \u00bfQu\u00e9 est\u00e1 corriendo docker? Para obtener una lista de lo que est\u00e1 corriendo actualmente Docker, podemos usar el siguiente comando: docker ps # Tabla de ejecucion actual docker ps - q # Listado de IDs de cada contenedor docker ps - aq # Listado de IDs de todos los contenedores disponibles . Utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose En m\u00faltiples secciones de esta documentaci\u00f3n se emplea el uso de comandos que comienzan de la siguiente manera: docker - compose - f latest . yml Es importante recordar que no alcanzar\u00eda con especificar el directorio absoluto del archivo latest.yml ; es necesario ejecutar estos comandos exactamente en ese mismo directorio , debido a que ah\u00ed tambi\u00e9n se encuentra el archivo que contiene las variables de entorno ( .env ) ya que es el directorio de instalaci\u00f3n de Andino. Ingresar al contendor principal de andino El contenedor principal de andino, donde se ejecuta la aplicaci\u00f3n CKAN, es denominado portal . Para ingresar en una sesi\u00f3n de consola en el contenedor, ejecutar: docker - compose - f latest . yml exec portal / bin / bash Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . Listar todas las Propiedades de cada contenedor docker - compose - f latest . yml ps - q portal solr db | xargs - n 1 | while read container ; do docker inspect $container; done Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . Administraci\u00f3n de usuarios Crear un usuario ADMIN docker - compose - f latest . yml exec portal / etc / ckan_init . d / add_admin . sh mi_nuevo_usuario_admin email_del_usuario_admin Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . El comando solicitar\u00e1 la contrase\u00f1a del usuario administrador. Listar mis usuarios docker - compose - f latest . yml exec portal / etc / ckan_init . d / paster . sh -- plugin = ckan user list Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . Ver los datos de un usuario docker - compose - f latest . yml exec portal / etc / ckan_init . d / paster . sh -- plugin = ckan user nombre - de - usuario Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . Crear un nuevo usuario docker - compose - f latest . yml exec portal / etc / ckan_init . d / paster . sh -- plugin = ckan user add nombre - de - usuario Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . Crear un nuevo usuario extendido docker - compose - f latest . yml exec portal / etc / ckan_init . d / paster . sh -- plugin = ckan user add nomber [ email = mi - usuario @ host . com password = mi - contrase \u00f1 a - rara apikey = unsecretomisticonoleible ] Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . Eliminar un usuario docker - compose - f latest . yml exec portal / etc / ckan_init . d / paster . sh -- plugin = ckan user remove nombre - de - usuario Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . Cambiar password de un usuario docker - compose - f latest . yml exec portal / etc / ckan_init . d / paster . sh -- plugin = ckan user setpass nombre - de - usuario Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . Usuario administrador de CKAN Existe un usuario administrador llamado default , el cual es utilizado por la aplicaci\u00f3n para la ejecuci\u00f3n de ciertas funciones que corren de fondo (por ejemplo, la actualizaci\u00f3n de la cach\u00e9 del data.json). Es muy importante que dicho usuario siempre est\u00e9 disponible ya que, en caso de no estarlo, provocar\u00eda un funcionamiento incorrecto en el portal; por lo tanto, se recomienda muy fuertemente no intentar eliminarlo ni desactivarlo. Configuraciones de andino Modificar el archivo de configuraci\u00f3n El archivo de configuraci\u00f3n de andino se llama production.ini , y se lo puede encontrar y modificar de la siguiente manera: # Ingresar al contenedor cd /etc/portal docker-compose -f latest.yml exec portal /bin/bash # Una vez adentro, abrimos el archivo production.ini, y buscamos la secci\u00f3n que necesita ser modificada vim /etc/ckan/default/production.ini # Editamos y, luego de salir del contenedor, lo reiniciamos docker-compose -f latest.yml restart portal nginx Cambiar la configuraci\u00f3n del SMTP Por defecto, andino usar\u00e1 un servidor postfix integrado para el env\u00edo de emails. Para usar un servidor SMTP propio, debemos cambiar la configuraci\u00f3n del archivo production.ini . Para lograrlo, podemos hacerlo de dos formas: 1 ) Ingresando al contenedor. Debemos buscar y editar en el archivo production.ini la configuraci\u00f3n de email que luce como: ## Email settings error_email_from = admin @example . com smtp . server = postfix #smtp . starttls = False smtp . user = portal smtp . password = portal smtp . mail_from = administrador Para saber c\u00f3mo hacerlo, leer la secci\u00f3n que explica c\u00f3mo modificar el archivo de configuraci\u00f3n 2 ) Ejecutando comandos paster Suponiendo que nuestro servidor SMTP est\u00e1 en smtp.gmail.com, la direcci\u00f3n de correo del usuario es smtp_user_mail@gmail.com , la contrase\u00f1a de esa direcci\u00f3n de correo mi_pass y queremos usar \"tls\", podemos ejecutar los siguientes comandos: docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" smtp.server=smtp.gmail.com:587 \" ; docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" smtp.user=smtp_user_mail@gmail.com \" ; docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" smtp.password=mi_pass \" ; docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" smtp.starttls=True \" ; docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" smtp.mail_from=smtp_user_mail@gmail.com \" ; # Finalmente reiniciamos el contenedor docker - compose - f latest . yml restart portal nginx Tener en cuenta que si se utiliza un servidor SMTP, se debe setear la configuraci\u00f3n con un correo electr\u00f3nico de @gmail.com , y que starttls debe estar en True . Cambiar el remitente de los correos electr\u00f3nicos que env\u00eda Andino Para modificar el remitente de los correos electr\u00f3nicos que el sistema env\u00eda (por ejemplo los de creaci\u00f3n de usuarios nuevos o los de olvido de contrase\u00f1a), se deben seguir los pasos de la secci\u00f3n Cambiar la configuraci\u00f3n del SMTP pero modificando el atributo de configuraci\u00f3n smtp.mail_from . Cambiar el id del container de Google Tag Manager Ser\u00e1 necesario modificar la configuraci\u00f3n en el archivo production.ini . Para saber c\u00f3mo hacerlo, leer la secci\u00f3n que explica c\u00f3mo modificar el archivo de configuraci\u00f3n . Esta vez, buscaremos la configuraci\u00f3n debajo de la secci\u00f3n [app:main] (vas a encontrar campos como \"superThemeTaxonomy\" y \"ckan.site.title\"). El campo que estamos buscando es ckan.google_tag_manager.gtm_container_id . En caso de no encontrar el campo mencionado, lo podemos agregar: ckan.google_tag_manager.gtm_container_id = { id que necesit\u00e1s guardar } Google Tag Manager Para configurar el c\u00f3digo se seguimiento de Google Tag Manager ejecutar el siguiente comando: docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" ckan.google_tag_manager.gtm_container_id=<tu c\u00f3digo de seguimiento GTM> \" ; # Finalmente reiniciamos el contenedor docker - compose - f latest . yml restart portal nginx Cambiar el id del tag de Google Analytics Ser\u00e1 necesario modificar el archivo de configuraci\u00f3n production.ini . Para saber c\u00f3mo hacerlo, leer la secci\u00f3n que explica c\u00f3mo modificar el archivo de configuraci\u00f3n . La secci\u00f3n a buscar luce de esta manera: ## Google Analytics googleanalytics . id = { un id } googleanalytics_resource_prefix = { un prefix } googleanalytics . domain = { un dominio } Lo que se debe modificar es el campo googleanalytics.id . Indexar datasets con Google Dataset Search Andino cuenta con la posibilidad de utilizar Google Dataset Search para que \u00e9ste indexe tus datasets. Para el mejor entendimiento de la herramienta, recomendamos que entres a https://search.google.com/search-console/about. Por default, esta configuraci\u00f3n se encuentra desactivada. Para activarla, pod\u00e9s ir a Configuraci\u00f3n -> Configuraci\u00f3n avanzada -> Google Dataset Search -> Clickear el checkbox y guardar el cambio. Deshabilitar la URL /catalog.xlsx En caso de desear deshabilitar la URL /catalog.xlsx , se puede ejecutar el siguiente comando: docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" andino.disable_catalog_xlsx_url=True \" ; En caso de querer restaurarlo, se debe configurar el atributo andino.disable_catalog_xlsx_url con el valor False . Configuraci\u00f3n de la llamada de invalidaci\u00f3n de cach\u00e9 La aplicaci\u00f3n puede ser configurada para hacer una llamada HTTP ante cada cambio en los metadatos del portal. Esta llamada (A.K.A. \"hook\") puede configurarse para ser a cualquier URL, y usando cualquier m\u00e9todo HTTP. Se deber\u00e1 utilizar un campo llamado andino.cache_clean_hook , que tendr\u00e1 asignada la URL a la cual queremos enviarle requests HTTP que lograr\u00e1n ese efecto. Adem\u00e1s, el paquete \"Andino\" provee una configuraci\u00f3n de nginx que permite recibir esta llamada e invalidar la cach\u00e9. Para configurar internamente nginx y andino, s\u00f3lo es necesario parar la opci\u00f3n --nginx-extended-cache al momento de usar el script de instalaci\u00f3n. Si nuestra aplicaci\u00f3n ya est\u00e1 instalada, podemos seguir los siguientes pasos: Actualizar a la ultima versi\u00f3n de la aplicaci\u00f3n, con el script de actualizaci\u00f3n. Ir al directorio de instalaci\u00f3n cd /etc/portal Editar el archivo .env Agregar una l\u00ednea nueva que sea: NGINX_CONFIG_FILE=nginx_extended.conf Reiniciar el contenedor de nginx docker-compose -f latest.yml up -d nginx Luego configuramos el hook de invalidaci\u00f3n: Entramos al contenedor del portal: docker-compose -f latest.yml exec portal bash Configuramos el hook: /etc/ckan_init.d/update_conf.sh andino.cache_clean_hook=http://nginx/meta/cache/purge Salimos exit Reiniciamos el portal: docker-compose -f latest.yml restart portal nginx Nota: tener en cuenta que, por defecto, se emplea el m\u00e9todo PURGE para disparar el hook, lo cual se puede cambiar editando el campo andino.cache_clean_hook_method dentro del archivo de configuraci\u00f3n production.ini . Para saber c\u00f3mo hacerlo, leer la secci\u00f3n que explica c\u00f3mo modificar el archivo de configuraci\u00f3n . Cach\u00e9 externa Es posible implementar la cach\u00e9 externa por fuera del paquete andino. Para esto, en el servidor que servir\u00e1 de cach\u00e9, necesitamos instalar openresty . Esta plataforma web nos permite correr nginx y modificar su comportamiento usando lua . Luego de instalar openresty , debemos activarlo para que empiece cada vez que se prenda el servidor: systemctl enable openresty systemctl restart openresty Luego de instalar operesty , debemos agregar los archivos de configuraci\u00f3n. Primero borramos la configuraci\u00f3n de nginx que viene por defecto en /etc/openresty/nginx.conf y agregamos la nuestra: # user nobody ; worker_processes 1 ; # error_log logs / error . log ; # error_log logs / error . log notice ; # error_log logs / error . log info ; # pid logs / nginx . pid ; events { worker_connections 1024 ; } http { include mime . types ; default_type application / octet - stream ; # log_format main ' $remote_addr - $remote_user [$time_local] \"$request\" ' # ' $status $body_bytes_sent \"$http_referer\" ' # ' \"$http_user_agent\" \"$http_x_forwarded_for\" ' ; # access_log logs / access . log main ; sendfile on ; # tcp_nopush on ; # keepalive_timeout 0 ; keepalive_timeout 65 ; # gzip on ; include / etc / nginx / conf . d /*.conf; } Luego, creamos el directorio donde pondremos la configuraci\u00f3n de nuestra cach\u00e9 y creamos el archivo. mkdir - p / etc / nginx / conf . d / touch / etc / nginx / conf . d / 000 - andino - cache . conf El archivo 000-andino-cache.conf contendr\u00e1 lo siguiente. Es necesario cambiar la palabre IP_A_ANDINO por la IP donde est\u00e1 andino. proxy_cache_path / tmp / nginx_cache / levels = 1 : 2 keys_zone = cache : 30 m max_size = 250 m ; proxy_temp_path / tmp / nginx_proxy 1 2 ; server_tokens off ; server { client_max_body_size 300 M ; location / { proxy_pass http : // IP_A_ANDINO : 80 / ; proxy_set_header X - Forwarded - For $ remote_addr ; proxy_set_header Host $ host ; proxy_cache cache ; # Disable cache for logged - in users proxy_cache_bypass $c ookie_auth_tkt ; proxy_no_cache $c ookie_auth_tkt ; proxy_cache_valid 30 m ; proxy_cache_key $ host $ scheme $ proxy_host $ request_uri ; # Ignore apache \" Cache-Control \" header # See https : // lists . okfn . org / pipermail / ckan - dev / 2016 - March / 009864 . html proxy_ignore_headers Cache - Control ; # In emergency comment out line to force caching # proxy_ignore_headers X - Accel - Expires Expires ; # Show cache status add_header X - Cache - Status $ upstream_cache_status ; } location / meta / cache / purge { allow 192 . 168 . 0 . 0 / 16 ; allow 172 . 16 . 0 . 0 / 12 ; allow 10 . 0 . 0 . 0 / 8 ; allow 127 . 0 . 0 . 1 ; deny all ; if ( $ request_method = PURGE ) { content_by_lua_block { filename = \" /tmp/nginx_cache/ \" local f = io . open ( filename , \" r \" ) if ( f ~= nil ) then io . close ( f ) os . execute ( ' rm -rf \" ' .. filename .. ' \" ' ) end ngx . say ( \" OK \" ) ngx . exit ( ngx . OK ) } } } } Si se est\u00e1 utilizando la configuraci\u00f3n SSL, agregar al final del archivo la siguiente secci\u00f3n, reemplazando _[el texto que aparezca entre corchetes (y \u00e9stos) por el valor adecuado]: server { client_max_body_size 300 M ; listen 443 ssl http2 ; listen [ :: ] : 443 ssl http2 ; server_name [ Tu nombre de dominio ]; ssl_certificate [ Path al certificado ]; ssl_certificate_key [ Path a la llave del certificado ]; ssl_session_cache shared : SSL : 50 m ; ssl_session_timeout 1 d ; ssl_session_tickets off ; ssl_prefer_server_ciphers on ; ssl_protocols TLSv1 TLSv1 .1 TLSv1 .2 ; ssl_ciphers ' ECDHE - ECDSA - CHACHA20 - POLY1305 : ECDHE - RSA - CHACHA20 - POLY1305 : ECDHE - ECDSA - AES128 - GCM - SHA256 : ECDHE - RSA - AES128 - GCM - SHA256 : ECDHE - ECDSA - AES256 - GCM - SHA384 : ECDHE - RSA - AES256 - GCM - SHA384 : DHE - RSA - AES128 - GCM - SHA256 : DHE - RSA - AES256 - GCM - SHA384 : ECDHE - ECDSA - AES128 - SHA256 : ECDHE - RSA - AES128 - SHA256 : ECDHE - ECDSA - AES128 - SHA : ECDHE - RSA - AES256 - SHA384 : ECDHE - RSA - AES128 - SHA : ECDHE - ECDSA - AES256 - SHA384 : ECDHE - ECDSA - AES256 - SHA : ECDHE - RSA - AES256 - SHA : DHE - RSA - AES128 - SHA256 : DHE - RSA - AES128 - SHA : DHE - RSA - AES256 - SHA256 : DHE - RSA - AES256 - SHA : ECDHE - ECDSA - DES - CBC3 - SHA : ECDHE - RSA - DES - CBC3 - SHA : EDH - RSA - DES - CBC3 - SHA : AES128 - GCM - SHA256 : AES256 - GCM - SHA384 : AES128 - SHA256 : AES256 - SHA256 : AES128 - SHA : AES256 - SHA : DES - CBC3 - SHA : ! DSS ' ; resolver 8.8.8.8 8.8.4.4 ; ssl_stapling on ; ssl_stapling_verify on ; ssl_trusted_certificate [ Path al certificado ]; add_header Strict - Transport - Security \"max-age=31536000; includeSubdomains; preload\" ; add_header X - Xss - Protection \"1; mode=block\" always ; add_header X - Content - Type - Options \"nosniff\" always ; add_header X - Frame - Options \"SAMEORIGIN\" always ; proxy_ignore_headers Cache - Control ; location / { proxy_set_header X - Forwarded - For $ proxy_add_x_forwarded_for ; proxy_set_header Host $ http_host ; proxy_set_header X - Forwarded - Protocol https ; proxy_ignore_headers Cache - Control ; add_header X - Xss - Protection \"1; mode=block\" always ; add_header X - Content - Type - Options \"nosniff\" always ; add_header X - Frame - Options \"SAMEORIGIN\" always ; proxy_redirect off ; if ( !- f $ request_filename ) { proxy_pass https : //[Tu URL]:443; break ; } } } Finalmente, reiniciamos openresty : systemctl restart openresty . Ahora que tenemos la cach\u00e9 configurada, necesitamos configurar la llamada, o hook, de invalidaci\u00f3n de cach\u00e9. Para esto, entramos al servidor donde est\u00e1 corriendo andino y corremos: IP_INTERNA_CACHE = <ip interna del servidor de cach\u00e9> cd /etc/portal docker-compose -f latest.yml exec portal /etc/ckan_init.d/update_conf.sh \"andino.cache_clean_hook=http:// $IP_INTERNA_CACHE /meta/cache/purge\" ; docker-compose -f latest.yml restart portal nginx Si queremos probar la integraci\u00f3n, podemos entrar al contenedor de andino y probar invalidar la cach\u00e9: IP_INTERNA_CACHE =< ip interna del servidor de cach \u00e9 > cd / etc / portal docker - compose - f latest . yml exec portal curl - X PURGE \" http://$IP_INTERNA_CACHE/meta/cache/purge \" ; # => OK NOTA: Si estamos usando nuestro andino con un IP y no con un dominio, tendremos que cambiar la configuraci\u00f3n ckan.site_url para que use la IP del servidor donde se encuentra la cach\u00e9 externa. IP_PUBLICA_CACHE = <ip publica del servidor cach\u00e9> cd /etc/portal docker-compose -f latest.yml exec portal /etc/ckan_init.d/update_conf.sh \"ckan.site_url=http:// $IP_PUBLICA_CACHE \" ; docker-compose -f latest.yml restart portal nginx Especificar las licencias a utilizar Existe un JSON que contiene las licencias a utilizar en el portal, y cuyo path es /var/lib/ckan/theme_config/licenses.json . Este archivo est\u00e1 especificado en el campo licenses_group_url del archivo de configuraci\u00f3n. Es posible cambiarlo para lograr utilizar un archivo distinto; para ello, hay que cambiar el path por el deseado, teniendo en cuenta las siguientes indicaciones: * Para utilizar un path de un archivo existente en el container, el mismo debe comenzar con el texto file:// , tal y como ocurre con el path utilizado por default. * Para utilizar una URL, debe comenzar con http:// o https:// . Configuraci\u00f3n de CORS Cuando es necesario acceder a Andino desde URLs distintas que apuntan a una misma instancia (ej: accediendo a trav\u00e9s de un gateway/cach\u00e9 o directamente a la instancia de Andino o usando la IP p\u00fablica del servidor host ) es necesario, para el correcto funcionamiento de Andino, configurar par\u00e1metros para habilitar CORS ( Cross-Origin Resource Sharing ). Esto se debe a que un Andino debe tener una URL can\u00f3nica, por lo tanto, las dem\u00e1s URLs utilizadas deben estar en el whitelist de CORS de Andino. Para poder navegar tu Andino usando como URL una que no es la can\u00f3nica de tu instancia, ten\u00e9s que realizar dos acciones (los comandos deben ser ejecutados desde el directorio de instalaci\u00f3n de Andino; por default , /etc/portal ): Habilitar el comportamiento CORS: docker-compose -f latest.yml exec portal /etc/ckan_init.d/update_conf.sh \"ckan.cors.origin_allow_all = false\" (si bien el par\u00e1metro de configuraci\u00f3n tiene el valor false , esto habilita el control de URLs contra el whitelist ). Agregar las URLs al whitelist : docker-compose -f latest.yml exec portal /etc/ckan_init.d/update_conf.sh \"ckan.cors.origin_whitelist=http://localhost:8080 http://127.0.0.1 http://127.0.0.1:8080\" (en el ejemplo se habilitan las URLs http://localhost:8080 , http://127.0.0.1 y http://127.0.0.1:8080 ). Luego reinici\u00e1 los contenedores portal y nginx : docker-compose -f latest.yml restart nginx portal . Ten\u00e9 en cuenta que el script va a reemplazar las URLs existentes en el campo por lo que le pases por par\u00e1metro. Si hay URLs que quer\u00e9s mantener en la configuraci\u00f3n, buscalas con el siguiente comando y especificalas junto a las nuevas: docker-compose -f latest.yml exec portal bash -c 'grep \"ckan.cors.origin_whitelist\" /etc/ckan/default/production.ini' . Si dese\u00e1s habilitar todas las URLs para CORS (no recomendado por cuestiones de seguridad), en el paso 1 deb\u00e9s pasar el valor true para el atributo de configuraci\u00f3n ckan.cors.origin_allow_all e ignorar el paso 2. Para ver m\u00e1s acerca del funcionamiento de CORS en CKAN ver la documentaci\u00f3n oficial de CKAN (en ingl\u00e9s) . Configuraci\u00f3n del explorador de series de tiempo Andino tiene instalado el plugin ckanext-seriestiempoarexplorer , pero no se encuentra presente entre los plugins activos. Para activarlo, debemos entrar al contenedor de andino, editar el archivo /etc/ckan/default/production.ini y agregar el seriestiempoarexplorer a la lista de plugins. Luego de agregarlo, debemos reinicar el servidor. cd / etc / portal docker - compose - f latest . yml exec portal bash ; vim / etc / ckan / default / production . ini # ... apachectl restart Luego, si vamos a la configuraci\u00f3n del sitio, podremos apreciar que se agrego una nueva secci\u00f3n \"Series\" en el apartado \"Otras secciones del portal\". Acceso a los datos de andino Encontrar los vol\u00famenes de mi andino dentro del filesystem del host docker - compose - f latest . yml ps - q andino solr db | xargs - n 1 | while read container ; do docker inspect -f ' {{.Name}}: {{range .Mounts}}{{.Source}}: {{.Destination}} {{end}} ' $container; done Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . Ver las direcciones IP de mis contenedores docker - compose - f latest . yml ps - q andino solr db | xargs - n 1 | while read container ; do docker inspect -f '{{.Name}}: {{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' $container; done Ver las variables de entorno que tienen mis contenedores docker - compose - f latest . yml ps - q andino solr db | xargs - n 1 | while read container ; do docker inspect -f '{{range $index, $value := .Config.Env}}export {{$value}}{{println}}{{end}}' $container; done Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . Acceder con un cliente de PostgreSQL a las bases de datos docker - compose - f dev . yml exec db psql - U postgres # psql \\ c ckan db default CKAN # psql \\ c datastore_default db datastore CKAN Eliminar objetos definitivamente Es bien sabido que, dentro de CKAN, cada vez que borranmos algun elemento, en verdad no se borra, sino que pasa a estar inactivo; por lo tanto, tener alguna forma de eliminar elementos de manera definitiva resulta altamente necesario. Purgar Organizaciones Borradas curl - X POST http : // tu - host / api / 3 / action / organization_purge - H \"Authorization:tu-api-key\" - F id = id - o - nombre - que - se - desea - borrar Purgar Grupos Borrados curl - X POST http : // tu - host / api / 3 / action / group_purge - H \"Authorization:tu-api-key\" - F id = id - o - nombre - que - se - desea - borrar Purgar Datasets Borrados curl - X POST http : // tu - host / api / 3 / action / dataset_purge - H \"Authorization:tu-api-key\" - F id = id - o - nombre - que - se - desea - borrar Listar nombres de los datasets contenidos en Andino docker-compose -f latest.yml exec portal /etc/ckan_init.d/paster.sh --plugin = ckan dataset list | grep -v DEBUG | grep -v count | grep -v Datasets | xargs -n2 | while read id name ; do echo $name ; done Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . Backups Es altamente recomendable hacer copias de seguridad de los datos de la aplicaci\u00f3n, tanto la base de datos como los archivos de configuraci\u00f3n y subidos por los usuarios. Backup de la base de datos Un ejemplo f\u00e1cil de hacer un backup de la base de datos ser\u00eda: container = $ ( docker - compose - f latest . yml ps - q db ) today = ` date +% Y -% m -% d . % H : % M : % S ` filename = \" backup-$today.gz \" # Creo un directorio temporal y defino d \u00f3 nde generar \u00e9 el backup backupdir = $ ( mktemp - d ) backupfile = \" $backupdir/$filename \" # Exporto la base de datos docker exec $c ontainer pg_dumpall - c - U postgres | gzip > \" $backupfile \" # Copio el archivo al directorio actual y borro el original # Podr \u00ed a reemplazar $ PWD con mi directorio de backups , como / etc / portal / backups mv \" $backupfile \" $ PWD Y para los dem\u00e1s archivos de la aplicaci\u00f3n (requiere jq ): backupdir = $ ( mktemp - d ) today = ` date +% Y -% m -% d . % H : % M : % S ` appbackupdir = \" $backupdir/application/ \" mkdir $a ppbackupdir container = $ ( docker - compose - f latest . yml ps - q portal ) docker inspect -- format ' {{json .Mounts}} ' $c ontainer | jq - r ' .[]|[.Name, .Source, .Destination] | @tsv ' | while IFS = $ ' \\t ' read - r name source destination ; do if ls $ source /* 1> /dev/null 2>&1; then dest=\"$appbackupdir$name\" mkdir -p $dest tar -C \"$source\" -zcvf \"$dest/backup_$today.tar.gz\" $(ls $source) else echo \"No file at $source\" fi done tar -C \"$appbackupdir../\" -zcvf backup.tar.gz \"application/\" Podria colocarse esos scripts en el directorio donde se instal\u00f3 la aplicaci\u00f3n (ejemplo : /etc/portal/backup.sh ) y luego agregar un cron : Para correr el script cada domingo, podr\u00edamos usar la configuraci\u00f3n 0 0 * * 0 (ver cron para m\u00e1s informaci\u00f3n), correr el comando crontab -e y agregar la l\u00ednea: 0 0 * * 0 cd / etc / portal / && bash / etc / portal / backup . sh Realizar un backup del file system # Exporto el path al almacenamiento del volumen export CKAN_FS_STORAGE = $ ( docker inspect -- format ' {{ range .Mounts }}{{ if eq .Destination \"/var/lib/ckan\" }}{{ .Source }}{{ end }}{{ end }} ' andino ) # Creo un tar . gz con la info . tar - C \" $(dirname \" $C KAN_FS_STORAGE \" ) \" - zcvf / ruta / para / guardar / mis / bkps / mi_andino . fs - data_ $ ( date +% F ) . tar . gz \" $(basename \" $C KAN_FS_STORAGE \" ) \" Realizar un backup de la configuraci\u00f3n # Exporto el path al almacenamiento del volumen export ANDINO_CONFIG = $ ( docker inspect -- format ' {{ range .Mounts }}{{ if eq .Destination \"/etc/ckan/default\" }}{{ .Source }}{{ end }}{{ end }} ' andino ) # Creo un tar . gz con la info . tar - C \" $(dirname \" $A NDINO_CONFIG \" ) \" - zcvf / ruta / para / guardar / mis / bkps / mi_andino . config - data_ $ ( date +% F ) . tar . gz \" $(basename \" $A NDINO_CONFIG \" ) \" Comandos de DataPusher Deben ser corridos en el directorio de instalaci\u00f3n de Andino. Subir todos los recursos al Datastore Es posible que existan recursos que no hayan sido subidos al Datastore. Para buscar e intentar subir dichos recursos, ejecutar: docker - compose - f latest . yml exec portal / usr / lib / ckan / default / bin / paster -- plugin = ckan datapusher submit_all - c / etc / ckan / default / production . ini Se preguntar\u00e1 si se desea proceder. Al escribir que s\u00ed ( y ), iniciar la subida de recursos. Para cada uno de ellos, se escribir\u00e1 su id y luego el status: si subi\u00f3 correctamente, aparecer\u00e1 \" OK \"; en caso contrario, \" FAIL \". Seguridad Mantener seguro un servidor web puede ser una tarea ardua, pero sobre todo es constante , ya que constantemente se detectan nuevas vulnerabilidades en los distintos softwares. Y un servidor web no es la excepci\u00f3n! En este breve apartado, se dar\u00e1n peque\u00f1as recomendaciones para mantener seguro el servidor, no solo antes posibles atacantes, sino tambien ante posibles fallos del sistema y como efectuar mitigaciones. Las siguientes recomendaciones puden ser implementadas f\u00e1cilmente en un sistema Ubuntu 16.04, el cual es el recomendado (a la fecha), para correr la aplicaci\u00f3n. HTTPS HTTPS permite que la conexi\u00f3n entre el browser y el servidor sea encriptada y de esta manera segura. Es altamente recomendable usar HTTPS, para mantener la privacidad de los usuarios. El portal de documentaci\u00f3n para desarrolladores de Google provee buena informaci\u00f3n sobre esto: https://developers.google.com/web/fundamentals/security/encrypt-in-transit/why-https Plugin ckanext-security Para las versiones 2.5.7 en adelante, existe un plugin para mejorar la seguridad de CKAN que se puede encontrar en github . Para su utilizaci\u00f3n, es necesario el uso de certificados SSL, ya sea en Andino mismo (teniendo https en el campo site_url de la configuraci\u00f3n del portal) o mediante un reverse proxy. Para este plugin existen dos scripts, los cuales se pueden encontrar en el directorio /etc/ckan_init.d/security dentro del contenedor de Andino; uno para activarlo ( enable_ckanext_security.sh ) y otro para desactivarlo ( disable_ckanext_security.sh ). S\u00f3lo se necesita ejecutar el que se necesite y reiniciar apache. Sistema y librer\u00edas Es altamente recomendable mantener el sistema operativo y las aplicaciones que usemos actualizadas. Constantemente se est\u00e1n subiendo fixes de seguridad y posibles intrusos podr\u00edan aprovechar que las aplicaciones o el mismo sistema operativo est\u00e9n desactualizados. Peri\u00f3dicamente, podr\u00edamos constatar las nuevas versiones de nuestro software y actualizar dentro de lo posible. Como ejemplo, podemos ver que para Ubuntu 16.04 sali\u00f3 Ubuntu 16.04.2, con algunas correcciones de seguridad. Ver . Firewall Todo servidor debe tener activado el firewall. El firewall permitir\u00e1 denegar (o permitr) el acceso a la red. En un servidor web, el puerto abierto al p\u00fablico deber\u00edan ser s\u00f3lo el 80 (http) y el 443 (https). Adem\u00e1s de ese puerto, si la m\u00e1quina es accedida remotamente mediante un servidor SSH, deber\u00edamos abrir este puerto tambi\u00e9n, pero con un l\u00edmite de acceso. La soluci\u00f3n es f\u00e1cilmente implementable con el programa ufw . SSH Los servidores ssh permiten el acceso al servidor remotamente. No debe permitirse el acceso por ssh mediante usuario y password . S\u00f3lo debe permitirse el acceso mediante clave publica. DigitalOcean tiene una buena gu\u00eda de c\u00f3mo configurar las claves p\u00fablicas Ver . Optimizaci\u00f3n de logging Configurar otro logging driver Por default, docker escribe a un archivo con formato json , lo cual puede llevar a que se acumulen los logs de la aplicaci\u00f3n, y estos archivos crezcan indefinidamente. Para evitar esto, se puede configurar el logging driver de docker. La recomendacion es usar journald y configurarlo para que los logs sean persistentes. Eliminar logs antiguos de Docker Dentro del normal funcionamiento de la plataforma, se genera una gran cantidad de logs, los cuales, ante un incidencia, son sumamente \u00fatiles. Pero, luego de un tiempo, y sabiendo que los mismos se almacenan internamente en Andino, podr\u00eda ser necesario eliminarlos. sudo su - c \" ls /var/lib/docker/containers/ | xargs -n1 | while read docker_id; do truncate -s 0 /var/lib/docker/containers/${docker_id%/*}/${docker_id%/*}-json.log; done \" Eliminar logs dentro de Andino docker - compose - f latest . yml exec portal truncate - s 0 / var / log / apache2 /*.log Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Mantenimiento"},{"location":"developers/maintenance/#mantenimiento","text":"","title":"Mantenimiento"},{"location":"developers/maintenance/#indice","text":"Exploraci\u00f3n de la instancia de andino \u00bfQu\u00e9 est\u00e1 corriendo docker? Utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose Ingresar al contendor principal de andino Listar todas las Propiedades de cada contenedor Administraci\u00f3n de usuarios Crear un usuario ADMIN Listar mis usuarios Ver los datos de un usuario Crear un nuevo usuario Crear un nuevo usuario extendido Eliminar un usuario Cambiar password de un usuario Usuario administrador de CKAN Configuraciones de andino Modificar el archivo de configuraci\u00f3n Cambiar la configuraci\u00f3n del SMTP Cambiar el remitente de los correos electr\u00f3nicos que env\u00eda Andino Cambiar el id del container de Google Tag Manager Google Tag Manager Cambiar el id del tag de Google Analytics Indexar datasets con Google Dataset Search Deshabilitar la URL /catalog.xlsx Configuraci\u00f3n de la llamada de invalidaci\u00f3n de cach\u00e9 Cach\u00e9 externa Especificar las licencias a utilizar Configuraci\u00f3n de CORS Configuraci\u00f3n del explorador de series de tiempo Acceso a los datos de andino Encontrar los vol\u00famenes de mi andino dentro del filesystem del host Ver las direcciones IP de mis contenedores Ver las variables de entorno que tienen mis contenedores Acceder con un cliente de PostgreSQL a las bases de datos Eliminar objetos definitivamente Purgar Organizaciones Borradas Purgar Grupos Borrados Purgar Datasets Borrados Listar nombres de los datasets contenidos en Andino Backups Backup de la base de datos Realizar un backup del file system Realizar un backup de la configuraci\u00f3n Comandos de DataPusher Subir todos los recursos al Datastore Seguridad HTTPS Plugin ckanext-security Sistema y librer\u00edas Firewall SSH Optimizaci\u00f3n de logging Configurar otro logging driver Eliminar logs antiguos de Docker Eliminar logs dentro de Andino","title":"Indice"},{"location":"developers/maintenance/#exploracion-de-la-instancia-de-andino","text":"","title":"Exploraci\u00f3n de la instancia de andino"},{"location":"developers/maintenance/#que-esta-corriendo-docker","text":"Para obtener una lista de lo que est\u00e1 corriendo actualmente Docker, podemos usar el siguiente comando: docker ps # Tabla de ejecucion actual docker ps - q # Listado de IDs de cada contenedor docker ps - aq # Listado de IDs de todos los contenedores disponibles .","title":"\u00bfQu\u00e9 est\u00e1 corriendo docker?"},{"location":"developers/maintenance/#utilizacion-del-archivo-latestyml-en-los-comandos-de-docker-compose","text":"En m\u00faltiples secciones de esta documentaci\u00f3n se emplea el uso de comandos que comienzan de la siguiente manera: docker - compose - f latest . yml Es importante recordar que no alcanzar\u00eda con especificar el directorio absoluto del archivo latest.yml ; es necesario ejecutar estos comandos exactamente en ese mismo directorio , debido a que ah\u00ed tambi\u00e9n se encuentra el archivo que contiene las variables de entorno ( .env ) ya que es el directorio de instalaci\u00f3n de Andino.","title":"Utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose"},{"location":"developers/maintenance/#ingresar-al-contendor-principal-de-andino","text":"El contenedor principal de andino, donde se ejecuta la aplicaci\u00f3n CKAN, es denominado portal . Para ingresar en una sesi\u00f3n de consola en el contenedor, ejecutar: docker - compose - f latest . yml exec portal / bin / bash Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Ingresar al contendor principal de andino"},{"location":"developers/maintenance/#listar-todas-las-propiedades-de-cada-contenedor","text":"docker - compose - f latest . yml ps - q portal solr db | xargs - n 1 | while read container ; do docker inspect $container; done Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Listar todas las Propiedades de cada contenedor"},{"location":"developers/maintenance/#administracion-de-usuarios","text":"","title":"Administraci\u00f3n de usuarios"},{"location":"developers/maintenance/#crear-un-usuario-admin","text":"docker - compose - f latest . yml exec portal / etc / ckan_init . d / add_admin . sh mi_nuevo_usuario_admin email_del_usuario_admin Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose . El comando solicitar\u00e1 la contrase\u00f1a del usuario administrador.","title":"Crear un usuario ADMIN"},{"location":"developers/maintenance/#listar-mis-usuarios","text":"docker - compose - f latest . yml exec portal / etc / ckan_init . d / paster . sh -- plugin = ckan user list Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Listar mis usuarios"},{"location":"developers/maintenance/#ver-los-datos-de-un-usuario","text":"docker - compose - f latest . yml exec portal / etc / ckan_init . d / paster . sh -- plugin = ckan user nombre - de - usuario Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Ver los datos de un usuario"},{"location":"developers/maintenance/#crear-un-nuevo-usuario","text":"docker - compose - f latest . yml exec portal / etc / ckan_init . d / paster . sh -- plugin = ckan user add nombre - de - usuario Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Crear un nuevo usuario"},{"location":"developers/maintenance/#crear-un-nuevo-usuario-extendido","text":"docker - compose - f latest . yml exec portal / etc / ckan_init . d / paster . sh -- plugin = ckan user add nomber [ email = mi - usuario @ host . com password = mi - contrase \u00f1 a - rara apikey = unsecretomisticonoleible ] Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Crear un nuevo usuario extendido"},{"location":"developers/maintenance/#eliminar-un-usuario","text":"docker - compose - f latest . yml exec portal / etc / ckan_init . d / paster . sh -- plugin = ckan user remove nombre - de - usuario Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Eliminar un usuario"},{"location":"developers/maintenance/#cambiar-password-de-un-usuario","text":"docker - compose - f latest . yml exec portal / etc / ckan_init . d / paster . sh -- plugin = ckan user setpass nombre - de - usuario Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Cambiar password de un usuario"},{"location":"developers/maintenance/#usuario-administrador-de-ckan","text":"Existe un usuario administrador llamado default , el cual es utilizado por la aplicaci\u00f3n para la ejecuci\u00f3n de ciertas funciones que corren de fondo (por ejemplo, la actualizaci\u00f3n de la cach\u00e9 del data.json). Es muy importante que dicho usuario siempre est\u00e9 disponible ya que, en caso de no estarlo, provocar\u00eda un funcionamiento incorrecto en el portal; por lo tanto, se recomienda muy fuertemente no intentar eliminarlo ni desactivarlo.","title":"Usuario administrador de CKAN"},{"location":"developers/maintenance/#configuraciones-de-andino","text":"","title":"Configuraciones de andino"},{"location":"developers/maintenance/#modificar-el-archivo-de-configuracion","text":"El archivo de configuraci\u00f3n de andino se llama production.ini , y se lo puede encontrar y modificar de la siguiente manera: # Ingresar al contenedor cd /etc/portal docker-compose -f latest.yml exec portal /bin/bash # Una vez adentro, abrimos el archivo production.ini, y buscamos la secci\u00f3n que necesita ser modificada vim /etc/ckan/default/production.ini # Editamos y, luego de salir del contenedor, lo reiniciamos docker-compose -f latest.yml restart portal nginx","title":"Modificar el archivo de configuraci\u00f3n"},{"location":"developers/maintenance/#cambiar-la-configuracion-del-smtp","text":"Por defecto, andino usar\u00e1 un servidor postfix integrado para el env\u00edo de emails. Para usar un servidor SMTP propio, debemos cambiar la configuraci\u00f3n del archivo production.ini . Para lograrlo, podemos hacerlo de dos formas: 1 ) Ingresando al contenedor. Debemos buscar y editar en el archivo production.ini la configuraci\u00f3n de email que luce como: ## Email settings error_email_from = admin @example . com smtp . server = postfix #smtp . starttls = False smtp . user = portal smtp . password = portal smtp . mail_from = administrador Para saber c\u00f3mo hacerlo, leer la secci\u00f3n que explica c\u00f3mo modificar el archivo de configuraci\u00f3n 2 ) Ejecutando comandos paster Suponiendo que nuestro servidor SMTP est\u00e1 en smtp.gmail.com, la direcci\u00f3n de correo del usuario es smtp_user_mail@gmail.com , la contrase\u00f1a de esa direcci\u00f3n de correo mi_pass y queremos usar \"tls\", podemos ejecutar los siguientes comandos: docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" smtp.server=smtp.gmail.com:587 \" ; docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" smtp.user=smtp_user_mail@gmail.com \" ; docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" smtp.password=mi_pass \" ; docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" smtp.starttls=True \" ; docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" smtp.mail_from=smtp_user_mail@gmail.com \" ; # Finalmente reiniciamos el contenedor docker - compose - f latest . yml restart portal nginx Tener en cuenta que si se utiliza un servidor SMTP, se debe setear la configuraci\u00f3n con un correo electr\u00f3nico de @gmail.com , y que starttls debe estar en True .","title":"Cambiar la configuraci\u00f3n del SMTP"},{"location":"developers/maintenance/#cambiar-el-remitente-de-los-correos-electronicos-que-envia-andino","text":"Para modificar el remitente de los correos electr\u00f3nicos que el sistema env\u00eda (por ejemplo los de creaci\u00f3n de usuarios nuevos o los de olvido de contrase\u00f1a), se deben seguir los pasos de la secci\u00f3n Cambiar la configuraci\u00f3n del SMTP pero modificando el atributo de configuraci\u00f3n smtp.mail_from .","title":"Cambiar el remitente de los correos electr\u00f3nicos que env\u00eda Andino"},{"location":"developers/maintenance/#cambiar-el-id-del-container-de-google-tag-manager","text":"Ser\u00e1 necesario modificar la configuraci\u00f3n en el archivo production.ini . Para saber c\u00f3mo hacerlo, leer la secci\u00f3n que explica c\u00f3mo modificar el archivo de configuraci\u00f3n . Esta vez, buscaremos la configuraci\u00f3n debajo de la secci\u00f3n [app:main] (vas a encontrar campos como \"superThemeTaxonomy\" y \"ckan.site.title\"). El campo que estamos buscando es ckan.google_tag_manager.gtm_container_id . En caso de no encontrar el campo mencionado, lo podemos agregar: ckan.google_tag_manager.gtm_container_id = { id que necesit\u00e1s guardar }","title":"Cambiar el id del container de Google Tag Manager"},{"location":"developers/maintenance/#google-tag-manager","text":"Para configurar el c\u00f3digo se seguimiento de Google Tag Manager ejecutar el siguiente comando: docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" ckan.google_tag_manager.gtm_container_id=<tu c\u00f3digo de seguimiento GTM> \" ; # Finalmente reiniciamos el contenedor docker - compose - f latest . yml restart portal nginx","title":"Google Tag Manager"},{"location":"developers/maintenance/#cambiar-el-id-del-tag-de-google-analytics","text":"Ser\u00e1 necesario modificar el archivo de configuraci\u00f3n production.ini . Para saber c\u00f3mo hacerlo, leer la secci\u00f3n que explica c\u00f3mo modificar el archivo de configuraci\u00f3n . La secci\u00f3n a buscar luce de esta manera: ## Google Analytics googleanalytics . id = { un id } googleanalytics_resource_prefix = { un prefix } googleanalytics . domain = { un dominio } Lo que se debe modificar es el campo googleanalytics.id .","title":"Cambiar el id del tag de Google Analytics"},{"location":"developers/maintenance/#indexar-datasets-con-google-dataset-search","text":"Andino cuenta con la posibilidad de utilizar Google Dataset Search para que \u00e9ste indexe tus datasets. Para el mejor entendimiento de la herramienta, recomendamos que entres a https://search.google.com/search-console/about. Por default, esta configuraci\u00f3n se encuentra desactivada. Para activarla, pod\u00e9s ir a Configuraci\u00f3n -> Configuraci\u00f3n avanzada -> Google Dataset Search -> Clickear el checkbox y guardar el cambio.","title":"Indexar datasets con Google Dataset Search"},{"location":"developers/maintenance/#deshabilitar-la-url-catalogxlsx","text":"En caso de desear deshabilitar la URL /catalog.xlsx , se puede ejecutar el siguiente comando: docker - compose - f latest . yml exec portal / etc / ckan_init . d / update_conf . sh \" andino.disable_catalog_xlsx_url=True \" ; En caso de querer restaurarlo, se debe configurar el atributo andino.disable_catalog_xlsx_url con el valor False .","title":"Deshabilitar la URL /catalog.xlsx"},{"location":"developers/maintenance/#configuracion-de-la-llamada-de-invalidacion-de-cache","text":"La aplicaci\u00f3n puede ser configurada para hacer una llamada HTTP ante cada cambio en los metadatos del portal. Esta llamada (A.K.A. \"hook\") puede configurarse para ser a cualquier URL, y usando cualquier m\u00e9todo HTTP. Se deber\u00e1 utilizar un campo llamado andino.cache_clean_hook , que tendr\u00e1 asignada la URL a la cual queremos enviarle requests HTTP que lograr\u00e1n ese efecto. Adem\u00e1s, el paquete \"Andino\" provee una configuraci\u00f3n de nginx que permite recibir esta llamada e invalidar la cach\u00e9. Para configurar internamente nginx y andino, s\u00f3lo es necesario parar la opci\u00f3n --nginx-extended-cache al momento de usar el script de instalaci\u00f3n. Si nuestra aplicaci\u00f3n ya est\u00e1 instalada, podemos seguir los siguientes pasos: Actualizar a la ultima versi\u00f3n de la aplicaci\u00f3n, con el script de actualizaci\u00f3n. Ir al directorio de instalaci\u00f3n cd /etc/portal Editar el archivo .env Agregar una l\u00ednea nueva que sea: NGINX_CONFIG_FILE=nginx_extended.conf Reiniciar el contenedor de nginx docker-compose -f latest.yml up -d nginx Luego configuramos el hook de invalidaci\u00f3n: Entramos al contenedor del portal: docker-compose -f latest.yml exec portal bash Configuramos el hook: /etc/ckan_init.d/update_conf.sh andino.cache_clean_hook=http://nginx/meta/cache/purge Salimos exit Reiniciamos el portal: docker-compose -f latest.yml restart portal nginx Nota: tener en cuenta que, por defecto, se emplea el m\u00e9todo PURGE para disparar el hook, lo cual se puede cambiar editando el campo andino.cache_clean_hook_method dentro del archivo de configuraci\u00f3n production.ini . Para saber c\u00f3mo hacerlo, leer la secci\u00f3n que explica c\u00f3mo modificar el archivo de configuraci\u00f3n .","title":"Configuraci\u00f3n de la llamada de invalidaci\u00f3n de cach\u00e9"},{"location":"developers/maintenance/#cache-externa","text":"Es posible implementar la cach\u00e9 externa por fuera del paquete andino. Para esto, en el servidor que servir\u00e1 de cach\u00e9, necesitamos instalar openresty . Esta plataforma web nos permite correr nginx y modificar su comportamiento usando lua . Luego de instalar openresty , debemos activarlo para que empiece cada vez que se prenda el servidor: systemctl enable openresty systemctl restart openresty Luego de instalar operesty , debemos agregar los archivos de configuraci\u00f3n. Primero borramos la configuraci\u00f3n de nginx que viene por defecto en /etc/openresty/nginx.conf y agregamos la nuestra: # user nobody ; worker_processes 1 ; # error_log logs / error . log ; # error_log logs / error . log notice ; # error_log logs / error . log info ; # pid logs / nginx . pid ; events { worker_connections 1024 ; } http { include mime . types ; default_type application / octet - stream ; # log_format main ' $remote_addr - $remote_user [$time_local] \"$request\" ' # ' $status $body_bytes_sent \"$http_referer\" ' # ' \"$http_user_agent\" \"$http_x_forwarded_for\" ' ; # access_log logs / access . log main ; sendfile on ; # tcp_nopush on ; # keepalive_timeout 0 ; keepalive_timeout 65 ; # gzip on ; include / etc / nginx / conf . d /*.conf; } Luego, creamos el directorio donde pondremos la configuraci\u00f3n de nuestra cach\u00e9 y creamos el archivo. mkdir - p / etc / nginx / conf . d / touch / etc / nginx / conf . d / 000 - andino - cache . conf El archivo 000-andino-cache.conf contendr\u00e1 lo siguiente. Es necesario cambiar la palabre IP_A_ANDINO por la IP donde est\u00e1 andino. proxy_cache_path / tmp / nginx_cache / levels = 1 : 2 keys_zone = cache : 30 m max_size = 250 m ; proxy_temp_path / tmp / nginx_proxy 1 2 ; server_tokens off ; server { client_max_body_size 300 M ; location / { proxy_pass http : // IP_A_ANDINO : 80 / ; proxy_set_header X - Forwarded - For $ remote_addr ; proxy_set_header Host $ host ; proxy_cache cache ; # Disable cache for logged - in users proxy_cache_bypass $c ookie_auth_tkt ; proxy_no_cache $c ookie_auth_tkt ; proxy_cache_valid 30 m ; proxy_cache_key $ host $ scheme $ proxy_host $ request_uri ; # Ignore apache \" Cache-Control \" header # See https : // lists . okfn . org / pipermail / ckan - dev / 2016 - March / 009864 . html proxy_ignore_headers Cache - Control ; # In emergency comment out line to force caching # proxy_ignore_headers X - Accel - Expires Expires ; # Show cache status add_header X - Cache - Status $ upstream_cache_status ; } location / meta / cache / purge { allow 192 . 168 . 0 . 0 / 16 ; allow 172 . 16 . 0 . 0 / 12 ; allow 10 . 0 . 0 . 0 / 8 ; allow 127 . 0 . 0 . 1 ; deny all ; if ( $ request_method = PURGE ) { content_by_lua_block { filename = \" /tmp/nginx_cache/ \" local f = io . open ( filename , \" r \" ) if ( f ~= nil ) then io . close ( f ) os . execute ( ' rm -rf \" ' .. filename .. ' \" ' ) end ngx . say ( \" OK \" ) ngx . exit ( ngx . OK ) } } } } Si se est\u00e1 utilizando la configuraci\u00f3n SSL, agregar al final del archivo la siguiente secci\u00f3n, reemplazando _[el texto que aparezca entre corchetes (y \u00e9stos) por el valor adecuado]: server { client_max_body_size 300 M ; listen 443 ssl http2 ; listen [ :: ] : 443 ssl http2 ; server_name [ Tu nombre de dominio ]; ssl_certificate [ Path al certificado ]; ssl_certificate_key [ Path a la llave del certificado ]; ssl_session_cache shared : SSL : 50 m ; ssl_session_timeout 1 d ; ssl_session_tickets off ; ssl_prefer_server_ciphers on ; ssl_protocols TLSv1 TLSv1 .1 TLSv1 .2 ; ssl_ciphers ' ECDHE - ECDSA - CHACHA20 - POLY1305 : ECDHE - RSA - CHACHA20 - POLY1305 : ECDHE - ECDSA - AES128 - GCM - SHA256 : ECDHE - RSA - AES128 - GCM - SHA256 : ECDHE - ECDSA - AES256 - GCM - SHA384 : ECDHE - RSA - AES256 - GCM - SHA384 : DHE - RSA - AES128 - GCM - SHA256 : DHE - RSA - AES256 - GCM - SHA384 : ECDHE - ECDSA - AES128 - SHA256 : ECDHE - RSA - AES128 - SHA256 : ECDHE - ECDSA - AES128 - SHA : ECDHE - RSA - AES256 - SHA384 : ECDHE - RSA - AES128 - SHA : ECDHE - ECDSA - AES256 - SHA384 : ECDHE - ECDSA - AES256 - SHA : ECDHE - RSA - AES256 - SHA : DHE - RSA - AES128 - SHA256 : DHE - RSA - AES128 - SHA : DHE - RSA - AES256 - SHA256 : DHE - RSA - AES256 - SHA : ECDHE - ECDSA - DES - CBC3 - SHA : ECDHE - RSA - DES - CBC3 - SHA : EDH - RSA - DES - CBC3 - SHA : AES128 - GCM - SHA256 : AES256 - GCM - SHA384 : AES128 - SHA256 : AES256 - SHA256 : AES128 - SHA : AES256 - SHA : DES - CBC3 - SHA : ! DSS ' ; resolver 8.8.8.8 8.8.4.4 ; ssl_stapling on ; ssl_stapling_verify on ; ssl_trusted_certificate [ Path al certificado ]; add_header Strict - Transport - Security \"max-age=31536000; includeSubdomains; preload\" ; add_header X - Xss - Protection \"1; mode=block\" always ; add_header X - Content - Type - Options \"nosniff\" always ; add_header X - Frame - Options \"SAMEORIGIN\" always ; proxy_ignore_headers Cache - Control ; location / { proxy_set_header X - Forwarded - For $ proxy_add_x_forwarded_for ; proxy_set_header Host $ http_host ; proxy_set_header X - Forwarded - Protocol https ; proxy_ignore_headers Cache - Control ; add_header X - Xss - Protection \"1; mode=block\" always ; add_header X - Content - Type - Options \"nosniff\" always ; add_header X - Frame - Options \"SAMEORIGIN\" always ; proxy_redirect off ; if ( !- f $ request_filename ) { proxy_pass https : //[Tu URL]:443; break ; } } } Finalmente, reiniciamos openresty : systemctl restart openresty . Ahora que tenemos la cach\u00e9 configurada, necesitamos configurar la llamada, o hook, de invalidaci\u00f3n de cach\u00e9. Para esto, entramos al servidor donde est\u00e1 corriendo andino y corremos: IP_INTERNA_CACHE = <ip interna del servidor de cach\u00e9> cd /etc/portal docker-compose -f latest.yml exec portal /etc/ckan_init.d/update_conf.sh \"andino.cache_clean_hook=http:// $IP_INTERNA_CACHE /meta/cache/purge\" ; docker-compose -f latest.yml restart portal nginx Si queremos probar la integraci\u00f3n, podemos entrar al contenedor de andino y probar invalidar la cach\u00e9: IP_INTERNA_CACHE =< ip interna del servidor de cach \u00e9 > cd / etc / portal docker - compose - f latest . yml exec portal curl - X PURGE \" http://$IP_INTERNA_CACHE/meta/cache/purge \" ; # => OK NOTA: Si estamos usando nuestro andino con un IP y no con un dominio, tendremos que cambiar la configuraci\u00f3n ckan.site_url para que use la IP del servidor donde se encuentra la cach\u00e9 externa. IP_PUBLICA_CACHE = <ip publica del servidor cach\u00e9> cd /etc/portal docker-compose -f latest.yml exec portal /etc/ckan_init.d/update_conf.sh \"ckan.site_url=http:// $IP_PUBLICA_CACHE \" ; docker-compose -f latest.yml restart portal nginx","title":"Cach\u00e9 externa"},{"location":"developers/maintenance/#especificar-las-licencias-a-utilizar","text":"Existe un JSON que contiene las licencias a utilizar en el portal, y cuyo path es /var/lib/ckan/theme_config/licenses.json . Este archivo est\u00e1 especificado en el campo licenses_group_url del archivo de configuraci\u00f3n. Es posible cambiarlo para lograr utilizar un archivo distinto; para ello, hay que cambiar el path por el deseado, teniendo en cuenta las siguientes indicaciones: * Para utilizar un path de un archivo existente en el container, el mismo debe comenzar con el texto file:// , tal y como ocurre con el path utilizado por default. * Para utilizar una URL, debe comenzar con http:// o https:// .","title":"Especificar las licencias a utilizar"},{"location":"developers/maintenance/#configuracion-de-cors","text":"Cuando es necesario acceder a Andino desde URLs distintas que apuntan a una misma instancia (ej: accediendo a trav\u00e9s de un gateway/cach\u00e9 o directamente a la instancia de Andino o usando la IP p\u00fablica del servidor host ) es necesario, para el correcto funcionamiento de Andino, configurar par\u00e1metros para habilitar CORS ( Cross-Origin Resource Sharing ). Esto se debe a que un Andino debe tener una URL can\u00f3nica, por lo tanto, las dem\u00e1s URLs utilizadas deben estar en el whitelist de CORS de Andino. Para poder navegar tu Andino usando como URL una que no es la can\u00f3nica de tu instancia, ten\u00e9s que realizar dos acciones (los comandos deben ser ejecutados desde el directorio de instalaci\u00f3n de Andino; por default , /etc/portal ): Habilitar el comportamiento CORS: docker-compose -f latest.yml exec portal /etc/ckan_init.d/update_conf.sh \"ckan.cors.origin_allow_all = false\" (si bien el par\u00e1metro de configuraci\u00f3n tiene el valor false , esto habilita el control de URLs contra el whitelist ). Agregar las URLs al whitelist : docker-compose -f latest.yml exec portal /etc/ckan_init.d/update_conf.sh \"ckan.cors.origin_whitelist=http://localhost:8080 http://127.0.0.1 http://127.0.0.1:8080\" (en el ejemplo se habilitan las URLs http://localhost:8080 , http://127.0.0.1 y http://127.0.0.1:8080 ). Luego reinici\u00e1 los contenedores portal y nginx : docker-compose -f latest.yml restart nginx portal . Ten\u00e9 en cuenta que el script va a reemplazar las URLs existentes en el campo por lo que le pases por par\u00e1metro. Si hay URLs que quer\u00e9s mantener en la configuraci\u00f3n, buscalas con el siguiente comando y especificalas junto a las nuevas: docker-compose -f latest.yml exec portal bash -c 'grep \"ckan.cors.origin_whitelist\" /etc/ckan/default/production.ini' . Si dese\u00e1s habilitar todas las URLs para CORS (no recomendado por cuestiones de seguridad), en el paso 1 deb\u00e9s pasar el valor true para el atributo de configuraci\u00f3n ckan.cors.origin_allow_all e ignorar el paso 2. Para ver m\u00e1s acerca del funcionamiento de CORS en CKAN ver la documentaci\u00f3n oficial de CKAN (en ingl\u00e9s) .","title":"Configuraci\u00f3n de CORS"},{"location":"developers/maintenance/#configuracion-del-explorador-de-series-de-tiempo","text":"Andino tiene instalado el plugin ckanext-seriestiempoarexplorer , pero no se encuentra presente entre los plugins activos. Para activarlo, debemos entrar al contenedor de andino, editar el archivo /etc/ckan/default/production.ini y agregar el seriestiempoarexplorer a la lista de plugins. Luego de agregarlo, debemos reinicar el servidor. cd / etc / portal docker - compose - f latest . yml exec portal bash ; vim / etc / ckan / default / production . ini # ... apachectl restart Luego, si vamos a la configuraci\u00f3n del sitio, podremos apreciar que se agrego una nueva secci\u00f3n \"Series\" en el apartado \"Otras secciones del portal\".","title":"Configuraci\u00f3n del explorador de series de tiempo"},{"location":"developers/maintenance/#acceso-a-los-datos-de-andino","text":"","title":"Acceso a los datos de andino"},{"location":"developers/maintenance/#encontrar-los-volumenes-de-mi-andino-dentro-del-filesystem-del-host","text":"docker - compose - f latest . yml ps - q andino solr db | xargs - n 1 | while read container ; do docker inspect -f ' {{.Name}}: {{range .Mounts}}{{.Source}}: {{.Destination}} {{end}} ' $container; done Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Encontrar los vol\u00famenes de mi andino dentro del filesystem del host"},{"location":"developers/maintenance/#ver-las-direcciones-ip-de-mis-contenedores","text":"docker - compose - f latest . yml ps - q andino solr db | xargs - n 1 | while read container ; do docker inspect -f '{{.Name}}: {{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' $container; done","title":"Ver las direcciones IP de mis contenedores"},{"location":"developers/maintenance/#ver-las-variables-de-entorno-que-tienen-mis-contenedores","text":"docker - compose - f latest . yml ps - q andino solr db | xargs - n 1 | while read container ; do docker inspect -f '{{range $index, $value := .Config.Env}}export {{$value}}{{println}}{{end}}' $container; done Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Ver las variables de entorno que tienen mis contenedores"},{"location":"developers/maintenance/#acceder-con-un-cliente-de-postgresql-a-las-bases-de-datos","text":"docker - compose - f dev . yml exec db psql - U postgres # psql \\ c ckan db default CKAN # psql \\ c datastore_default db datastore CKAN","title":"Acceder con un cliente de PostgreSQL a las bases de datos"},{"location":"developers/maintenance/#eliminar-objetos-definitivamente","text":"Es bien sabido que, dentro de CKAN, cada vez que borranmos algun elemento, en verdad no se borra, sino que pasa a estar inactivo; por lo tanto, tener alguna forma de eliminar elementos de manera definitiva resulta altamente necesario.","title":"Eliminar objetos definitivamente"},{"location":"developers/maintenance/#purgar-organizaciones-borradas","text":"curl - X POST http : // tu - host / api / 3 / action / organization_purge - H \"Authorization:tu-api-key\" - F id = id - o - nombre - que - se - desea - borrar","title":"Purgar Organizaciones Borradas"},{"location":"developers/maintenance/#purgar-grupos-borrados","text":"curl - X POST http : // tu - host / api / 3 / action / group_purge - H \"Authorization:tu-api-key\" - F id = id - o - nombre - que - se - desea - borrar","title":"Purgar Grupos Borrados"},{"location":"developers/maintenance/#purgar-datasets-borrados","text":"curl - X POST http : // tu - host / api / 3 / action / dataset_purge - H \"Authorization:tu-api-key\" - F id = id - o - nombre - que - se - desea - borrar","title":"Purgar Datasets Borrados"},{"location":"developers/maintenance/#listar-nombres-de-los-datasets-contenidos-en-andino","text":"docker-compose -f latest.yml exec portal /etc/ckan_init.d/paster.sh --plugin = ckan dataset list | grep -v DEBUG | grep -v count | grep -v Datasets | xargs -n2 | while read id name ; do echo $name ; done Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Listar nombres de los datasets contenidos en Andino"},{"location":"developers/maintenance/#backups","text":"Es altamente recomendable hacer copias de seguridad de los datos de la aplicaci\u00f3n, tanto la base de datos como los archivos de configuraci\u00f3n y subidos por los usuarios.","title":"Backups"},{"location":"developers/maintenance/#backup-de-la-base-de-datos","text":"Un ejemplo f\u00e1cil de hacer un backup de la base de datos ser\u00eda: container = $ ( docker - compose - f latest . yml ps - q db ) today = ` date +% Y -% m -% d . % H : % M : % S ` filename = \" backup-$today.gz \" # Creo un directorio temporal y defino d \u00f3 nde generar \u00e9 el backup backupdir = $ ( mktemp - d ) backupfile = \" $backupdir/$filename \" # Exporto la base de datos docker exec $c ontainer pg_dumpall - c - U postgres | gzip > \" $backupfile \" # Copio el archivo al directorio actual y borro el original # Podr \u00ed a reemplazar $ PWD con mi directorio de backups , como / etc / portal / backups mv \" $backupfile \" $ PWD Y para los dem\u00e1s archivos de la aplicaci\u00f3n (requiere jq ): backupdir = $ ( mktemp - d ) today = ` date +% Y -% m -% d . % H : % M : % S ` appbackupdir = \" $backupdir/application/ \" mkdir $a ppbackupdir container = $ ( docker - compose - f latest . yml ps - q portal ) docker inspect -- format ' {{json .Mounts}} ' $c ontainer | jq - r ' .[]|[.Name, .Source, .Destination] | @tsv ' | while IFS = $ ' \\t ' read - r name source destination ; do if ls $ source /* 1> /dev/null 2>&1; then dest=\"$appbackupdir$name\" mkdir -p $dest tar -C \"$source\" -zcvf \"$dest/backup_$today.tar.gz\" $(ls $source) else echo \"No file at $source\" fi done tar -C \"$appbackupdir../\" -zcvf backup.tar.gz \"application/\" Podria colocarse esos scripts en el directorio donde se instal\u00f3 la aplicaci\u00f3n (ejemplo : /etc/portal/backup.sh ) y luego agregar un cron : Para correr el script cada domingo, podr\u00edamos usar la configuraci\u00f3n 0 0 * * 0 (ver cron para m\u00e1s informaci\u00f3n), correr el comando crontab -e y agregar la l\u00ednea: 0 0 * * 0 cd / etc / portal / && bash / etc / portal / backup . sh","title":"Backup de la base de datos"},{"location":"developers/maintenance/#realizar-un-backup-del-file-system","text":"# Exporto el path al almacenamiento del volumen export CKAN_FS_STORAGE = $ ( docker inspect -- format ' {{ range .Mounts }}{{ if eq .Destination \"/var/lib/ckan\" }}{{ .Source }}{{ end }}{{ end }} ' andino ) # Creo un tar . gz con la info . tar - C \" $(dirname \" $C KAN_FS_STORAGE \" ) \" - zcvf / ruta / para / guardar / mis / bkps / mi_andino . fs - data_ $ ( date +% F ) . tar . gz \" $(basename \" $C KAN_FS_STORAGE \" ) \"","title":"Realizar un backup del file system"},{"location":"developers/maintenance/#realizar-un-backup-de-la-configuracion","text":"# Exporto el path al almacenamiento del volumen export ANDINO_CONFIG = $ ( docker inspect -- format ' {{ range .Mounts }}{{ if eq .Destination \"/etc/ckan/default\" }}{{ .Source }}{{ end }}{{ end }} ' andino ) # Creo un tar . gz con la info . tar - C \" $(dirname \" $A NDINO_CONFIG \" ) \" - zcvf / ruta / para / guardar / mis / bkps / mi_andino . config - data_ $ ( date +% F ) . tar . gz \" $(basename \" $A NDINO_CONFIG \" ) \"","title":"Realizar un backup de la configuraci\u00f3n"},{"location":"developers/maintenance/#comandos-de-datapusher","text":"Deben ser corridos en el directorio de instalaci\u00f3n de Andino.","title":"Comandos de DataPusher"},{"location":"developers/maintenance/#subir-todos-los-recursos-al-datastore","text":"Es posible que existan recursos que no hayan sido subidos al Datastore. Para buscar e intentar subir dichos recursos, ejecutar: docker - compose - f latest . yml exec portal / usr / lib / ckan / default / bin / paster -- plugin = ckan datapusher submit_all - c / etc / ckan / default / production . ini Se preguntar\u00e1 si se desea proceder. Al escribir que s\u00ed ( y ), iniciar la subida de recursos. Para cada uno de ellos, se escribir\u00e1 su id y luego el status: si subi\u00f3 correctamente, aparecer\u00e1 \" OK \"; en caso contrario, \" FAIL \".","title":"Subir todos los recursos al Datastore"},{"location":"developers/maintenance/#seguridad","text":"Mantener seguro un servidor web puede ser una tarea ardua, pero sobre todo es constante , ya que constantemente se detectan nuevas vulnerabilidades en los distintos softwares. Y un servidor web no es la excepci\u00f3n! En este breve apartado, se dar\u00e1n peque\u00f1as recomendaciones para mantener seguro el servidor, no solo antes posibles atacantes, sino tambien ante posibles fallos del sistema y como efectuar mitigaciones. Las siguientes recomendaciones puden ser implementadas f\u00e1cilmente en un sistema Ubuntu 16.04, el cual es el recomendado (a la fecha), para correr la aplicaci\u00f3n.","title":"Seguridad"},{"location":"developers/maintenance/#https","text":"HTTPS permite que la conexi\u00f3n entre el browser y el servidor sea encriptada y de esta manera segura. Es altamente recomendable usar HTTPS, para mantener la privacidad de los usuarios. El portal de documentaci\u00f3n para desarrolladores de Google provee buena informaci\u00f3n sobre esto: https://developers.google.com/web/fundamentals/security/encrypt-in-transit/why-https","title":"HTTPS"},{"location":"developers/maintenance/#plugin-ckanext-security","text":"Para las versiones 2.5.7 en adelante, existe un plugin para mejorar la seguridad de CKAN que se puede encontrar en github . Para su utilizaci\u00f3n, es necesario el uso de certificados SSL, ya sea en Andino mismo (teniendo https en el campo site_url de la configuraci\u00f3n del portal) o mediante un reverse proxy. Para este plugin existen dos scripts, los cuales se pueden encontrar en el directorio /etc/ckan_init.d/security dentro del contenedor de Andino; uno para activarlo ( enable_ckanext_security.sh ) y otro para desactivarlo ( disable_ckanext_security.sh ). S\u00f3lo se necesita ejecutar el que se necesite y reiniciar apache.","title":"Plugin ckanext-security"},{"location":"developers/maintenance/#sistema-y-librerias","text":"Es altamente recomendable mantener el sistema operativo y las aplicaciones que usemos actualizadas. Constantemente se est\u00e1n subiendo fixes de seguridad y posibles intrusos podr\u00edan aprovechar que las aplicaciones o el mismo sistema operativo est\u00e9n desactualizados. Peri\u00f3dicamente, podr\u00edamos constatar las nuevas versiones de nuestro software y actualizar dentro de lo posible. Como ejemplo, podemos ver que para Ubuntu 16.04 sali\u00f3 Ubuntu 16.04.2, con algunas correcciones de seguridad. Ver .","title":"Sistema y librer\u00edas"},{"location":"developers/maintenance/#firewall","text":"Todo servidor debe tener activado el firewall. El firewall permitir\u00e1 denegar (o permitr) el acceso a la red. En un servidor web, el puerto abierto al p\u00fablico deber\u00edan ser s\u00f3lo el 80 (http) y el 443 (https). Adem\u00e1s de ese puerto, si la m\u00e1quina es accedida remotamente mediante un servidor SSH, deber\u00edamos abrir este puerto tambi\u00e9n, pero con un l\u00edmite de acceso. La soluci\u00f3n es f\u00e1cilmente implementable con el programa ufw .","title":"Firewall"},{"location":"developers/maintenance/#ssh","text":"Los servidores ssh permiten el acceso al servidor remotamente. No debe permitirse el acceso por ssh mediante usuario y password . S\u00f3lo debe permitirse el acceso mediante clave publica. DigitalOcean tiene una buena gu\u00eda de c\u00f3mo configurar las claves p\u00fablicas Ver .","title":"SSH"},{"location":"developers/maintenance/#optimizacion-de-logging","text":"","title":"Optimizaci\u00f3n de logging"},{"location":"developers/maintenance/#configurar-otro-logging-driver","text":"Por default, docker escribe a un archivo con formato json , lo cual puede llevar a que se acumulen los logs de la aplicaci\u00f3n, y estos archivos crezcan indefinidamente. Para evitar esto, se puede configurar el logging driver de docker. La recomendacion es usar journald y configurarlo para que los logs sean persistentes.","title":"Configurar otro logging driver"},{"location":"developers/maintenance/#eliminar-logs-antiguos-de-docker","text":"Dentro del normal funcionamiento de la plataforma, se genera una gran cantidad de logs, los cuales, ante un incidencia, son sumamente \u00fatiles. Pero, luego de un tiempo, y sabiendo que los mismos se almacenan internamente en Andino, podr\u00eda ser necesario eliminarlos. sudo su - c \" ls /var/lib/docker/containers/ | xargs -n1 | while read docker_id; do truncate -s 0 /var/lib/docker/containers/${docker_id%/*}/${docker_id%/*}-json.log; done \"","title":"Eliminar logs antiguos de Docker"},{"location":"developers/maintenance/#eliminar-logs-dentro-de-andino","text":"docker - compose - f latest . yml exec portal truncate - s 0 / var / log / apache2 /*.log Ver la secci\u00f3n sobre la utilizaci\u00f3n del archivo latest.yml en los comandos de docker-compose .","title":"Eliminar logs dentro de Andino"},{"location":"developers/migration/","text":"Migracion En el presente documento, se pretende explicar c\u00f3mo llevar a cabo una migraci\u00f3n de la versi\u00f3n 1.0 de andino a la versi\u00f3n 2.0 de andino. Indice 1. Requisitos 2. Script de migraci\u00f3n autom\u00e1tico. 3. Migraci\u00f3n manual 3.1. Backup de la base de datos 3.2. Backup de los archivos de la aplicaci\u00f3n 4. Instalaci\u00f3n 4.1. Detener la aplicaci\u00f3n 4.2. Instalar la aplicaci\u00f3n 5. Restores 5.1. Restaurar los archivos 5.2. Restaurar la base de datos 5.3. Regenerar el \u00edndice de b\u00fasquedas 1. Requisitos Se requiere tener instalado: jq >= 1.5 docker docker-compose Se asume que, en el servidor, hay 3 containers de docker corriendo: app-ckan pg-ckan solr-ckan Adem\u00e1s, se debe conocer los usuarios y passwords de la base de datos (tanto de la usada por ckan como por el datastore ). 2. Script de migraci\u00f3n autom\u00e1tico. El repositorio cuenta con un script para correr la migraci\u00f3n autom\u00e1ticamente. (el mismo se puede encontrar en install/migrate.sh , dentro del repositorio). Ciertas variables de entorno y tener instalado docker y docker-compose . Debe ser ejecutado con sudo o root . Ejemplo: export EMAIL = admin @example . com export HOST = andino . midomionio . com . ar export DB_USER = usuario export DB_PASS = password export STORE_USER = dsuser export STORE_PASS = dspass sudo - E . / migrate . sh 3. Migraci\u00f3n manual Para realizar la migraci\u00f3n manual, debemos conocer las variables con las que se inicializ\u00f3 el portal. En este caso, ser\u00e1n las siguientes: export EMAIL = admin @example . com export HOST = andino . midomionio . com . ar export DB_USER = usuario export DB_PASS = password export STORE_USER = dsuser export STORE_PASS = dspass 3.1. Backup de la base de datos Es necesario hacer un backup de la base de datos antes de empezar con la migraci\u00f3n. La misma puede llevarse a cabo con el siguiente script: #!/usr/bin/env bash set -e ; old_db = \"pg-ckan\" database_backup = \"backup.gz\" echo \"Creando backup de la base de datos.\" backupdir = $( mktemp -d ) backupfile = \" $backupdir / $database_backup \" echo \"Iniciando backup de $old_db \" echo \"Usando directorio temporal: $backupdir \" docker exec $old_db pg_dumpall -c -U postgres | gzip > \" $backupfile \" echo \"Copiando backup a $PWD \" cp \" $backupfile \" $PWD echo \"Backup listo.\" Este script dejar\u00e1 un archivo backup.gz en el directorio actual. 3.2. Backup de los archivos de la aplicaci\u00f3n Es necesario hacer un backup de los archivos de la aplicaci\u00f3n: configuraci\u00f3n y archivos subidos. El mismo puede llevarse a cabo con el siguiente script: Nota: Requiere jq >= 1.5 #!/usr/bin/env bash set -e ; old_andino = \"app-ckan\" app_backup = \"backup.tar.gz\" echo \"Creando backup de los archivos de configuraci\u00f3n.\" backupdir = $( mktemp -d ) today = ` date +%Y-%m-%d.%H:%M:%S ` appbackupdir = \" $backupdir /application/\" mkdir $appbackupdir echo \"Iniciando backup de los volumenes en $old_andino \" echo \"Usando directorio temporal: $backupdir \" docker inspect --format '{{json .Mounts}}' $old_andino | jq -r '.[]|[.Name, .Source, .Destination] | @tsv' | while IFS = $'\\t' read -r name source destination ; do echo \"Guardando archivos de $destination \" if ls $source /* 1 > /dev/null 2 > & 1 ; then echo \"Nombre del volumen: $name .\" echo \"Directorio en el Host: $source \" echo \"Destino: $destination \" dest = \" $appbackupdir$name \" mkdir -p $dest echo \" $destination \" > \" $dest /destination.txt\" tar -C \" $source \" -zcvf \" $dest /backup_ $today .tar.gz\" $( ls $source ) echo \"List backup de $destination \" else echo \"Ning\u00fan archivo para $destination \" ; fi done echo \"Generando backup en $app_backup \" tar -C \" $appbackupdir ../\" -zcvf $app_backup \"application/\" echo \"Backup listo.\" Este script dejar\u00e1 un archivo backup.tar.gz en el directorio actual. El mismo, una vez descomprimido, contendr\u00e1 la siguiente estructura (por ejemplo): - application / \u251c\u2500\u2500 61 ee6cc7dc974476fe3300cc4325d913ed2f949494419b11a5c7c897fa919106 \u2502 \u251c\u2500\u2500 backup_2017 - 05 - 19 . 10 : 56 : 09 . tar . gz \u2502 \u2514\u2500\u2500 destination . txt \u2514\u2500\u2500 b1bf820976c3220e54136e4db229a67a9d9292896ad8d91623030e3b7171f210 \u251c\u2500\u2500 backup_2017 - 05 - 19 . 10 : 56 : 09 . tar . gz \u2514\u2500\u2500 destination . txt Cada sub-directorio contiene el ID del volumen en docker usado; los n\u00fameros varian de volumen en volumen. Dentro de cada sub-directorio se encuentra un archivo .tar.gz junto con un archivo destination.txt. * El archivo destination.txt indica d\u00f3nde corresponde la informaci\u00f3n dentro del container. * El archivo .tar.gz contiene una carpeta _data con los archivos. 4. Instalaci\u00f3n 4.1. Detener la aplicaci\u00f3n Debemos detener la aplicaci\u00f3n para lograr que se liberen los puertos usados. Por ejemplo, el puerto 80. docker stop solr-ckan pg-ckan app-ckan 4.2. Instalar la aplicaci\u00f3n Ver la documentaci\u00f3n Aqu\u00ed Nota: Actualizar la versi\u00f3n de docker y docker-compose de ser necesario. Ahora, es necesario restaurar tanto la base de datos como los archivos de la aplicaci\u00f3n. 5. Restores 5.1. Restaurar los archivos Descomprimir el archivo backup.tar.gz . En cada subdirectorio encontraremos el archivo destination.txt; el contenido de este archivo nos ayudar\u00e1 a saber donde debemos copiar los archivos. Con el siguiete comando, podremos saber qu\u00e9 vol\u00famenes hay montados en el nuevo esquema y d\u00f3nde debemos copiar los archivos dentro del backup_*.tar.gz Correr docker inspect andino -f '{{ json .Mounts }}' | jq : El comando mostrar\u00e1, por ejemplo, lo siquiente: [ { \"Type\" : \"volume\" , \"Name\" : \"a1d87160a04e270302582849c9ce5c6dbb44719a94b702158aeaf23835f7862f\" , \"Source\" : \"/var/lib/docker/volumes/a1d87160a04e270302582849c9ce5c6dbb44719a94b702158aeaf23835f7862f/_data\" , \"Destination\" : \"/etc/ckan/default\" , \"Driver\" : \"local\" , \"Mode\" : \"\" , \"RW\" : true , \"Propagation\" : \"\" } , { \"Type\" : \"volume\" , \"Name\" : \"7ab721966628bf692a3d451567c9a01b419ba5189b88ef05484de315c73f6275\" , \"Source\" : \"/var/lib/docker/volumes/7ab721966628bf692a3d451567c9a01b419ba5189b88ef05484de315c73f6275/_data\" , \"Destination\" : \"/usr/lib/ckan/default/src/ckanext-gobar-theme/ckanext/gobar_theme/public/user_images\" , \"Driver\" : \"local\" , \"Mode\" : \"\" , \"RW\" : true , \"Propagation\" : \"\" } , ... Como podemos ver, hay una entrada \"Destination\" que coincidir\u00e1 con el contenido del archivo destination.txt en cada directorio. Debemos asegurarnos de no copiar el archivo production.ini, ya que el mismo cambio bastante de versi\u00f3n en versi\u00f3n. El restore puede ser llevado a cabo con el siguiente script: #!/usr/bin/env bash set -e ; echo \"Iniciando recuperaci\u00f3n de Archivos.\" install_dir = \"/etc/portal\" ; container = \"andino\" app_backup = \"backup.tar.gz\" containers = $( docker ps -q ) if [ -z \" $containers \" ] ; then echo \"No se encontr\u00f3 ningun contenedor corriendo.\" else docker stop $containers fi restoredir = $( mktemp -d ) echo \"Usando directorio temporal $restoredir \" tar zxvf $app_backup -C $restoredir docker inspect --format '{{json .Mounts}}' $container | jq -r '.[]|[.Name, .Source, .Destination] | @tsv' | while IFS = $'\\t' read -r name source destination ; do for directory in $restoredir /application/* ; do dest = $( cat \" $directory /destination.txt\" ) if [ \" $dest \" == \" $destination \" ] ; then echo \"Recuperando archivos para $destination \" tar zxvf \" $directory / $( ls \" $directory \" | grep backup ) \" -C \" $source \" fi done done echo \"Restauraci\u00f3n lista.\" echo \"Reiniciando servicios.\" cd $install_dir ; docker-compose -f latest.yml restart ; cd - ; 5.2. Restaurar la base de datos Para restaurar la base de datos, se puede usar el siguiente script contra el archivo previamente generado (backup.gz): #!/usr/bin/env bash set -e ; install_dir = \"/etc/portal\" ; database_backup = \"backup.gz\" container = \"andino-db\" echo \"Iniciando restauraci\u00f3n de la base de datos.\" containers = $( docker ps -q ) if [ -z \" $containers \" ] ; then echo \"No se encontr\u00f3 ningun contenedor corriendo.\" else docker stop $containers fi docker restart $container sleep 10 ; restoredir = $( mktemp -d ) ; echo \"Usando directorio temporal $restoredir \" restorefile = \" $restoredir /dump.sql\" ; gzip -dkc < $database_backup > \" $restorefile \" ; echo \"Borrando base de datos actual.\" docker exec $container psql -U postgres -c \"DROP DATABASE IF EXISTS ckan;\" docker exec $container psql -U postgres -c \"DROP DATABASE IF EXISTS datastore_default;\" echo \"Restaurando la base de datos desde: $restorefile \" cat \" $restorefile \" | docker exec -i $container psql -U postgres echo \"Recuperando credenciales de los usuarios\" docker exec $container psql -U postgres -c \"ALTER USER $DB_USER WITH PASSWORD ' $DB_PASS ';\" docker exec $container psql -U postgres -c \"ALTER USER $STORE_USER WITH PASSWORD ' $STORE_PASS ';\" echo \"Restauraci\u00f3n lista.\" echo \"Reiniciando servicios.\" cd $install_dir ; docker-compose -f latest.yml restart ; cd - ; 5.3. Regenerar el \u00edndice de b\u00fasquedas Para regenerar el \u00edndice de b\u00fasquedas, debemos ir al directorio donde se instal\u00f3 la aplicaci\u00f3n y correr el siguiente comando: docker - compose - f latest . yml exec portal / etc / ckan_init . d / run_rebuild_search . sh","title":"Migracion"},{"location":"developers/migration/#migracion","text":"En el presente documento, se pretende explicar c\u00f3mo llevar a cabo una migraci\u00f3n de la versi\u00f3n 1.0 de andino a la versi\u00f3n 2.0 de andino.","title":"Migracion"},{"location":"developers/migration/#indice","text":"1. Requisitos 2. Script de migraci\u00f3n autom\u00e1tico. 3. Migraci\u00f3n manual 3.1. Backup de la base de datos 3.2. Backup de los archivos de la aplicaci\u00f3n 4. Instalaci\u00f3n 4.1. Detener la aplicaci\u00f3n 4.2. Instalar la aplicaci\u00f3n 5. Restores 5.1. Restaurar los archivos 5.2. Restaurar la base de datos 5.3. Regenerar el \u00edndice de b\u00fasquedas","title":"Indice"},{"location":"developers/migration/#1-requisitos","text":"Se requiere tener instalado: jq >= 1.5 docker docker-compose Se asume que, en el servidor, hay 3 containers de docker corriendo: app-ckan pg-ckan solr-ckan Adem\u00e1s, se debe conocer los usuarios y passwords de la base de datos (tanto de la usada por ckan como por el datastore ).","title":"1. Requisitos"},{"location":"developers/migration/#2-script-de-migracion-automatico","text":"El repositorio cuenta con un script para correr la migraci\u00f3n autom\u00e1ticamente. (el mismo se puede encontrar en install/migrate.sh , dentro del repositorio). Ciertas variables de entorno y tener instalado docker y docker-compose . Debe ser ejecutado con sudo o root . Ejemplo: export EMAIL = admin @example . com export HOST = andino . midomionio . com . ar export DB_USER = usuario export DB_PASS = password export STORE_USER = dsuser export STORE_PASS = dspass sudo - E . / migrate . sh","title":"2. Script de migraci\u00f3n autom\u00e1tico."},{"location":"developers/migration/#3-migracion-manual","text":"Para realizar la migraci\u00f3n manual, debemos conocer las variables con las que se inicializ\u00f3 el portal. En este caso, ser\u00e1n las siguientes: export EMAIL = admin @example . com export HOST = andino . midomionio . com . ar export DB_USER = usuario export DB_PASS = password export STORE_USER = dsuser export STORE_PASS = dspass","title":"3. Migraci\u00f3n manual"},{"location":"developers/migration/#31-backup-de-la-base-de-datos","text":"Es necesario hacer un backup de la base de datos antes de empezar con la migraci\u00f3n. La misma puede llevarse a cabo con el siguiente script: #!/usr/bin/env bash set -e ; old_db = \"pg-ckan\" database_backup = \"backup.gz\" echo \"Creando backup de la base de datos.\" backupdir = $( mktemp -d ) backupfile = \" $backupdir / $database_backup \" echo \"Iniciando backup de $old_db \" echo \"Usando directorio temporal: $backupdir \" docker exec $old_db pg_dumpall -c -U postgres | gzip > \" $backupfile \" echo \"Copiando backup a $PWD \" cp \" $backupfile \" $PWD echo \"Backup listo.\" Este script dejar\u00e1 un archivo backup.gz en el directorio actual.","title":"3.1. Backup de la base de datos"},{"location":"developers/migration/#32-backup-de-los-archivos-de-la-aplicacion","text":"Es necesario hacer un backup de los archivos de la aplicaci\u00f3n: configuraci\u00f3n y archivos subidos. El mismo puede llevarse a cabo con el siguiente script: Nota: Requiere jq >= 1.5 #!/usr/bin/env bash set -e ; old_andino = \"app-ckan\" app_backup = \"backup.tar.gz\" echo \"Creando backup de los archivos de configuraci\u00f3n.\" backupdir = $( mktemp -d ) today = ` date +%Y-%m-%d.%H:%M:%S ` appbackupdir = \" $backupdir /application/\" mkdir $appbackupdir echo \"Iniciando backup de los volumenes en $old_andino \" echo \"Usando directorio temporal: $backupdir \" docker inspect --format '{{json .Mounts}}' $old_andino | jq -r '.[]|[.Name, .Source, .Destination] | @tsv' | while IFS = $'\\t' read -r name source destination ; do echo \"Guardando archivos de $destination \" if ls $source /* 1 > /dev/null 2 > & 1 ; then echo \"Nombre del volumen: $name .\" echo \"Directorio en el Host: $source \" echo \"Destino: $destination \" dest = \" $appbackupdir$name \" mkdir -p $dest echo \" $destination \" > \" $dest /destination.txt\" tar -C \" $source \" -zcvf \" $dest /backup_ $today .tar.gz\" $( ls $source ) echo \"List backup de $destination \" else echo \"Ning\u00fan archivo para $destination \" ; fi done echo \"Generando backup en $app_backup \" tar -C \" $appbackupdir ../\" -zcvf $app_backup \"application/\" echo \"Backup listo.\" Este script dejar\u00e1 un archivo backup.tar.gz en el directorio actual. El mismo, una vez descomprimido, contendr\u00e1 la siguiente estructura (por ejemplo): - application / \u251c\u2500\u2500 61 ee6cc7dc974476fe3300cc4325d913ed2f949494419b11a5c7c897fa919106 \u2502 \u251c\u2500\u2500 backup_2017 - 05 - 19 . 10 : 56 : 09 . tar . gz \u2502 \u2514\u2500\u2500 destination . txt \u2514\u2500\u2500 b1bf820976c3220e54136e4db229a67a9d9292896ad8d91623030e3b7171f210 \u251c\u2500\u2500 backup_2017 - 05 - 19 . 10 : 56 : 09 . tar . gz \u2514\u2500\u2500 destination . txt Cada sub-directorio contiene el ID del volumen en docker usado; los n\u00fameros varian de volumen en volumen. Dentro de cada sub-directorio se encuentra un archivo .tar.gz junto con un archivo destination.txt. * El archivo destination.txt indica d\u00f3nde corresponde la informaci\u00f3n dentro del container. * El archivo .tar.gz contiene una carpeta _data con los archivos.","title":"3.2. Backup de los archivos de la aplicaci\u00f3n"},{"location":"developers/migration/#4-instalacion","text":"","title":"4. Instalaci\u00f3n"},{"location":"developers/migration/#41-detener-la-aplicacion","text":"Debemos detener la aplicaci\u00f3n para lograr que se liberen los puertos usados. Por ejemplo, el puerto 80. docker stop solr-ckan pg-ckan app-ckan","title":"4.1. Detener la aplicaci\u00f3n"},{"location":"developers/migration/#42-instalar-la-aplicacion","text":"Ver la documentaci\u00f3n Aqu\u00ed Nota: Actualizar la versi\u00f3n de docker y docker-compose de ser necesario. Ahora, es necesario restaurar tanto la base de datos como los archivos de la aplicaci\u00f3n.","title":"4.2. Instalar la aplicaci\u00f3n"},{"location":"developers/migration/#5-restores","text":"","title":"5. Restores"},{"location":"developers/migration/#51-restaurar-los-archivos","text":"Descomprimir el archivo backup.tar.gz . En cada subdirectorio encontraremos el archivo destination.txt; el contenido de este archivo nos ayudar\u00e1 a saber donde debemos copiar los archivos. Con el siguiete comando, podremos saber qu\u00e9 vol\u00famenes hay montados en el nuevo esquema y d\u00f3nde debemos copiar los archivos dentro del backup_*.tar.gz Correr docker inspect andino -f '{{ json .Mounts }}' | jq : El comando mostrar\u00e1, por ejemplo, lo siquiente: [ { \"Type\" : \"volume\" , \"Name\" : \"a1d87160a04e270302582849c9ce5c6dbb44719a94b702158aeaf23835f7862f\" , \"Source\" : \"/var/lib/docker/volumes/a1d87160a04e270302582849c9ce5c6dbb44719a94b702158aeaf23835f7862f/_data\" , \"Destination\" : \"/etc/ckan/default\" , \"Driver\" : \"local\" , \"Mode\" : \"\" , \"RW\" : true , \"Propagation\" : \"\" } , { \"Type\" : \"volume\" , \"Name\" : \"7ab721966628bf692a3d451567c9a01b419ba5189b88ef05484de315c73f6275\" , \"Source\" : \"/var/lib/docker/volumes/7ab721966628bf692a3d451567c9a01b419ba5189b88ef05484de315c73f6275/_data\" , \"Destination\" : \"/usr/lib/ckan/default/src/ckanext-gobar-theme/ckanext/gobar_theme/public/user_images\" , \"Driver\" : \"local\" , \"Mode\" : \"\" , \"RW\" : true , \"Propagation\" : \"\" } , ... Como podemos ver, hay una entrada \"Destination\" que coincidir\u00e1 con el contenido del archivo destination.txt en cada directorio. Debemos asegurarnos de no copiar el archivo production.ini, ya que el mismo cambio bastante de versi\u00f3n en versi\u00f3n. El restore puede ser llevado a cabo con el siguiente script: #!/usr/bin/env bash set -e ; echo \"Iniciando recuperaci\u00f3n de Archivos.\" install_dir = \"/etc/portal\" ; container = \"andino\" app_backup = \"backup.tar.gz\" containers = $( docker ps -q ) if [ -z \" $containers \" ] ; then echo \"No se encontr\u00f3 ningun contenedor corriendo.\" else docker stop $containers fi restoredir = $( mktemp -d ) echo \"Usando directorio temporal $restoredir \" tar zxvf $app_backup -C $restoredir docker inspect --format '{{json .Mounts}}' $container | jq -r '.[]|[.Name, .Source, .Destination] | @tsv' | while IFS = $'\\t' read -r name source destination ; do for directory in $restoredir /application/* ; do dest = $( cat \" $directory /destination.txt\" ) if [ \" $dest \" == \" $destination \" ] ; then echo \"Recuperando archivos para $destination \" tar zxvf \" $directory / $( ls \" $directory \" | grep backup ) \" -C \" $source \" fi done done echo \"Restauraci\u00f3n lista.\" echo \"Reiniciando servicios.\" cd $install_dir ; docker-compose -f latest.yml restart ; cd - ;","title":"5.1. Restaurar los archivos"},{"location":"developers/migration/#52-restaurar-la-base-de-datos","text":"Para restaurar la base de datos, se puede usar el siguiente script contra el archivo previamente generado (backup.gz): #!/usr/bin/env bash set -e ; install_dir = \"/etc/portal\" ; database_backup = \"backup.gz\" container = \"andino-db\" echo \"Iniciando restauraci\u00f3n de la base de datos.\" containers = $( docker ps -q ) if [ -z \" $containers \" ] ; then echo \"No se encontr\u00f3 ningun contenedor corriendo.\" else docker stop $containers fi docker restart $container sleep 10 ; restoredir = $( mktemp -d ) ; echo \"Usando directorio temporal $restoredir \" restorefile = \" $restoredir /dump.sql\" ; gzip -dkc < $database_backup > \" $restorefile \" ; echo \"Borrando base de datos actual.\" docker exec $container psql -U postgres -c \"DROP DATABASE IF EXISTS ckan;\" docker exec $container psql -U postgres -c \"DROP DATABASE IF EXISTS datastore_default;\" echo \"Restaurando la base de datos desde: $restorefile \" cat \" $restorefile \" | docker exec -i $container psql -U postgres echo \"Recuperando credenciales de los usuarios\" docker exec $container psql -U postgres -c \"ALTER USER $DB_USER WITH PASSWORD ' $DB_PASS ';\" docker exec $container psql -U postgres -c \"ALTER USER $STORE_USER WITH PASSWORD ' $STORE_PASS ';\" echo \"Restauraci\u00f3n lista.\" echo \"Reiniciando servicios.\" cd $install_dir ; docker-compose -f latest.yml restart ; cd - ;","title":"5.2. Restaurar la base de datos"},{"location":"developers/migration/#53-regenerar-el-indice-de-busquedas","text":"Para regenerar el \u00edndice de b\u00fasquedas, debemos ir al directorio donde se instal\u00f3 la aplicaci\u00f3n y correr el siguiente comando: docker - compose - f latest . yml exec portal / etc / ckan_init . d / run_rebuild_search . sh","title":"5.3. Regenerar el \u00edndice de b\u00fasquedas"},{"location":"developers/tests/","text":"Tests Para correr los tests de la aplicaci\u00f3n, se deben levantar todos los servicios, y luego inicializar la configuraci\u00f3n de test. Indice Tests de Ckan Probar la instalaci\u00f3n con SSL en Vagrant (Instalando nginx) Instalaci\u00f3n de andino Instalar y configurar nginx Tests de Ckan $ docker - compose - f dev . yml up -- build - d portal $ docker exec andino bash / etc / ckan_init . d / tests / install_solr4 . sh $ docker exec andino bash / etc / ckan_init . d / tests / install_nodejs . sh $ docker exec andino bash - c ' su -c \"bash /etc/ckan_init.d/tests/run_all_tests.sh\" -l $USER ' Probar la instalaci\u00f3n con SSL en Vagrant (Instalando nginx) Instalaci\u00f3n de andino Primero, debemos evitar instalar la aplicaci\u00f3n en vagrant, ya que pasaremos un par\u00e1metro mas. Para eso, modificamos el Vagrantfile cambiando las l\u00edneas: -INSTALL_APP = true -UPDATE_APP = !INSTALL_APP +INSTALL_APP = false +UPDATE_APP = false Y luego levantar la VM con vagrant up . Luego entramos a la aplicaci\u00f3n y corremos el siguiente comando: sudo - E python . / install . py --error_email admin@example.com --site_host 192.168.23.10 --database_user db_user --database_password db_pass --datastore_user data_db_user --datastore_password data_db_pass --nginx_port 127.0.0.1:8000 Esto instalar\u00e1 la aplicaci\u00f3n, pero solo la har\u00e1 accesible desde localhost:8000 . Instalar y configurar nginx Luego, instalamos nginx en el host sudo apt install nginx . Generamos los certificados locales: sudo openssl req - x509 - nodes - days 365 - newkey rsa : 2048 - keyout / etc / nginx / ssl / andino . key - out / etc / nginx / ssl / andino . crt Creamos la configuracion de nginx (no apta para producci\u00f3n) en /etc/nginx/sites-available/001-andino.conf : upstream wsgi_andino { # fail_timeout = 0 means we always retry an upstream even if it failed # to return a good HTTP response ( in case the gunicorn master nukes a # single worker for timing out ) . server 127 . 0 . 0 . 1 : 8000 fail_timeout = 0 ; } server { listen 80 ; # example : server_name www . datos . gob . ar datos . gob . ar ; server_name dev . andino . gob . ar dev . andino . gob . ar ; return 301 https : // $ host $ request_uri ; } server { listen 443 ; server_name dev . andino . gob . ar ; ssl on ; ssl_certificate / etc / nginx / ssl / andino . crt ; ssl_certificate_key / etc / nginx / ssl / andino . key ; client_max_body_size 4 G ; keepalive_timeout 5 ; location / { proxy_set_header X - Forwarded - For $ proxy_add_x_forwarded_for ; proxy_set_header Host $ http_host ; proxy_set_header X - Forwarded - Protocol https ; proxy_redirect off ; if ( !- f $ request_filename ) { proxy_pass http : // wsgi_andino ; break ; } } gzip on ; gzip_disable \" msie6 \" ; gzip_comp_level 6 ; gzip_types text / plain text / css application / json application / x - javascript text / xml application / xml application / xml + rss text / javascript ; } Activamos el sitio: sudo rm / etc / nginx / sites - enabled / default - rf sudo ln - s / etc / nginx / sites - available / 001 - andino . conf / etc / nginx / sites - enabled / 001 - andino . conf sudo systemctl restart nginx Finalmente, accedemos al sitio en http://192.168.23.10:80, y el mismo nos deber\u00eda redireccionar a la versi\u00f3n https . El explorador nos mostrar\u00e1 una advertencia sobre el sitio, ya que no podr\u00e1 validar los certificados.","title":"Tests"},{"location":"developers/tests/#tests","text":"Para correr los tests de la aplicaci\u00f3n, se deben levantar todos los servicios, y luego inicializar la configuraci\u00f3n de test.","title":"Tests"},{"location":"developers/tests/#indice","text":"Tests de Ckan Probar la instalaci\u00f3n con SSL en Vagrant (Instalando nginx) Instalaci\u00f3n de andino Instalar y configurar nginx","title":"Indice"},{"location":"developers/tests/#tests-de-ckan","text":"$ docker - compose - f dev . yml up -- build - d portal $ docker exec andino bash / etc / ckan_init . d / tests / install_solr4 . sh $ docker exec andino bash / etc / ckan_init . d / tests / install_nodejs . sh $ docker exec andino bash - c ' su -c \"bash /etc/ckan_init.d/tests/run_all_tests.sh\" -l $USER '","title":"Tests de Ckan"},{"location":"developers/tests/#probar-la-instalacion-con-ssl-en-vagrant-instalando-nginx","text":"","title":"Probar la instalaci\u00f3n con SSL en Vagrant (Instalando nginx)"},{"location":"developers/tests/#instalacion-de-andino","text":"Primero, debemos evitar instalar la aplicaci\u00f3n en vagrant, ya que pasaremos un par\u00e1metro mas. Para eso, modificamos el Vagrantfile cambiando las l\u00edneas: -INSTALL_APP = true -UPDATE_APP = !INSTALL_APP +INSTALL_APP = false +UPDATE_APP = false Y luego levantar la VM con vagrant up . Luego entramos a la aplicaci\u00f3n y corremos el siguiente comando: sudo - E python . / install . py --error_email admin@example.com --site_host 192.168.23.10 --database_user db_user --database_password db_pass --datastore_user data_db_user --datastore_password data_db_pass --nginx_port 127.0.0.1:8000 Esto instalar\u00e1 la aplicaci\u00f3n, pero solo la har\u00e1 accesible desde localhost:8000 .","title":"Instalaci\u00f3n de andino"},{"location":"developers/tests/#instalar-y-configurar-nginx","text":"Luego, instalamos nginx en el host sudo apt install nginx . Generamos los certificados locales: sudo openssl req - x509 - nodes - days 365 - newkey rsa : 2048 - keyout / etc / nginx / ssl / andino . key - out / etc / nginx / ssl / andino . crt Creamos la configuracion de nginx (no apta para producci\u00f3n) en /etc/nginx/sites-available/001-andino.conf : upstream wsgi_andino { # fail_timeout = 0 means we always retry an upstream even if it failed # to return a good HTTP response ( in case the gunicorn master nukes a # single worker for timing out ) . server 127 . 0 . 0 . 1 : 8000 fail_timeout = 0 ; } server { listen 80 ; # example : server_name www . datos . gob . ar datos . gob . ar ; server_name dev . andino . gob . ar dev . andino . gob . ar ; return 301 https : // $ host $ request_uri ; } server { listen 443 ; server_name dev . andino . gob . ar ; ssl on ; ssl_certificate / etc / nginx / ssl / andino . crt ; ssl_certificate_key / etc / nginx / ssl / andino . key ; client_max_body_size 4 G ; keepalive_timeout 5 ; location / { proxy_set_header X - Forwarded - For $ proxy_add_x_forwarded_for ; proxy_set_header Host $ http_host ; proxy_set_header X - Forwarded - Protocol https ; proxy_redirect off ; if ( !- f $ request_filename ) { proxy_pass http : // wsgi_andino ; break ; } } gzip on ; gzip_disable \" msie6 \" ; gzip_comp_level 6 ; gzip_types text / plain text / css application / json application / x - javascript text / xml application / xml application / xml + rss text / javascript ; } Activamos el sitio: sudo rm / etc / nginx / sites - enabled / default - rf sudo ln - s / etc / nginx / sites - available / 001 - andino . conf / etc / nginx / sites - enabled / 001 - andino . conf sudo systemctl restart nginx Finalmente, accedemos al sitio en http://192.168.23.10:80, y el mismo nos deber\u00eda redireccionar a la versi\u00f3n https . El explorador nos mostrar\u00e1 una advertencia sobre el sitio, ya que no podr\u00e1 validar los certificados.","title":"Instalar y configurar nginx"},{"location":"developers/update/","text":"Actualizaci\u00f3n Indice Versiones 2.x Actualizaci\u00f3n simple Actualizaci\u00f3n avanzada Andino con plugins ad-hoc Versiones 2.5.7 en adelante Versiones 2.5.6 en adelante Versiones 2.5.5 en adelante Versiones 2.5.0 y 2.5.1 Versiones entre 2.4.0 y 2.5.3 Versiones 2.4.x a 2.5.x Versiones 1.x a 2.x Versiones 2.x Nota: si actualiz\u00e1s desde una versi\u00f3n 2.4.x a una versi\u00f3n 2.5.x ver Versiones 2.4.x a 2.5.x ANTES de proceder con la actualizaci\u00f3n Actualizaci\u00f3n simple Si instalamos la aplicaci\u00f3n con la \u00faltima versi\u00f3n del instalador ( este ), el mismo no requerir\u00e1 par\u00e1metros, pero contiene algunos opcionales: # Par\u00e1metros de update.py [ -h ] Mostrar la ayuda del script [ --install_directory INSTALL_DIRECTORY ] Directorio donde est\u00e1 instalada la aplicaci\u00f3n. Por defecto es ` /etc/portal ` [ --site_host SITE_HOST ] Dominio o IP del la aplicaci\u00f3n *sin el protocolo*. Ver [ una forma alternativa de actualizarlo ]( /docs/developers/checklist.md#verificar-si-mi-andino-tiene-el-nombre-de-dominio-configurado-correctamente ) [ --nginx-extended-cache ] Configura nginx con una configuraci\u00f3n extendida y configura el hook de invalidaci\u00f3n de cache de Andino para notificar a nginx [ --nginx_ssl ] Aplica la configuraci\u00f3n HTTPS en nginx. Requiere ambos archivos del certificado SSL para poder lograrlo ; en caso contrario, se utilizar\u00e1 la configuraci\u00f3n default [ --ssl_key_path SSL_KEY_PATH ] Path dentro del host donde est\u00e1 ubicado el archivo .key para el certificado SSL ; ser\u00e1 copiado al contenedor de nginx si tanto \u00e9ste como el .crt pueden ser encontrados [ --ssl_crt_path SSL_CRT_PATH ] Path dentro del host donde est\u00e1 ubicado el archivo .crt para el certificado SSL ; ser\u00e1 copiado al contenedor de nginx si tanto \u00e9ste como el .key pueden ser encontrados [ --nginx_port NGINX_PORT ] Puerto del servidor \"Host\" que se desea que se tome para recibir llamadas HTTP. Por defecto es el 80 . [ --nginx_ssl_port NGINX_SSL_PORT ] Puerto del servidor \"Host\" que se desea que se tome para recibir llamadas HTTPS. Por defecto es el 443 . Es importante para los administradores saber que Andino tomar\u00e1 el puerto especificado ( o el default ) ya sea que el portal use o no use HTTPS. En caso de no querer usar HTTPS y que el host tenga erl puerto 443 tomado por un servidor web, es requisito especificar un puerto distinto ( ejemplo: 8443 ) que ser\u00e1 reservado por Andino, pero no utilizado. [ --file_size_limit FILE_SIZE_LIMIT ] Configura el l\u00edmite de tama\u00f1o para subida de archivos en recursos. Para esta actualizaci\u00f3n de ejemplo, usaremos los valores por defecto: sudo wget https : // raw . github . com / datosgobar / portal - andino / master / install / { update , installation_manager } . py sudo python update . py De esta forma, el script asumir\u00e1 que instalamos la aplicaci\u00f3n en /etc/portal . Nota : Si se utiliza el nombre 'localhost' para la variable site_host , es posible que ocurra un error al intentar subir un archivo perteneciente a un recurso al Datastore. Para evitar este problema, se debe utilizar un hostname diferente. Actualizaci\u00f3n avanzada Si instalamos la aplicaci\u00f3n en otro directorio distinto de /etc/portal , necesitamos correr el script de una manera diferente. Suponiendo que instalamos la aplicaci\u00f3n en /home/user/app/ , debemos correr los siguientes pasos: wget https : // raw . github . com / datosgobar / portal - andino / master / install / { update , installation_manager } . py sudo python update . py --install_directory=\"/home/user/app/\" Andino con plugins ad-hoc Si configuraste tu instancia de Andino con alg\u00fan plugin de CKAN que Andino no trae por defecto, es importante que antes de la instalaci\u00f3n elimines los mismos de la opcio\u00f3n de configuraci\u00f3n ckan.plugins del archivo /etc/ckan/default/production.ini del contenedor portal . Esto es importante, ya que el proceso de actualizaci\u00f3n descarga im\u00e1genes de Docker nuevas que no contendr\u00e1n los binarios de los plugins ad-hoc y si los mismos est\u00e1n en el archivo de configuraci\u00f3n de CKAN, la actualizaci\u00f3n fallar\u00e1. Los pasos adicionales que deber\u00e1s seguir si ten\u00e9s plugins ad-hoc son: Editar el archivo /etc/ckan/default/production.ini del contenedor portal y quitar de la lista de ckan.plugins los plugins ad-hoc . Actualizar Andino. Instalar los plugins ad-hoc dentro del virtualenv /usr/lib/ckan/default del contenedor portal . Editar el archivo /etc/ckan/default/production.ini del contenedor portal y agregar a la lista de ckan.plugins los plugins ad-hoc . Reiniciar Andino. Versiones 2.5.7 en adelante Se especific\u00f3 en el archivo de configuraci\u00f3n ( production.ini ) un nuevo path donde ahora se encuentra un JSON que contiene las unidades que utiliza Andino; /var/lib/ckan/theme_config/units.json . Se deber\u00e1 tener en cuenta al actualizar si el campo units_url dentro del archivo de configuraci\u00f3n hab\u00eda sido modificado manualmente, ya que se correr\u00e1 una migraci\u00f3n para utilizar el path correspondiente al JSON nombrado. Versiones 2.5.6 en adelante Se especific\u00f3 en el archivo de configuraci\u00f3n ( production.ini ) un nuevo path donde ahora se encuentra un JSON que contiene las licencias que utiliza Andino; /var/lib/ckan/theme_config/licenses.json . Se deber\u00e1 tener en cuenta al actualizar si el campo licenses_group_url dentro del archivo de configuraci\u00f3n hab\u00eda sido modificado manualmente, ya que se correr\u00e1 una migraci\u00f3n para utilizar el path correspondiente al JSON nombrado. Versiones 2.5.5 en adelante Es necesario asegurarse de que la versi\u00f3n de Docker instalada sea una igual o m\u00e1s reciente a 17.05.0-ce (2017-05-04). Debido a la posibilidad de que ocasionen problemas durante la instalaci\u00f3n, se removieron los plugin harvest y datajson del archivo de configuraci\u00f3n, y se agreg\u00f3 una migraci\u00f3n para eliminarlos al actualizar Andino para evitar posibles problemas. De ser necesaria la utilizaci\u00f3n de los plugins mencionados, deber\u00e1n ser a\u00f1adidos manualmente una vez finalizada la actualizaci\u00f3n. Versiones 2.5.0 y 2.5.1 Si actualiz\u00e1s de 2.5.0 o 2.5.1 a 2.5.2 o una versi\u00f3n m\u00e1s nueva, hay que modificar el archivo de configuraci\u00f3n para que googleanalytics est\u00e9 s\u00f3lo una vez y al final en ckan.plugins . Para ver c\u00f3mo modificar el archivo de configuraci\u00f3n, ir a la documentaci\u00f3n de mantenimiento . Ejemplo de c\u00f3mo podr\u00eda quedar: ckan.plugins = datajson_harvest datajson harvest ckan_harvester stats text_view image_view recline_view hierarchy_display hierarchy_form dcat structured_data gobar_theme datastore datapusher seriestiempoarexplorer googleanalytics Versiones entre 2.4.0 y 2.5.3 Al actualizar un portal cuya versi\u00f3n se encuentra entre 2.4.0 y 2.5.3 a una versi\u00f3n m\u00e1s nueva, existe un comando que se debe ejecutar debido a problemas con el guardado de archivos de recursos (no se puede descargar un archivo de recurso si \u00e9ste fue editado sin que se actualizara el archivo). Este comando recuperar\u00e1 los archivos de recursos para los cuales se cumplan estas condiciones: - El recurso es local - El recurso posee el campo downloadURL en el data.json - El archivo del recurso existe en el Datastore (su extensi\u00f3n debe ser csv , xls o xlsx ) y no est\u00e1 vac\u00edo Existen 3 m\u00e9todos para ejecutar la actualizaci\u00f3n de los recursos: Actualizar s\u00f3lo aquellos recursos cuyos archivos no sean descargables y cumplan con las condiciones detalladas m\u00e1s arriba Actualizar todos los recursos que simplemente cumplan con las condiciones detalladas m\u00e1s arriba Especificar uno o m\u00e1s IDs de los recursos que se quieran actualizar (en vez de modificar todos los posibles) Nota: Los m\u00e9todos 2) y 3) son combinables. Para poder implementar la soluci\u00f3n una vez hecha la actualizaci\u00f3n del portal, se debe ejecutar los siguientes comandos: docker-compose -f latest.yml exec portal bash cd /usr/lib/ckan/default/src/ckanext-gobar-theme /usr/lib/ckan/default/bin/paster --plugin = ckan reupload-resources-files --config = /etc/ckan/default/production.ini exit Para cada m\u00e9todo mencionado, la tercera l\u00ednea a ejecutar (el comando de actualizaci\u00f3n de recursos) ser\u00e1 distinta: Dejar el comando tal y como est\u00e1, ya que es el comportamiento default Escribir despu\u00e9s del texto reupload-resources-files el flag --force=true Escribir despu\u00e9s del texto reupload-resources-files (o del flag --force=true si se lo utiliz\u00f3) todos los IDs de los recursos a actualizar Ejemplo de c\u00f3mo quedar\u00eda si se quiere utilizar los m\u00e9todos 2) y 3) actualizando dos recursos distintos: /usr/lib/ckan/default/bin/paster --plugin=ckan reupload-resources-files --force=true a57e4006-9e15-4bc7-b46a-25bf3580e538 t5t4rp09-156s-xzq2-36vl-2d5e8fghn98q --config=/etc/ckan/default/production.ini Versiones 2.4.x a 2.5.x En el caso de actualizar un Andino de versi\u00f3n 2.4.x a 2.5.x existe un error conocido de CKAN 2.5.8 (Ver issue ckan/ckan#4168 ) que debe solucionarse ANTES de ejecutar la actualizaci\u00f3n . En el procedimiento normal, ocurrir\u00eda un error: sqlalchemy.exc.ProgrammingError: (ProgrammingError) column package.metadata_created does not exist Para poder solucionarlo, se debe correr el siguiente script antes de ejecutar el procedimiento normal de actualizaci\u00f3n : docker-compose -f latest.yml exec -u postgres db psql -c \" do \\$ $ begin IF NOT EXISTS(SELECT * FROM information_schema.columns WHERE table_name='package' AND column_name='metadata_created') OR NOT EXISTS(SELECT * FROM information_schema.columns WHERE table_name='package_revision' AND column_name='metadata_created') THEN IF NOT EXISTS(SELECT * FROM information_schema.columns WHERE table_name='package_revision' AND column_name='metadata_created') THEN ALTER TABLE package_revision ADD COLUMN metadata_created timestamp without time zone; END IF; IF NOT EXISTS(SELECT * FROM information_schema.columns WHERE table_name='package' AND column_name='metadata_created') THEN ALTER TABLE package ADD COLUMN metadata_created timestamp without time zone; END IF; UPDATE package SET metadata_created= (SELECT revision_timestamp FROM package_revision WHERE id=package.id ORDER BY revision_timestamp ASC LIMIT 1); END IF; end \\$ $ \" ckan Versiones 1.x a 2.x Ver documento de migraci\u00f3n","title":"Actualizaci\u00f3n"},{"location":"developers/update/#actualizacion","text":"","title":"Actualizaci\u00f3n"},{"location":"developers/update/#indice","text":"Versiones 2.x Actualizaci\u00f3n simple Actualizaci\u00f3n avanzada Andino con plugins ad-hoc Versiones 2.5.7 en adelante Versiones 2.5.6 en adelante Versiones 2.5.5 en adelante Versiones 2.5.0 y 2.5.1 Versiones entre 2.4.0 y 2.5.3 Versiones 2.4.x a 2.5.x Versiones 1.x a 2.x","title":"Indice"},{"location":"developers/update/#versiones-2x","text":"Nota: si actualiz\u00e1s desde una versi\u00f3n 2.4.x a una versi\u00f3n 2.5.x ver Versiones 2.4.x a 2.5.x ANTES de proceder con la actualizaci\u00f3n","title":"Versiones 2.x"},{"location":"developers/update/#actualizacion-simple","text":"Si instalamos la aplicaci\u00f3n con la \u00faltima versi\u00f3n del instalador ( este ), el mismo no requerir\u00e1 par\u00e1metros, pero contiene algunos opcionales: # Par\u00e1metros de update.py [ -h ] Mostrar la ayuda del script [ --install_directory INSTALL_DIRECTORY ] Directorio donde est\u00e1 instalada la aplicaci\u00f3n. Por defecto es ` /etc/portal ` [ --site_host SITE_HOST ] Dominio o IP del la aplicaci\u00f3n *sin el protocolo*. Ver [ una forma alternativa de actualizarlo ]( /docs/developers/checklist.md#verificar-si-mi-andino-tiene-el-nombre-de-dominio-configurado-correctamente ) [ --nginx-extended-cache ] Configura nginx con una configuraci\u00f3n extendida y configura el hook de invalidaci\u00f3n de cache de Andino para notificar a nginx [ --nginx_ssl ] Aplica la configuraci\u00f3n HTTPS en nginx. Requiere ambos archivos del certificado SSL para poder lograrlo ; en caso contrario, se utilizar\u00e1 la configuraci\u00f3n default [ --ssl_key_path SSL_KEY_PATH ] Path dentro del host donde est\u00e1 ubicado el archivo .key para el certificado SSL ; ser\u00e1 copiado al contenedor de nginx si tanto \u00e9ste como el .crt pueden ser encontrados [ --ssl_crt_path SSL_CRT_PATH ] Path dentro del host donde est\u00e1 ubicado el archivo .crt para el certificado SSL ; ser\u00e1 copiado al contenedor de nginx si tanto \u00e9ste como el .key pueden ser encontrados [ --nginx_port NGINX_PORT ] Puerto del servidor \"Host\" que se desea que se tome para recibir llamadas HTTP. Por defecto es el 80 . [ --nginx_ssl_port NGINX_SSL_PORT ] Puerto del servidor \"Host\" que se desea que se tome para recibir llamadas HTTPS. Por defecto es el 443 . Es importante para los administradores saber que Andino tomar\u00e1 el puerto especificado ( o el default ) ya sea que el portal use o no use HTTPS. En caso de no querer usar HTTPS y que el host tenga erl puerto 443 tomado por un servidor web, es requisito especificar un puerto distinto ( ejemplo: 8443 ) que ser\u00e1 reservado por Andino, pero no utilizado. [ --file_size_limit FILE_SIZE_LIMIT ] Configura el l\u00edmite de tama\u00f1o para subida de archivos en recursos. Para esta actualizaci\u00f3n de ejemplo, usaremos los valores por defecto: sudo wget https : // raw . github . com / datosgobar / portal - andino / master / install / { update , installation_manager } . py sudo python update . py De esta forma, el script asumir\u00e1 que instalamos la aplicaci\u00f3n en /etc/portal . Nota : Si se utiliza el nombre 'localhost' para la variable site_host , es posible que ocurra un error al intentar subir un archivo perteneciente a un recurso al Datastore. Para evitar este problema, se debe utilizar un hostname diferente.","title":"Actualizaci\u00f3n simple"},{"location":"developers/update/#actualizacion-avanzada","text":"Si instalamos la aplicaci\u00f3n en otro directorio distinto de /etc/portal , necesitamos correr el script de una manera diferente. Suponiendo que instalamos la aplicaci\u00f3n en /home/user/app/ , debemos correr los siguientes pasos: wget https : // raw . github . com / datosgobar / portal - andino / master / install / { update , installation_manager } . py sudo python update . py --install_directory=\"/home/user/app/\"","title":"Actualizaci\u00f3n avanzada"},{"location":"developers/update/#andino-con-plugins-ad-hoc","text":"Si configuraste tu instancia de Andino con alg\u00fan plugin de CKAN que Andino no trae por defecto, es importante que antes de la instalaci\u00f3n elimines los mismos de la opcio\u00f3n de configuraci\u00f3n ckan.plugins del archivo /etc/ckan/default/production.ini del contenedor portal . Esto es importante, ya que el proceso de actualizaci\u00f3n descarga im\u00e1genes de Docker nuevas que no contendr\u00e1n los binarios de los plugins ad-hoc y si los mismos est\u00e1n en el archivo de configuraci\u00f3n de CKAN, la actualizaci\u00f3n fallar\u00e1. Los pasos adicionales que deber\u00e1s seguir si ten\u00e9s plugins ad-hoc son: Editar el archivo /etc/ckan/default/production.ini del contenedor portal y quitar de la lista de ckan.plugins los plugins ad-hoc . Actualizar Andino. Instalar los plugins ad-hoc dentro del virtualenv /usr/lib/ckan/default del contenedor portal . Editar el archivo /etc/ckan/default/production.ini del contenedor portal y agregar a la lista de ckan.plugins los plugins ad-hoc . Reiniciar Andino.","title":"Andino con plugins ad-hoc"},{"location":"developers/update/#versiones-257-en-adelante","text":"Se especific\u00f3 en el archivo de configuraci\u00f3n ( production.ini ) un nuevo path donde ahora se encuentra un JSON que contiene las unidades que utiliza Andino; /var/lib/ckan/theme_config/units.json . Se deber\u00e1 tener en cuenta al actualizar si el campo units_url dentro del archivo de configuraci\u00f3n hab\u00eda sido modificado manualmente, ya que se correr\u00e1 una migraci\u00f3n para utilizar el path correspondiente al JSON nombrado.","title":"Versiones 2.5.7 en adelante"},{"location":"developers/update/#versiones-256-en-adelante","text":"Se especific\u00f3 en el archivo de configuraci\u00f3n ( production.ini ) un nuevo path donde ahora se encuentra un JSON que contiene las licencias que utiliza Andino; /var/lib/ckan/theme_config/licenses.json . Se deber\u00e1 tener en cuenta al actualizar si el campo licenses_group_url dentro del archivo de configuraci\u00f3n hab\u00eda sido modificado manualmente, ya que se correr\u00e1 una migraci\u00f3n para utilizar el path correspondiente al JSON nombrado.","title":"Versiones 2.5.6 en adelante"},{"location":"developers/update/#versiones-255-en-adelante","text":"Es necesario asegurarse de que la versi\u00f3n de Docker instalada sea una igual o m\u00e1s reciente a 17.05.0-ce (2017-05-04). Debido a la posibilidad de que ocasionen problemas durante la instalaci\u00f3n, se removieron los plugin harvest y datajson del archivo de configuraci\u00f3n, y se agreg\u00f3 una migraci\u00f3n para eliminarlos al actualizar Andino para evitar posibles problemas. De ser necesaria la utilizaci\u00f3n de los plugins mencionados, deber\u00e1n ser a\u00f1adidos manualmente una vez finalizada la actualizaci\u00f3n.","title":"Versiones 2.5.5 en adelante"},{"location":"developers/update/#versiones-250-y-251","text":"Si actualiz\u00e1s de 2.5.0 o 2.5.1 a 2.5.2 o una versi\u00f3n m\u00e1s nueva, hay que modificar el archivo de configuraci\u00f3n para que googleanalytics est\u00e9 s\u00f3lo una vez y al final en ckan.plugins . Para ver c\u00f3mo modificar el archivo de configuraci\u00f3n, ir a la documentaci\u00f3n de mantenimiento . Ejemplo de c\u00f3mo podr\u00eda quedar: ckan.plugins = datajson_harvest datajson harvest ckan_harvester stats text_view image_view recline_view hierarchy_display hierarchy_form dcat structured_data gobar_theme datastore datapusher seriestiempoarexplorer googleanalytics","title":"Versiones 2.5.0 y 2.5.1"},{"location":"developers/update/#versiones-entre-240-y-253","text":"Al actualizar un portal cuya versi\u00f3n se encuentra entre 2.4.0 y 2.5.3 a una versi\u00f3n m\u00e1s nueva, existe un comando que se debe ejecutar debido a problemas con el guardado de archivos de recursos (no se puede descargar un archivo de recurso si \u00e9ste fue editado sin que se actualizara el archivo). Este comando recuperar\u00e1 los archivos de recursos para los cuales se cumplan estas condiciones: - El recurso es local - El recurso posee el campo downloadURL en el data.json - El archivo del recurso existe en el Datastore (su extensi\u00f3n debe ser csv , xls o xlsx ) y no est\u00e1 vac\u00edo Existen 3 m\u00e9todos para ejecutar la actualizaci\u00f3n de los recursos: Actualizar s\u00f3lo aquellos recursos cuyos archivos no sean descargables y cumplan con las condiciones detalladas m\u00e1s arriba Actualizar todos los recursos que simplemente cumplan con las condiciones detalladas m\u00e1s arriba Especificar uno o m\u00e1s IDs de los recursos que se quieran actualizar (en vez de modificar todos los posibles) Nota: Los m\u00e9todos 2) y 3) son combinables. Para poder implementar la soluci\u00f3n una vez hecha la actualizaci\u00f3n del portal, se debe ejecutar los siguientes comandos: docker-compose -f latest.yml exec portal bash cd /usr/lib/ckan/default/src/ckanext-gobar-theme /usr/lib/ckan/default/bin/paster --plugin = ckan reupload-resources-files --config = /etc/ckan/default/production.ini exit Para cada m\u00e9todo mencionado, la tercera l\u00ednea a ejecutar (el comando de actualizaci\u00f3n de recursos) ser\u00e1 distinta: Dejar el comando tal y como est\u00e1, ya que es el comportamiento default Escribir despu\u00e9s del texto reupload-resources-files el flag --force=true Escribir despu\u00e9s del texto reupload-resources-files (o del flag --force=true si se lo utiliz\u00f3) todos los IDs de los recursos a actualizar Ejemplo de c\u00f3mo quedar\u00eda si se quiere utilizar los m\u00e9todos 2) y 3) actualizando dos recursos distintos: /usr/lib/ckan/default/bin/paster --plugin=ckan reupload-resources-files --force=true a57e4006-9e15-4bc7-b46a-25bf3580e538 t5t4rp09-156s-xzq2-36vl-2d5e8fghn98q --config=/etc/ckan/default/production.ini","title":"Versiones entre 2.4.0 y 2.5.3"},{"location":"developers/update/#versiones-24x-a-25x","text":"En el caso de actualizar un Andino de versi\u00f3n 2.4.x a 2.5.x existe un error conocido de CKAN 2.5.8 (Ver issue ckan/ckan#4168 ) que debe solucionarse ANTES de ejecutar la actualizaci\u00f3n . En el procedimiento normal, ocurrir\u00eda un error: sqlalchemy.exc.ProgrammingError: (ProgrammingError) column package.metadata_created does not exist Para poder solucionarlo, se debe correr el siguiente script antes de ejecutar el procedimiento normal de actualizaci\u00f3n : docker-compose -f latest.yml exec -u postgres db psql -c \" do \\$ $ begin IF NOT EXISTS(SELECT * FROM information_schema.columns WHERE table_name='package' AND column_name='metadata_created') OR NOT EXISTS(SELECT * FROM information_schema.columns WHERE table_name='package_revision' AND column_name='metadata_created') THEN IF NOT EXISTS(SELECT * FROM information_schema.columns WHERE table_name='package_revision' AND column_name='metadata_created') THEN ALTER TABLE package_revision ADD COLUMN metadata_created timestamp without time zone; END IF; IF NOT EXISTS(SELECT * FROM information_schema.columns WHERE table_name='package' AND column_name='metadata_created') THEN ALTER TABLE package ADD COLUMN metadata_created timestamp without time zone; END IF; UPDATE package SET metadata_created= (SELECT revision_timestamp FROM package_revision WHERE id=package.id ORDER BY revision_timestamp ASC LIMIT 1); END IF; end \\$ $ \" ckan","title":"Versiones 2.4.x a 2.5.x"},{"location":"developers/update/#versiones-1x-a-2x","text":"Ver documento de migraci\u00f3n","title":"Versiones 1.x a 2.x"}]}